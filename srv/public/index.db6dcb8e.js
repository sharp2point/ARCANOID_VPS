!function(e,t,r,s,n){var a="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},o="function"==typeof a[s]&&a[s],i=o.cache||{},l="undefined"!=typeof module&&"function"==typeof module.require&&module.require.bind(module);function c(t,r){if(!i[t]){if(!e[t]){var n="function"==typeof a[s]&&a[s];if(!r&&n)return n(t,!0);if(o)return o(t,!0);if(l&&"string"==typeof t)return l(t);var d=Error("Cannot find module '"+t+"'");throw d.code="MODULE_NOT_FOUND",d}u.resolve=function(r){var s=e[t][1][r];return null!=s?s:r},u.cache={};var h=i[t]=new c.Module(t);e[t][0].call(h.exports,u,h,h.exports,this)}return i[t].exports;function u(e){var t=u.resolve(e);return!1===t?{}:c(t)}}c.isParcelRequire=!0,c.Module=function(e){this.id=e,this.bundle=c,this.exports={}},c.modules=e,c.cache=i,c.parent=o,c.register=function(t,r){e[t]=[function(e,t){t.exports=r},{}]},Object.defineProperty(c,"root",{get:function(){return a[s]}}),a[s]=c;for(var d=0;d<t.length;d++)c(t[d]);if(r){var h=c(r);"object"==typeof exports&&"undefined"!=typeof module?module.exports=h:"function"==typeof define&&define.amd&&define(function(){return h})}}({g9s12:[function(e,t,r){var s=e("@babylonjs/core"),n=e("@babylonjs/havok"),a=e("./game_state/assets/state"),o=e("./game_state/main/state"),i=e("./game_state/game_state"),l=e("./game_state/ui/state"),c=e("./utils/clear_utils"),d=e("./utils/loaderGlbFiles"),h=e("./utils/utility"),u=e("./objects/enemy/enemy"),_=e("./DB/indexdb");async function p(){let e=await n.default();o.AGAME.HVK=new s.HavokPlugin(!0,e),o.AGAME.Canvas=document.querySelector("#app"),o.AGAME.Engine=new s.Engine(o.AGAME.Canvas,!0,{xrCompatible:!1},!0),o.AGAME.Gravity=new s.Vector3(0,-9.81,0),l.UISTATE.Canvas=o.AGAME.Canvas,l.UISTATE.Engine=o.AGAME.Engine}window.addEventListener("load",async()=>{(0,c.getTypeUserDevice)(),o.AGAME.ScreenAspect=(0,c.getScreenAspect)(),(0,c.loadAssets)(a.ASSETS.sprites),o.AGAME.RenderLock=!0,l.UISTATE.RenderLock=!1,p().then(async()=>{let{UIScene:t}=await e("f016ffe7a28be900"),{sceneOne:r}=await e("42e8f19adb24a70a");t(),r(o.AGAME.Gravity,o.AGAME.HVK),(0,h.cameraSettings)(o.AGAME.ScreenAspect),(0,d.loadEnemyModel)(o.AGAME.Scene),(0,d.loadDamageEnemyModel)(o.AGAME.Scene),(0,u.createEnemyMaterial)(o.AGAME.Scene),(0,_.openIndexDB)(),(0,o.AGAME).Engine.runRenderLoop(()=>{!o.AGAME.RenderLock&&l.UISTATE.RenderLock?(0,o.AGAME).Scene.render():!l.UISTATE.RenderLock&&o.AGAME.RenderLock&&(0,l.UISTATE).Scene.render()})})}),window.addEventListener("resize",()=>{o.AGAME.ScreenAspect=(0,c.getScreenAspect)(),o.AGAME.Engine&&((0,o.AGAME).Engine.resize(),(0,l.UISTATE).Engine.resize()),(0,i.GameState).camera()&&(0,h.cameraSettings)(o.AGAME.ScreenAspect)}),window.addEventListener("keydown",e=>{"i"===e.key&&e.altKey})},{"@babylonjs/core":"1KKys","@babylonjs/havok":"3EJ0x","./game_state/assets/state":"eemMA","./game_state/main/state":"3N3ac","./game_state/game_state":"5qBSL","./game_state/ui/state":"aE8EP","./utils/clear_utils":"aFozW","./utils/loaderGlbFiles":"dfETV","./utils/utility":"8IYYd","./objects/enemy/enemy":"aZfC4","./DB/indexdb":"iS775",f016ffe7a28be900:"fc3Dq","42e8f19adb24a70a":"6GK3Y"}],"3EJ0x":[function(e,t,r){e("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(r);var s,n=(s="file:///node_modules/@babylonjs/havok/lib/esm/HavokPhysics_es.js",function(t){var r,n,a,o,i,l,c,d,h,u,_,p,m,f,y,b,g,T,A,x,v,M,j=void 0!==(t=t||{})?t:{};j.ready=new Promise(function(e,t){n=e,a=t});var E=Object.assign({},j),L=[],C=(e,t)=>{throw t},P="";"undefined"!=typeof document&&document.currentScript&&(P=document.currentScript.src),s&&(P=s),P=0!==P.indexOf("blob:")?P.substr(0,P.replace(/[?#].*/,"").lastIndexOf("/")+1):"";var F=j.print||console.log.bind(console),S=j.printErr||console.warn.bind(console);Object.assign(j,E),E=null,j.arguments&&(L=j.arguments),j.thisProgram&&j.thisProgram,j.quit&&(C=j.quit),j.wasmBinary&&(i=j.wasmBinary);var w=j.noExitRuntime||!0;"object"!=typeof WebAssembly&&U("no native wasm support detected");var O=!1,R="undefined"!=typeof TextDecoder?new TextDecoder("utf8"):void 0;function B(e,t,r){for(var s=t+r,n=t;e[n]&&!(n>=s);)++n;if(n-t>16&&e.buffer&&R)return R.decode(e.subarray(t,n));for(var a="";t<n;){var o=e[t++];if(!(128&o)){a+=String.fromCharCode(o);continue}var i=63&e[t++];if((224&o)==192){a+=String.fromCharCode((31&o)<<6|i);continue}var l=63&e[t++];if((o=(240&o)==224?(15&o)<<12|i<<6|l:(7&o)<<18|i<<12|l<<6|63&e[t++])<65536)a+=String.fromCharCode(o);else{var c=o-65536;a+=String.fromCharCode(55296|c>>10,56320|1023&c)}}return a}function I(e){d=e,j.HEAP8=h=new Int8Array(e),j.HEAP16=_=new Int16Array(e),j.HEAP32=m=new Int32Array(e),j.HEAPU8=u=new Uint8Array(e),j.HEAPU16=p=new Uint16Array(e),j.HEAPU32=f=new Uint32Array(e),j.HEAPF32=y=new Float32Array(e),j.HEAPF64=T=new Float64Array(e),j.HEAP64=b=new BigInt64Array(e),j.HEAPU64=g=new BigUint64Array(e)}j.INITIAL_MEMORY;var N=[],G=[],H=[],k=[],D=0,V=null,$=null;function U(e){j.onAbort&&j.onAbort(e),S(e="Aborted("+e+")"),O=!0,c=1,e+=". Build with -sASSERTIONS for more info.";var t=new WebAssembly.RuntimeError(e);throw a(t),t}function W(e){return e.startsWith("data:application/octet-stream;base64,")}function K(e){try{if(e==x&&i)return new Uint8Array(i);if(o)return o(e);throw"both async and sync fetching of the wasm failed"}catch(e){U(e)}}function X(e){this.name="ExitStatus",this.message="Program terminated with exit("+e+")",this.status=e}function q(e){for(;e.length>0;)e.shift()(j)}j.locateFile?W(x="HavokPhysics.wasm")||(r=x,x=j.locateFile?j.locateFile(r,P):P+r):x=new URL(e("af2f6bf6b6d9048a")).toString();var Y={};function Q(e){for(;e.length;){var t=e.pop();e.pop()(t)}}function z(e){return this.fromWireType(m[e>>2])}var J={},Z={},ee={};function et(e){if(void 0===e)return"_unknown";var t=(e=e.replace(/[^a-zA-Z0-9_]/g,"$")).charCodeAt(0);return t>=48&&t<=57?"_"+e:e}function er(e,t){return Function("body","return function "+(e=et(e))+'() {\n    "use strict";    return body.apply(this, arguments);\n};\n')(t)}function es(e,t){var r=er(t,function(e){this.name=t,this.message=e;var r=Error(e).stack;void 0!==r&&(this.stack=this.toString()+"\n"+r.replace(/^Error(:[^\n]*)?\n/,""))});return r.prototype=Object.create(e.prototype),r.prototype.constructor=r,r.prototype.toString=function(){return void 0===this.message?this.name:this.name+": "+this.message},r}var en=void 0;function ea(e){throw new en(e)}function eo(e,t,r){function s(t){var s=r(t);s.length!==e.length&&ea("Mismatched type converter count");for(var n=0;n<e.length;++n)eu(e[n],s[n])}e.forEach(function(e){ee[e]=t});var n=Array(t.length),a=[],o=0;t.forEach((e,t)=>{Z.hasOwnProperty(e)?n[t]=Z[e]:(a.push(e),J.hasOwnProperty(e)||(J[e]=[]),J[e].push(()=>{n[t]=Z[e],++o===a.length&&s(n)}))}),0===a.length&&s(n)}function ei(e){if(null===e)return"null";var t=typeof e;return"object"===t||"array"===t||"function"===t?e.toString():""+e}var el=void 0;function ec(e){for(var t="",r=e;u[r];)t+=el[u[r++]];return t}var ed=void 0;function eh(e){throw new ed(e)}function eu(e,t,r={}){if(!("argPackAdvance"in t))throw TypeError("registerType registeredInstance requires argPackAdvance");var s=t.name;if(e||eh('type "'+s+'" must have a positive integer typeid pointer'),Z.hasOwnProperty(e)){if(r.ignoreDuplicateRegistrations)return;eh("Cannot register type '"+s+"' twice")}if(Z[e]=t,delete ee[e],J.hasOwnProperty(e)){var n=J[e];delete J[e],n.forEach(e=>e())}}function e_(e,t,r){switch(t){case 0:return r?function(e){return h[e]}:function(e){return u[e]};case 1:return r?function(e){return _[e>>1]}:function(e){return p[e>>1]};case 2:return r?function(e){return m[e>>2]}:function(e){return f[e>>2]};case 3:return r?function(e){return b[e>>3]}:function(e){return g[e>>3]};default:throw TypeError("Unknown integer type: "+e)}}function ep(e){switch(e){case 1:return 0;case 2:return 1;case 4:return 2;case 8:return 3;default:throw TypeError("Unknown type size: "+e)}}var em=[],ef=[{},{value:void 0},{value:null},{value:!0},{value:!1}];function ey(e){e>4&&0==--ef[e].refcount&&(ef[e]=void 0,em.push(e))}var eb=e=>(e||eh("Cannot use deleted val. handle = "+e),ef[e].value),eg=e=>{switch(e){case void 0:return 1;case null:return 2;case!0:return 3;case!1:return 4;default:var t=em.length?em.pop():ef.length;return ef[t]={refcount:1,value:e},t}};function eT(e,t,r){j.hasOwnProperty(e)?((void 0===r||void 0!==j[e].overloadTable&&void 0!==j[e].overloadTable[r])&&eh("Cannot register public name '"+e+"' twice"),function(e,t,r){if(void 0===e[t].overloadTable){var s=e[t];e[t]=function(){return e[t].overloadTable.hasOwnProperty(arguments.length)||eh("Function '"+r+"' called with an invalid number of arguments ("+arguments.length+") - expects one of ("+e[t].overloadTable+")!"),e[t].overloadTable[arguments.length].apply(this,arguments)},e[t].overloadTable=[],e[t].overloadTable[s.argCount]=s}}(j,e,e),j.hasOwnProperty(r)&&eh("Cannot register multiple overloads of a function with the same number of arguments ("+r+")!"),j[e].overloadTable[r]=t):(j[e]=t,void 0!==r&&(j[e].numArguments=r))}function eA(e){var t=eV(e),r=ec(t);return eD(t),r}function ex(e,t){var r=Z[e];return void 0===r&&eh(t+" has unknown type "+eA(e)),r}function ev(e,t){if(!(e instanceof Function))throw TypeError("new_ called with constructor type "+typeof e+" which is not a function");var r=er(e.name||"unknownFunctionName",function(){});r.prototype=e.prototype;var s=new r,n=e.apply(s,t);return n instanceof Object?n:s}var eM=[];function ej(e,t){e=ec(e);var r,s=((r=eM[t])||(t>=eM.length&&(eM.length=t+1),eM[t]=r=A.get(t)),r);return"function"!=typeof s&&eh("unknown function pointer with signature "+e+": "+t),s}var eE=void 0,eL="undefined"!=typeof TextDecoder?new TextDecoder("utf-16le"):void 0;function eC(e,t){for(var r=e,s=r>>1,n=s+t/2;!(s>=n)&&p[s];)++s;if((r=s<<1)-e>32&&eL)return eL.decode(u.subarray(e,r));for(var a="",o=0;!(o>=t/2);++o){var i=_[e+2*o>>1];if(0==i)break;a+=String.fromCharCode(i)}return a}function eP(e,t,r){if(void 0===r&&(r=2147483647),r<2)return 0;for(var s=t,n=(r-=2)<2*e.length?r/2:e.length,a=0;a<n;++a){var o=e.charCodeAt(a);_[t>>1]=o,t+=2}return _[t>>1]=0,t-s}function eF(e){return 2*e.length}function eS(e,t){for(var r=0,s="";!(r>=t/4);){var n=m[e+4*r>>2];if(0==n)break;if(++r,n>=65536){var a=n-65536;s+=String.fromCharCode(55296|a>>10,56320|1023&a)}else s+=String.fromCharCode(n)}return s}function ew(e,t,r){if(void 0===r&&(r=2147483647),r<4)return 0;for(var s=t,n=s+r-4,a=0;a<e.length;++a){var o=e.charCodeAt(a);if(o>=55296&&o<=57343&&(o=65536+((1023&o)<<10)|1023&e.charCodeAt(++a)),m[t>>2]=o,(t+=4)+4>n)break}return m[t>>2]=0,t-s}function eO(e){for(var t=0,r=0;r<e.length;++r){var s=e.charCodeAt(r);s>=55296&&s<=57343&&++r,t+=4}return t}var eR={},eB=[],eI=[];function eN(){return 2147483648}v=()=>performance.now();var eG=[null,[],[]];en=j.InternalError=es(Error,"InternalError"),function(){for(var e=Array(256),t=0;t<256;++t)e[t]=String.fromCharCode(t);el=e}(),ed=j.BindingError=es(Error,"BindingError"),j.count_emval_handles=function(){for(var e=0,t=5;t<ef.length;++t)void 0!==ef[t]&&++e;return e},j.get_first_emval=function(){for(var e=5;e<ef.length;++e)if(void 0!==ef[e])return ef[e];return null},eE=j.UnboundTypeError=es(Error,"UnboundTypeError");var eH={_embind_finalize_value_array:function(e){var t=Y[e];delete Y[e];var r=t.elements,s=r.length,n=r.map(function(e){return e.getterReturnType}).concat(r.map(function(e){return e.setterArgumentType})),a=t.rawConstructor,o=t.rawDestructor;eo([e],n,function(e){return r.forEach((t,r)=>{var n=e[r],a=t.getter,o=t.getterContext,i=e[r+s],l=t.setter,c=t.setterContext;t.read=e=>n.fromWireType(a(o,e)),t.write=(e,t)=>{var r=[];l(c,e,i.toWireType(r,t)),Q(r)}}),[{name:t.name,fromWireType:function(e){for(var t=Array(s),n=0;n<s;++n)t[n]=r[n].read(e);return o(e),t},toWireType:function(e,n){if(s!==n.length)throw TypeError("Incorrect number of tuple elements for "+t.name+": expected="+s+", actual="+n.length);for(var i=a(),l=0;l<s;++l)r[l].write(i,n[l]);return null!==e&&e.push(o,i),i},argPackAdvance:8,readValueFromPointer:z,destructorFunction:o}]})},_embind_register_bigint:function(e,t,r,s,n){t=ec(t);var a=ep(r),o=-1!=t.indexOf("u");o&&(n=(1n<<64n)-1n),eu(e,{name:t,fromWireType:function(e){return e},toWireType:function(e,r){if("bigint"!=typeof r&&"number"!=typeof r)throw TypeError('Cannot convert "'+ei(r)+'" to '+this.name);if(r<s||r>n)throw TypeError('Passing a number "'+ei(r)+'" from JS side to C/C++ side to an argument of type "'+t+'", which is outside the valid range ['+s+", "+n+"]!");return r},argPackAdvance:8,readValueFromPointer:e_(t,a,!o),destructorFunction:null})},_embind_register_bool:function(e,t,r,s,n){var a=ep(r);eu(e,{name:t=ec(t),fromWireType:function(e){return!!e},toWireType:function(e,t){return t?s:n},argPackAdvance:8,readValueFromPointer:function(e){var s;if(1===r)s=h;else if(2===r)s=_;else if(4===r)s=m;else throw TypeError("Unknown boolean type size: "+t);return this.fromWireType(s[e>>a])},destructorFunction:null})},_embind_register_emval:function(e,t){eu(e,{name:t=ec(t),fromWireType:function(e){var t=eb(e);return ey(e),t},toWireType:function(e,t){return eg(t)},argPackAdvance:8,readValueFromPointer:z,destructorFunction:null})},_embind_register_enum:function(e,t,r,s){var n=ep(r);function a(){}t=ec(t),a.values={},eu(e,{name:t,constructor:a,fromWireType:function(e){return this.constructor.values[e]},toWireType:function(e,t){return t.value},argPackAdvance:8,readValueFromPointer:function(e,t,r){switch(t){case 0:return function(e){var t=r?h:u;return this.fromWireType(t[e])};case 1:return function(e){var t=r?_:p;return this.fromWireType(t[e>>1])};case 2:return function(e){var t=r?m:f;return this.fromWireType(t[e>>2])};default:throw TypeError("Unknown integer type: "+e)}}(t,n,s),destructorFunction:null}),eT(t,a)},_embind_register_enum_value:function(e,t,r){var s=ex(e,"enum");t=ec(t);var n=s.constructor,a=Object.create(s.constructor.prototype,{value:{value:r},constructor:{value:er(s.name+"_"+t,function(){})}});n.values[r]=a,n[t]=a},_embind_register_float:function(e,t,r){var s=ep(r);eu(e,{name:t=ec(t),fromWireType:function(e){return e},toWireType:function(e,t){return t},argPackAdvance:8,readValueFromPointer:function(e,t){switch(t){case 2:return function(e){return this.fromWireType(y[e>>2])};case 3:return function(e){return this.fromWireType(T[e>>3])};default:throw TypeError("Unknown float type: "+e)}}(t,s),destructorFunction:null})},_embind_register_function:function(e,t,r,s,n,a){var o=function(e,t){for(var r=[],s=0;s<e;s++)r.push(f[t+4*s>>2]);return r}(t,r);e=ec(e),n=ej(s,n),eT(e,function(){!function(e,t){var r=[],s={};throw t.forEach(function e(t){if(!s[t]&&!Z[t]){if(ee[t]){ee[t].forEach(e);return}r.push(t),s[t]=!0}}),new eE(e+": "+r.map(eA).join([", "]))}("Cannot call "+e+" due to unbound types",o)},t-1),eo([],o,function(r){var s,o,i,l=[r[0],null].concat(r.slice(1));return s=e,o=function(e,t,r,s,n){var a=t.length;a<2&&eh("argTypes array size mismatch! Must at least get return value and 'this' types!");for(var o=null!==t[1]&&!1,i=!1,l=1;l<t.length;++l)if(null!==t[l]&&void 0===t[l].destructorFunction){i=!0;break}for(var c="void"!==t[0].name,d="",h="",l=0;l<a-2;++l)d+=(0!==l?", ":"")+"arg"+l,h+=(0!==l?", ":"")+"arg"+l+"Wired";var u="return function "+et(e)+"("+d+") {\nif (arguments.length !== "+(a-2)+") {\nthrowBindingError('function "+e+" called with ' + arguments.length + ' arguments, expected "+(a-2)+" args!');\n}\n";i&&(u+="var destructors = [];\n");var _=i?"destructors":"null",p=["throwBindingError","invoker","fn","runDestructors","retType","classParam"],m=[eh,s,n,Q,t[0],t[1]];o&&(u+="var thisWired = classParam.toWireType("+_+", this);\n");for(var l=0;l<a-2;++l)u+="var arg"+l+"Wired = argType"+l+".toWireType("+_+", arg"+l+"); // "+t[l+2].name+"\n",p.push("argType"+l),m.push(t[l+2]);if(o&&(h="thisWired"+(h.length>0?", ":"")+h),u+=(c?"var rv = ":"")+"invoker(fn"+(h.length>0?", ":"")+h+");\n",i)u+="runDestructors(destructors);\n";else for(var l=o?1:2;l<t.length;++l){var f=1===l?"thisWired":"arg"+(l-2)+"Wired";null!==t[l].destructorFunction&&(u+=f+"_dtor("+f+"); // "+t[l].name+"\n",p.push(f+"_dtor"),m.push(t[l].destructorFunction))}return c&&(u+="var ret = retType.fromWireType(rv);\nreturn ret;\n"),u+="}\n",p.push(u),ev(Function,p).apply(null,m)}(e,l,0,n,a),i=t-1,j.hasOwnProperty(s)||ea("Replacing nonexistant public symbol"),void 0!==j[s].overloadTable&&void 0!==i?j[s].overloadTable[i]=o:(j[s]=o,j[s].argCount=i),[]})},_embind_register_integer:function(e,t,r,s,n){t=ec(t),-1===n&&(n=4294967295);var a=ep(r),o=e=>e;if(0===s){var i=32-8*r;o=e=>e<<i>>>i}var l=t.includes("unsigned"),c=(e,t)=>{};eu(e,{name:t,fromWireType:o,toWireType:l?function(e,t){return c(t,this.name),t>>>0}:function(e,t){return c(t,this.name),t},argPackAdvance:8,readValueFromPointer:e_(t,a,0!==s),destructorFunction:null})},_embind_register_memory_view:function(e,t,r){var s=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array,BigInt64Array,BigUint64Array][t];function n(e){e>>=2;var t=f,r=t[e],n=t[e+1];return new s(d,n,r)}eu(e,{name:r=ec(r),fromWireType:n,argPackAdvance:8,readValueFromPointer:n},{ignoreDuplicateRegistrations:!0})},_embind_register_std_string:function(e,t){var r="std::string"===(t=ec(t));eu(e,{name:t,fromWireType:function(e){var t,s=f[e>>2],n=e+4;if(r)for(var a=n,o=0;o<=s;++o){var i=n+o;if(o==s||0==u[i]){var l,c=i-a,d=(l=a)?B(u,l,c):"";void 0===t?t=d:t+="\0"+d,a=i+1}}else{for(var h=Array(s),o=0;o<s;++o)h[o]=String.fromCharCode(u[n+o]);t=h.join("")}return eD(e),t},toWireType:function(e,t){t instanceof ArrayBuffer&&(t=new Uint8Array(t));var s,n="string"==typeof t;n||t instanceof Uint8Array||t instanceof Uint8ClampedArray||t instanceof Int8Array||eh("Cannot pass non-string to std::string"),s=r&&n?function(e){for(var t=0,r=0;r<e.length;++r){var s=e.charCodeAt(r);s<=127?t++:s<=2047?t+=2:s>=55296&&s<=57343?(t+=4,++r):t+=3}return t}(t):t.length;var a=ek(4+s+1),o=a+4;if(f[a>>2]=s,r&&n)!function(e,t,r,s){if(s>0){for(var n=r+s-1,a=0;a<e.length;++a){var o=e.charCodeAt(a);if(o>=55296&&o<=57343&&(o=65536+((1023&o)<<10)|1023&e.charCodeAt(++a)),o<=127){if(r>=n)break;t[r++]=o}else if(o<=2047){if(r+1>=n)break;t[r++]=192|o>>6,t[r++]=128|63&o}else if(o<=65535){if(r+2>=n)break;t[r++]=224|o>>12,t[r++]=128|o>>6&63,t[r++]=128|63&o}else{if(r+3>=n)break;t[r++]=240|o>>18,t[r++]=128|o>>12&63,t[r++]=128|o>>6&63,t[r++]=128|63&o}}t[r]=0}}(t,u,o,s+1);else if(n)for(var i=0;i<s;++i){var l=t.charCodeAt(i);l>255&&(eD(o),eh("String has UTF-16 code units that do not fit in 8 bits")),u[o+i]=l}else for(var i=0;i<s;++i)u[o+i]=t[i];return null!==e&&e.push(eD,a),a},argPackAdvance:8,readValueFromPointer:z,destructorFunction:function(e){eD(e)}})},_embind_register_std_wstring:function(e,t,r){var s,n,a,o,i;r=ec(r),2===t?(s=eC,n=eP,o=eF,a=()=>p,i=1):4===t&&(s=eS,n=ew,o=eO,a=()=>f,i=2),eu(e,{name:r,fromWireType:function(e){for(var r,n=f[e>>2],o=a(),l=e+4,c=0;c<=n;++c){var d=e+4+c*t;if(c==n||0==o[d>>i]){var h=d-l,u=s(l,h);void 0===r?r=u:r+="\0"+u,l=d+t}}return eD(e),r},toWireType:function(e,s){"string"!=typeof s&&eh("Cannot pass non-string to C++ string type "+r);var a=o(s),l=ek(4+a+t);return f[l>>2]=a>>i,n(s,l+4,a+t),null!==e&&e.push(eD,l),l},argPackAdvance:8,readValueFromPointer:z,destructorFunction:function(e){eD(e)}})},_embind_register_value_array:function(e,t,r,s,n,a){Y[e]={name:ec(t),rawConstructor:ej(r,s),rawDestructor:ej(n,a),elements:[]}},_embind_register_value_array_element:function(e,t,r,s,n,a,o,i,l){Y[e].elements.push({getterReturnType:t,getter:ej(r,s),getterContext:n,setterArgumentType:a,setter:ej(o,i),setterContext:l})},_embind_register_void:function(e,t){eu(e,{isVoid:!0,name:t=ec(t),argPackAdvance:0,fromWireType:function(){},toWireType:function(e,t){}})},_emscripten_get_now_is_monotonic:function(){return!0},_emval_call_void_method:function(e,t,r,s){var n,a;(e=eB[e])(t=eb(t),r=void 0===(a=eR[n=r])?ec(n):a,null,s)},_emval_decref:ey,_emval_get_method_caller:function(e,t){var r,s,n=function(e,t){for(var r=Array(e),s=0;s<e;++s)r[s]=ex(f[t+4*s>>2],"parameter "+s);return r}(e,t),a=n[0],o=a.name+"_$"+n.slice(1).map(function(e){return e.name}).join("_")+"$",i=eI[o];if(void 0!==i)return i;for(var l=["retType"],c=[a],d="",h=0;h<e-1;++h)d+=(0!==h?", ":"")+"arg"+h,l.push("argType"+h),c.push(n[1+h]);for(var u="return function "+et("methodCaller_"+o)+"(handle, name, destructors, args) {\n",_=0,h=0;h<e-1;++h)u+="    var arg"+h+" = argType"+h+".readValueFromPointer(args"+(_?"+"+_:"")+");\n",_+=n[h+1].argPackAdvance;u+="    var rv = handle[name]("+d+");\n";for(var h=0;h<e-1;++h)n[h+1].deleteObject&&(u+="    argType"+h+".deleteObject(arg"+h+");\n");return a.isVoid||(u+="    return retType.toWireType(destructors, rv);\n"),u+="};\n",l.push(u),r=ev(Function,l).apply(null,c),s=eB.length,eB.push(r),i=s,eI[o]=i,i},abort:function(){U("")},emscripten_date_now:function(){return Date.now()},emscripten_get_heap_max:function(){return eN()},emscripten_get_now:v,emscripten_memcpy_big:function(e,t,r){u.copyWithin(e,t,t+r)},emscripten_resize_heap:function(e){var t=u.length;e>>>=0;var r=eN();if(e>r)return!1;let s=(e,t)=>e+(t-e%t)%t;for(var n=1;n<=4;n*=2){var a=t*(1+.2/n);if(a=Math.min(a,e+100663296),function(e){try{return l.grow(e-d.byteLength+65535>>>16),I(l.buffer),1}catch(e){}}(Math.min(r,s(Math.max(e,a),65536))))return!0}return!1},fd_write:function(e,t,r,s){for(var n=0,a=0;a<r;a++){var o=f[t>>2],i=f[t+4>>2];t+=8;for(var l=0;l<i;l++)!function(e,t){var r=eG[e];0===t||10===t?((1===e?F:S)(B(r,0)),r.length=0):r.push(t)}(e,u[o+l]);n+=i}return f[s>>2]=n,0}};(function(){var e={env:eH,wasi_snapshot_preview1:eH};function t(e,t){var r,s=e.exports;j.asm=s,I((l=j.asm.memory).buffer),A=j.asm.__indirect_function_table,r=j.asm.__wasm_call_ctors,G.unshift(r),function(e){if(D--,j.monitorRunDependencies&&j.monitorRunDependencies(D),0==D&&(null!==V&&(clearInterval(V),V=null),$)){var t=$;$=null,t()}}(0)}function r(e){t(e.instance)}function s(t){return(i||"function"!=typeof fetch?Promise.resolve().then(function(){return K(x)}):fetch(x,{credentials:"same-origin"}).then(function(e){if(!e.ok)throw"failed to load wasm binary file at '"+x+"'";return e.arrayBuffer()}).catch(function(){return K(x)})).then(function(t){return WebAssembly.instantiate(t,e)}).then(function(e){return e}).then(t,function(e){S("failed to asynchronously prepare wasm: "+e),U(e)})}if(D++,j.monitorRunDependencies&&j.monitorRunDependencies(D),j.instantiateWasm)try{return j.instantiateWasm(e,t)}catch(e){S("Module.instantiateWasm callback failed with error: "+e),a(e)}(i||"function"!=typeof WebAssembly.instantiateStreaming||W(x)||"function"!=typeof fetch?s(r):fetch(x,{credentials:"same-origin"}).then(function(t){return WebAssembly.instantiateStreaming(t,e).then(r,function(e){return S("wasm streaming compile failed: "+e),S("falling back to ArrayBuffer instantiation"),s(r)})})).catch(a)})(),j.___wasm_call_ctors=function(){return(j.___wasm_call_ctors=j.asm.__wasm_call_ctors).apply(null,arguments)},j._HP_GetStatistics=function(){return(j._HP_GetStatistics=j.asm.HP_GetStatistics).apply(null,arguments)},j._HP_Shape_CreateSphere=function(){return(j._HP_Shape_CreateSphere=j.asm.HP_Shape_CreateSphere).apply(null,arguments)},j._HP_Shape_CreateCapsule=function(){return(j._HP_Shape_CreateCapsule=j.asm.HP_Shape_CreateCapsule).apply(null,arguments)},j._HP_Shape_CreateCylinder=function(){return(j._HP_Shape_CreateCylinder=j.asm.HP_Shape_CreateCylinder).apply(null,arguments)},j._HP_Shape_CreateBox=function(){return(j._HP_Shape_CreateBox=j.asm.HP_Shape_CreateBox).apply(null,arguments)},j._HP_Shape_CreateConvexHull=function(){return(j._HP_Shape_CreateConvexHull=j.asm.HP_Shape_CreateConvexHull).apply(null,arguments)},j._HP_Shape_CreateMesh=function(){return(j._HP_Shape_CreateMesh=j.asm.HP_Shape_CreateMesh).apply(null,arguments)},j._HP_Shape_CreateHeightField=function(){return(j._HP_Shape_CreateHeightField=j.asm.HP_Shape_CreateHeightField).apply(null,arguments)},j._HP_Shape_CreateContainer=function(){return(j._HP_Shape_CreateContainer=j.asm.HP_Shape_CreateContainer).apply(null,arguments)},j._HP_Shape_Release=function(){return(j._HP_Shape_Release=j.asm.HP_Shape_Release).apply(null,arguments)},j._HP_Shape_GetType=function(){return(j._HP_Shape_GetType=j.asm.HP_Shape_GetType).apply(null,arguments)},j._HP_Shape_AddChild=function(){return(j._HP_Shape_AddChild=j.asm.HP_Shape_AddChild).apply(null,arguments)},j._HP_Shape_RemoveChild=function(){return(j._HP_Shape_RemoveChild=j.asm.HP_Shape_RemoveChild).apply(null,arguments)},j._HP_Shape_GetNumChildren=function(){return(j._HP_Shape_GetNumChildren=j.asm.HP_Shape_GetNumChildren).apply(null,arguments)},j._HP_Shape_SetChildQSTransform=function(){return(j._HP_Shape_SetChildQSTransform=j.asm.HP_Shape_SetChildQSTransform).apply(null,arguments)},j._HP_Shape_GetChildQSTransform=function(){return(j._HP_Shape_GetChildQSTransform=j.asm.HP_Shape_GetChildQSTransform).apply(null,arguments)},j._HP_Shape_SetFilterInfo=function(){return(j._HP_Shape_SetFilterInfo=j.asm.HP_Shape_SetFilterInfo).apply(null,arguments)},j._HP_Shape_GetFilterInfo=function(){return(j._HP_Shape_GetFilterInfo=j.asm.HP_Shape_GetFilterInfo).apply(null,arguments)},j._HP_Shape_SetMaterial=function(){return(j._HP_Shape_SetMaterial=j.asm.HP_Shape_SetMaterial).apply(null,arguments)},j._HP_Shape_GetMaterial=function(){return(j._HP_Shape_GetMaterial=j.asm.HP_Shape_GetMaterial).apply(null,arguments)},j._HP_Shape_SetDensity=function(){return(j._HP_Shape_SetDensity=j.asm.HP_Shape_SetDensity).apply(null,arguments)},j._HP_Shape_GetDensity=function(){return(j._HP_Shape_GetDensity=j.asm.HP_Shape_GetDensity).apply(null,arguments)},j._HP_Shape_CastRay=function(){return(j._HP_Shape_CastRay=j.asm.HP_Shape_CastRay).apply(null,arguments)},j._HP_Shape_BuildMassProperties=function(){return(j._HP_Shape_BuildMassProperties=j.asm.HP_Shape_BuildMassProperties).apply(null,arguments)},j._HP_ShapePathIterator_GetNext=function(){return(j._HP_ShapePathIterator_GetNext=j.asm.HP_ShapePathIterator_GetNext).apply(null,arguments)},j._HP_Shape_SetTrigger=function(){return(j._HP_Shape_SetTrigger=j.asm.HP_Shape_SetTrigger).apply(null,arguments)},j._HP_Shape_CreateDebugDisplayGeometry=function(){return(j._HP_Shape_CreateDebugDisplayGeometry=j.asm.HP_Shape_CreateDebugDisplayGeometry).apply(null,arguments)},j._HP_DebugGeometry_GetInfo=function(){return(j._HP_DebugGeometry_GetInfo=j.asm.HP_DebugGeometry_GetInfo).apply(null,arguments)},j._HP_DebugGeometry_Release=function(){return(j._HP_DebugGeometry_Release=j.asm.HP_DebugGeometry_Release).apply(null,arguments)},j._HP_Body_Create=function(){return(j._HP_Body_Create=j.asm.HP_Body_Create).apply(null,arguments)},j._HP_Body_Release=function(){return(j._HP_Body_Release=j.asm.HP_Body_Release).apply(null,arguments)},j._HP_Body_SetShape=function(){return(j._HP_Body_SetShape=j.asm.HP_Body_SetShape).apply(null,arguments)},j._HP_Body_GetShape=function(){return(j._HP_Body_GetShape=j.asm.HP_Body_GetShape).apply(null,arguments)},j._HP_Body_SetMotionType=function(){return(j._HP_Body_SetMotionType=j.asm.HP_Body_SetMotionType).apply(null,arguments)},j._HP_Body_GetMotionType=function(){return(j._HP_Body_GetMotionType=j.asm.HP_Body_GetMotionType).apply(null,arguments)},j._HP_Body_SetEventMask=function(){return(j._HP_Body_SetEventMask=j.asm.HP_Body_SetEventMask).apply(null,arguments)},j._HP_Body_GetEventMask=function(){return(j._HP_Body_GetEventMask=j.asm.HP_Body_GetEventMask).apply(null,arguments)},j._HP_Body_SetMassProperties=function(){return(j._HP_Body_SetMassProperties=j.asm.HP_Body_SetMassProperties).apply(null,arguments)},j._HP_Body_GetMassProperties=function(){return(j._HP_Body_GetMassProperties=j.asm.HP_Body_GetMassProperties).apply(null,arguments)},j._HP_Body_SetLinearDamping=function(){return(j._HP_Body_SetLinearDamping=j.asm.HP_Body_SetLinearDamping).apply(null,arguments)},j._HP_Body_GetLinearDamping=function(){return(j._HP_Body_GetLinearDamping=j.asm.HP_Body_GetLinearDamping).apply(null,arguments)},j._HP_Body_SetAngularDamping=function(){return(j._HP_Body_SetAngularDamping=j.asm.HP_Body_SetAngularDamping).apply(null,arguments)},j._HP_Body_GetAngularDamping=function(){return(j._HP_Body_GetAngularDamping=j.asm.HP_Body_GetAngularDamping).apply(null,arguments)},j._HP_Body_SetGravityFactor=function(){return(j._HP_Body_SetGravityFactor=j.asm.HP_Body_SetGravityFactor).apply(null,arguments)},j._HP_Body_GetGravityFactor=function(){return(j._HP_Body_GetGravityFactor=j.asm.HP_Body_GetGravityFactor).apply(null,arguments)},j._HP_Body_GetWorld=function(){return(j._HP_Body_GetWorld=j.asm.HP_Body_GetWorld).apply(null,arguments)},j._HP_Body_SetPosition=function(){return(j._HP_Body_SetPosition=j.asm.HP_Body_SetPosition).apply(null,arguments)},j._HP_Body_GetPosition=function(){return(j._HP_Body_GetPosition=j.asm.HP_Body_GetPosition).apply(null,arguments)},j._HP_Body_SetOrientation=function(){return(j._HP_Body_SetOrientation=j.asm.HP_Body_SetOrientation).apply(null,arguments)},j._HP_Body_GetOrientation=function(){return(j._HP_Body_GetOrientation=j.asm.HP_Body_GetOrientation).apply(null,arguments)},j._HP_Body_SetQTransform=function(){return(j._HP_Body_SetQTransform=j.asm.HP_Body_SetQTransform).apply(null,arguments)},j._HP_Body_GetWorldTransformOffset=function(){return(j._HP_Body_GetWorldTransformOffset=j.asm.HP_Body_GetWorldTransformOffset).apply(null,arguments)},j._HP_Body_GetQTransform=function(){return(j._HP_Body_GetQTransform=j.asm.HP_Body_GetQTransform).apply(null,arguments)},j._HP_Body_SetLinearVelocity=function(){return(j._HP_Body_SetLinearVelocity=j.asm.HP_Body_SetLinearVelocity).apply(null,arguments)},j._HP_Body_GetLinearVelocity=function(){return(j._HP_Body_GetLinearVelocity=j.asm.HP_Body_GetLinearVelocity).apply(null,arguments)},j._HP_Body_SetAngularVelocity=function(){return(j._HP_Body_SetAngularVelocity=j.asm.HP_Body_SetAngularVelocity).apply(null,arguments)},j._HP_Body_GetAngularVelocity=function(){return(j._HP_Body_GetAngularVelocity=j.asm.HP_Body_GetAngularVelocity).apply(null,arguments)},j._HP_Body_ApplyImpulse=function(){return(j._HP_Body_ApplyImpulse=j.asm.HP_Body_ApplyImpulse).apply(null,arguments)},j._HP_Body_SetTargetQTransform=function(){return(j._HP_Body_SetTargetQTransform=j.asm.HP_Body_SetTargetQTransform).apply(null,arguments)},j._HP_Body_SetActivationState=function(){return(j._HP_Body_SetActivationState=j.asm.HP_Body_SetActivationState).apply(null,arguments)},j._HP_Body_GetActivationState=function(){return(j._HP_Body_GetActivationState=j.asm.HP_Body_GetActivationState).apply(null,arguments)},j._HP_Body_SetActivationControl=function(){return(j._HP_Body_SetActivationControl=j.asm.HP_Body_SetActivationControl).apply(null,arguments)},j._HP_Body_SetActivationPriority=function(){return(j._HP_Body_SetActivationPriority=j.asm.HP_Body_SetActivationPriority).apply(null,arguments)},j._HP_Constraint_Create=function(){return(j._HP_Constraint_Create=j.asm.HP_Constraint_Create).apply(null,arguments)},j._HP_Constraint_Release=function(){return(j._HP_Constraint_Release=j.asm.HP_Constraint_Release).apply(null,arguments)},j._HP_Constraint_SetParentBody=function(){return(j._HP_Constraint_SetParentBody=j.asm.HP_Constraint_SetParentBody).apply(null,arguments)},j._HP_Constraint_GetParentBody=function(){return(j._HP_Constraint_GetParentBody=j.asm.HP_Constraint_GetParentBody).apply(null,arguments)},j._HP_Constraint_SetChildBody=function(){return(j._HP_Constraint_SetChildBody=j.asm.HP_Constraint_SetChildBody).apply(null,arguments)},j._HP_Constraint_GetChildBody=function(){return(j._HP_Constraint_GetChildBody=j.asm.HP_Constraint_GetChildBody).apply(null,arguments)},j._HP_Constraint_SetAnchorInParent=function(){return(j._HP_Constraint_SetAnchorInParent=j.asm.HP_Constraint_SetAnchorInParent).apply(null,arguments)},j._HP_Constraint_SetAnchorInChild=function(){return(j._HP_Constraint_SetAnchorInChild=j.asm.HP_Constraint_SetAnchorInChild).apply(null,arguments)},j._HP_Constraint_SetCollisionsEnabled=function(){return(j._HP_Constraint_SetCollisionsEnabled=j.asm.HP_Constraint_SetCollisionsEnabled).apply(null,arguments)},j._HP_Constraint_GetCollisionsEnabled=function(){return(j._HP_Constraint_GetCollisionsEnabled=j.asm.HP_Constraint_GetCollisionsEnabled).apply(null,arguments)},j._HP_Constraint_SetEnabled=function(){return(j._HP_Constraint_SetEnabled=j.asm.HP_Constraint_SetEnabled).apply(null,arguments)},j._HP_Constraint_GetEnabled=function(){return(j._HP_Constraint_GetEnabled=j.asm.HP_Constraint_GetEnabled).apply(null,arguments)},j._HP_Constraint_SetAxisMinLimit=function(){return(j._HP_Constraint_SetAxisMinLimit=j.asm.HP_Constraint_SetAxisMinLimit).apply(null,arguments)},j._HP_Constraint_GetAxisMinLimit=function(){return(j._HP_Constraint_GetAxisMinLimit=j.asm.HP_Constraint_GetAxisMinLimit).apply(null,arguments)},j._HP_Constraint_SetAxisMaxLimit=function(){return(j._HP_Constraint_SetAxisMaxLimit=j.asm.HP_Constraint_SetAxisMaxLimit).apply(null,arguments)},j._HP_Constraint_GetAxisMaxLimit=function(){return(j._HP_Constraint_GetAxisMaxLimit=j.asm.HP_Constraint_GetAxisMaxLimit).apply(null,arguments)},j._HP_Constraint_GetAxisMode=function(){return(j._HP_Constraint_GetAxisMode=j.asm.HP_Constraint_GetAxisMode).apply(null,arguments)},j._HP_Constraint_SetAxisMode=function(){return(j._HP_Constraint_SetAxisMode=j.asm.HP_Constraint_SetAxisMode).apply(null,arguments)},j._HP_Constraint_SetAxisFriction=function(){return(j._HP_Constraint_SetAxisFriction=j.asm.HP_Constraint_SetAxisFriction).apply(null,arguments)},j._HP_Constraint_GetAxisFriction=function(){return(j._HP_Constraint_GetAxisFriction=j.asm.HP_Constraint_GetAxisFriction).apply(null,arguments)},j._HP_Constraint_SetAxisMotorType=function(){return(j._HP_Constraint_SetAxisMotorType=j.asm.HP_Constraint_SetAxisMotorType).apply(null,arguments)},j._HP_Constraint_GetAxisMotorType=function(){return(j._HP_Constraint_GetAxisMotorType=j.asm.HP_Constraint_GetAxisMotorType).apply(null,arguments)},j._HP_Constraint_SetAxisMotorTarget=function(){return(j._HP_Constraint_SetAxisMotorTarget=j.asm.HP_Constraint_SetAxisMotorTarget).apply(null,arguments)},j._HP_Constraint_GetAxisMotorTarget=function(){return(j._HP_Constraint_GetAxisMotorTarget=j.asm.HP_Constraint_GetAxisMotorTarget).apply(null,arguments)},j._HP_Constraint_SetAxisMotorMaxForce=function(){return(j._HP_Constraint_SetAxisMotorMaxForce=j.asm.HP_Constraint_SetAxisMotorMaxForce).apply(null,arguments)},j._HP_Constraint_GetAxisMotorMaxForce=function(){return(j._HP_Constraint_GetAxisMotorMaxForce=j.asm.HP_Constraint_GetAxisMotorMaxForce).apply(null,arguments)},j._HP_Constraint_SetAxisStiffness=function(){return(j._HP_Constraint_SetAxisStiffness=j.asm.HP_Constraint_SetAxisStiffness).apply(null,arguments)},j._HP_Constraint_SetAxisDamping=function(){return(j._HP_Constraint_SetAxisDamping=j.asm.HP_Constraint_SetAxisDamping).apply(null,arguments)},j._HP_World_Create=function(){return(j._HP_World_Create=j.asm.HP_World_Create).apply(null,arguments)},j._HP_World_Release=function(){return(j._HP_World_Release=j.asm.HP_World_Release).apply(null,arguments)},j._HP_World_GetBodyBuffer=function(){return(j._HP_World_GetBodyBuffer=j.asm.HP_World_GetBodyBuffer).apply(null,arguments)},j._HP_World_SetGravity=function(){return(j._HP_World_SetGravity=j.asm.HP_World_SetGravity).apply(null,arguments)},j._HP_World_GetGravity=function(){return(j._HP_World_GetGravity=j.asm.HP_World_GetGravity).apply(null,arguments)},j._HP_World_AddBody=function(){return(j._HP_World_AddBody=j.asm.HP_World_AddBody).apply(null,arguments)},j._HP_World_RemoveBody=function(){return(j._HP_World_RemoveBody=j.asm.HP_World_RemoveBody).apply(null,arguments)},j._HP_World_GetNumBodies=function(){return(j._HP_World_GetNumBodies=j.asm.HP_World_GetNumBodies).apply(null,arguments)},j._HP_World_CastRayWithCollector=function(){return(j._HP_World_CastRayWithCollector=j.asm.HP_World_CastRayWithCollector).apply(null,arguments)},j._HP_World_Step=function(){return(j._HP_World_Step=j.asm.HP_World_Step).apply(null,arguments)},j._HP_World_SetIdealStepTime=function(){return(j._HP_World_SetIdealStepTime=j.asm.HP_World_SetIdealStepTime).apply(null,arguments)},j._HP_World_GetNextCollisionEvent=function(){return(j._HP_World_GetNextCollisionEvent=j.asm.HP_World_GetNextCollisionEvent).apply(null,arguments)},j._HP_World_GetNextTriggerEvent=function(){return(j._HP_World_GetNextTriggerEvent=j.asm.HP_World_GetNextTriggerEvent).apply(null,arguments)},j._HP_QueryCollector_Create=function(){return(j._HP_QueryCollector_Create=j.asm.HP_QueryCollector_Create).apply(null,arguments)},j._HP_QueryCollector_Release=function(){return(j._HP_QueryCollector_Release=j.asm.HP_QueryCollector_Release).apply(null,arguments)},j._HP_QueryCollector_GetNumHits=function(){return(j._HP_QueryCollector_GetNumHits=j.asm.HP_QueryCollector_GetNumHits).apply(null,arguments)},j._HP_QueryCollector_GetCastRayResult=function(){return(j._HP_QueryCollector_GetCastRayResult=j.asm.HP_QueryCollector_GetCastRayResult).apply(null,arguments)},j._main=function(){return(j._main=j.asm.main).apply(null,arguments)};var ek=j._malloc=function(){return(ek=j._malloc=j.asm.malloc).apply(null,arguments)},eD=j._free=function(){return(eD=j._free=j.asm.free).apply(null,arguments)},eV=(j._HP_Debug_StartRecordingStats=function(){return(j._HP_Debug_StartRecordingStats=j.asm.HP_Debug_StartRecordingStats).apply(null,arguments)},j._HP_Debug_StopRecordingStats=function(){return(j._HP_Debug_StopRecordingStats=j.asm.HP_Debug_StopRecordingStats).apply(null,arguments)},j.___errno_location=function(){return(j.___errno_location=j.asm.__errno_location).apply(null,arguments)},j._htons=function(){return(j._htons=j.asm.htons).apply(null,arguments)},j._ntohs=function(){return(j._ntohs=j.asm.ntohs).apply(null,arguments)},j.___getTypeName=function(){return(eV=j.___getTypeName=j.asm.__getTypeName).apply(null,arguments)});function e$(e){e=e||L,!(D>0)&&(function(){if(j.preRun)for("function"==typeof j.preRun&&(j.preRun=[j.preRun]);j.preRun.length;){var e;e=j.preRun.shift(),N.unshift(e)}q(N)}(),D>0||(j.setStatus?(j.setStatus("Running..."),setTimeout(function(){setTimeout(function(){j.setStatus("")},1),t()},1)):t()));function t(){!M&&(M=!0,j.calledRun=!0,O||(q(G),q(H),n(j),j.onRuntimeInitialized&&j.onRuntimeInitialized(),eU&&function(e){var t=j._main;try{var r=t(0,0);c=r,c=r,w||(j.onExit&&j.onExit(r),O=!0),C(r,new X(r))}catch(e){return function(e){if(e instanceof X||"unwind"==e)return c;C(1,e)}(e)}}(0),function(){if(j.postRun)for("function"==typeof j.postRun&&(j.postRun=[j.postRun]);j.postRun.length;){var e;e=j.postRun.shift(),k.unshift(e)}q(k)}()))}}if(j.__embind_initialize_bindings=function(){return(j.__embind_initialize_bindings=j.asm._embind_initialize_bindings).apply(null,arguments)},j._htonl=function(){return(j._htonl=j.asm.htonl).apply(null,arguments)},j._setThrew=function(){return(j._setThrew=j.asm.setThrew).apply(null,arguments)},j._saveSetjmp=function(){return(j._saveSetjmp=j.asm.saveSetjmp).apply(null,arguments)},j.stackSave=function(){return(j.stackSave=j.asm.stackSave).apply(null,arguments)},j.stackRestore=function(){return(j.stackRestore=j.asm.stackRestore).apply(null,arguments)},j.stackAlloc=function(){return(j.stackAlloc=j.asm.stackAlloc).apply(null,arguments)},$=function e(){M||e$(),M||($=e)},j.preInit)for("function"==typeof j.preInit&&(j.preInit=[j.preInit]);j.preInit.length>0;)j.preInit.pop()();var eU=!0;return j.noInitialRun&&(eU=!1),e$(),t.ready});r.default=n},{af2f6bf6b6d9048a:"2B47u","@parcel/transformer-js/src/esmodule-helpers.js":"XTfsy"}],"2B47u":[function(e,t,r){t.exports=e("d8aae0bfd0f0377b").getBundleURL("cuTmy")+"HavokPhysics.9608d1f5.wasm"},{d8aae0bfd0f0377b:"gEpYW"}],dfETV:[function(e,t,r){var s=e("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(r),s.export(r,"loadEnemyModel",()=>h),s.export(r,"loadDamageEnemyModel",()=>u),s.export(r,"loadMenuItemModel",()=>_),s.export(r,"loadMenuItem2Model",()=>p),s.export(r,"loadShieldYarModel",()=>m),s.export(r,"loadShieldYarPartModel",()=>f),s.export(r,"loadToAssetContainer",()=>l),s.export(r,"mergeMeshes",()=>i),s.export(r,"loadModel",()=>c),s.export(r,"instateMesh",()=>d);var n=e("@/game_state/assets/state"),a=e("@babylonjs/core");e("@babylonjs/loaders");let o=async(e,t,r)=>new Promise((s,n)=>{(0,a.SceneLoader).LoadAssetContainer(e,t,r,function(e){s(e)})}),i=e=>{let t=(0,a.Mesh).MergeMeshes(e.rootNodes[0].getChildMeshes(),!0,!1,null,null,!0);return t.scaling=new a.Vector3(1,1,1),t.position=new a.Vector3(0,0,0),t};async function l(e,t,r){return await o(e,t,r)}async function c(e,t,r){return await l(e,t,r)}function d(e,t){return i(t.instantiateModelsToScene(()=>e,!0))}function h(e){c("public/models/","cristal_one.glb",e).then(e=>{(0,n.ASSETS).containers3D.set("cristal",e)})}function u(e){c("public/models/","damage.glb",e).then(e=>{(0,n.ASSETS).containers3D.set("enemy_damage",e)})}function _(e){return new Promise(t=>{c("public/models/menu/","menuItem.glb",e).then(e=>{(0,n.ASSETS).containers3D.set("menu_item",e),t(!0)})})}function p(e){return new Promise(t=>{c("public/models/","menuItem2.glb",e).then(e=>{(0,n.ASSETS).containers3D.set("menu_item",e),t(!0)})})}function m(e){return new Promise(t=>{c("public/models/","shield_yar.glb",e).then(e=>{(0,n.ASSETS).containers3D.set("shield_yar",e),t(!0)})})}function f(e){return new Promise(t=>{c("public/models/","shield_yar_prt.glb",e).then(e=>{(0,n.ASSETS).containers3D.set("shield_yar_prt",e),t(!0)})})}},{"@/game_state/assets/state":"eemMA","@babylonjs/core":"1KKys","@babylonjs/loaders":"kfXwA","@parcel/transformer-js/src/esmodule-helpers.js":"XTfsy"}],kfXwA:[function(e,t,r){var s=e("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(r);var n=e("./glTF/index.js");s.exportAll(n,r);var a=e("./OBJ/index.js");s.exportAll(a,r);var o=e("./STL/index.js");s.exportAll(o,r);var i=e("./SPLAT/index.js");s.exportAll(i,r)},{"./glTF/index.js":"hgHFW","./OBJ/index.js":"7qwNs","./STL/index.js":"hovy3","./SPLAT/index.js":"lB3Rc","@parcel/transformer-js/src/esmodule-helpers.js":"XTfsy"}],hgHFW:[function(e,t,r){var s=e("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(r),s.export(r,"GLTF1",()=>o),s.export(r,"GLTF2",()=>i);var n=e("./glTFFileLoader.js");s.exportAll(n,r);var a=e("./glTFValidation.js");s.exportAll(a,r);var o=e("./1.0/index.js"),i=e("./2.0/index.js")},{"./glTFFileLoader.js":"GX9kb","./glTFValidation.js":"jg0XJ","./1.0/index.js":"9noXw","./2.0/index.js":"h2sWA","@parcel/transformer-js/src/esmodule-helpers.js":"XTfsy"}],GX9kb:[function(e,t,r){var s,n,a,o,i,l,c=e("@parcel/transformer-js/src/esmodule-helpers.js");c.defineInteropFlag(r),c.export(r,"GLTFLoaderCoordinateSystemMode",()=>o),c.export(r,"GLTFLoaderAnimationStartMode",()=>i),c.export(r,"GLTFLoaderState",()=>l),c.export(r,"GLTFFileLoader",()=>T);var d=e("@babylonjs/core/Misc/observable.js"),h=e("@babylonjs/core/Misc/tools.js"),u=e("@babylonjs/core/Loading/sceneLoader.js"),_=e("@babylonjs/core/assetContainer.js"),p=e("@babylonjs/core/Misc/logger.js"),m=e("@babylonjs/core/Misc/dataReader.js"),f=e("./glTFValidation.js"),y=e("@babylonjs/core/Misc/fileTools.js"),b=e("@babylonjs/core/Misc/error.js");function g(e,t,r){try{return Promise.resolve(new Uint8Array(e,t,r))}catch(e){return Promise.reject(e)}}(s=o||(o={}))[s.AUTO=0]="AUTO",s[s.FORCE_RIGHT_HANDED=1]="FORCE_RIGHT_HANDED",(n=i||(i={}))[n.NONE=0]="NONE",n[n.FIRST=1]="FIRST",n[n.ALL=2]="ALL",(a=l||(l={}))[a.LOADING=0]="LOADING",a[a.READY=1]="READY",a[a.COMPLETE=2]="COMPLETE";class T{constructor(){this.onParsedObservable=new d.Observable,this.coordinateSystemMode=o.AUTO,this.animationStartMode=i.FIRST,this.compileMaterials=!1,this.useClipPlane=!1,this.compileShadowGenerators=!1,this.transparencyAsCoverage=!1,this.useRangeRequests=!1,this.createInstances=!0,this.alwaysComputeBoundingBox=!1,this.loadAllMaterials=!1,this.loadOnlyMaterials=!1,this.skipMaterials=!1,this.useSRGBBuffers=!0,this.targetFps=60,this.alwaysComputeSkeletonRootNode=!1,this.preprocessUrlAsync=e=>Promise.resolve(e),this.onMeshLoadedObservable=new d.Observable,this.onSkinLoadedObservable=new d.Observable,this.onTextureLoadedObservable=new d.Observable,this.onMaterialLoadedObservable=new d.Observable,this.onCameraLoadedObservable=new d.Observable,this.onCompleteObservable=new d.Observable,this.onErrorObservable=new d.Observable,this.onDisposeObservable=new d.Observable,this.onExtensionLoadedObservable=new d.Observable,this.validate=!1,this.onValidatedObservable=new d.Observable,this._loader=null,this._state=null,this._requests=[],this.name="gltf",this.extensions={".gltf":{isBinary:!1},".glb":{isBinary:!0}},this.onLoaderStateChangedObservable=new d.Observable,this._logIndentLevel=0,this._loggingEnabled=!1,this._log=this._logDisabled,this._capturePerformanceCounters=!1,this._startPerformanceCounter=this._startPerformanceCounterDisabled,this._endPerformanceCounter=this._endPerformanceCounterDisabled}set onParsed(e){this._onParsedObserver&&this.onParsedObservable.remove(this._onParsedObserver),this._onParsedObserver=this.onParsedObservable.add(e)}set onMeshLoaded(e){this._onMeshLoadedObserver&&this.onMeshLoadedObservable.remove(this._onMeshLoadedObserver),this._onMeshLoadedObserver=this.onMeshLoadedObservable.add(e)}set onTextureLoaded(e){this._onTextureLoadedObserver&&this.onTextureLoadedObservable.remove(this._onTextureLoadedObserver),this._onTextureLoadedObserver=this.onTextureLoadedObservable.add(e)}set onMaterialLoaded(e){this._onMaterialLoadedObserver&&this.onMaterialLoadedObservable.remove(this._onMaterialLoadedObserver),this._onMaterialLoadedObserver=this.onMaterialLoadedObservable.add(e)}set onCameraLoaded(e){this._onCameraLoadedObserver&&this.onCameraLoadedObservable.remove(this._onCameraLoadedObserver),this._onCameraLoadedObserver=this.onCameraLoadedObservable.add(e)}set onComplete(e){this._onCompleteObserver&&this.onCompleteObservable.remove(this._onCompleteObserver),this._onCompleteObserver=this.onCompleteObservable.add(e)}set onError(e){this._onErrorObserver&&this.onErrorObservable.remove(this._onErrorObserver),this._onErrorObserver=this.onErrorObservable.add(e)}set onDispose(e){this._onDisposeObserver&&this.onDisposeObservable.remove(this._onDisposeObserver),this._onDisposeObserver=this.onDisposeObservable.add(e)}set onExtensionLoaded(e){this._onExtensionLoadedObserver&&this.onExtensionLoadedObservable.remove(this._onExtensionLoadedObserver),this._onExtensionLoadedObserver=this.onExtensionLoadedObservable.add(e)}get loggingEnabled(){return this._loggingEnabled}set loggingEnabled(e){this._loggingEnabled!==e&&(this._loggingEnabled=e,this._loggingEnabled?this._log=this._logEnabled:this._log=this._logDisabled)}get capturePerformanceCounters(){return this._capturePerformanceCounters}set capturePerformanceCounters(e){this._capturePerformanceCounters!==e&&(this._capturePerformanceCounters=e,this._capturePerformanceCounters?(this._startPerformanceCounter=this._startPerformanceCounterEnabled,this._endPerformanceCounter=this._endPerformanceCounterEnabled):(this._startPerformanceCounter=this._startPerformanceCounterDisabled,this._endPerformanceCounter=this._endPerformanceCounterDisabled))}set onValidated(e){this._onValidatedObserver&&this.onValidatedObservable.remove(this._onValidatedObserver),this._onValidatedObserver=this.onValidatedObservable.add(e)}dispose(){for(let e of(this._loader&&(this._loader.dispose(),this._loader=null),this._requests))e.abort();this._requests.length=0,delete this._progressCallback,this.preprocessUrlAsync=e=>Promise.resolve(e),this.onMeshLoadedObservable.clear(),this.onSkinLoadedObservable.clear(),this.onTextureLoadedObservable.clear(),this.onMaterialLoadedObservable.clear(),this.onCameraLoadedObservable.clear(),this.onCompleteObservable.clear(),this.onExtensionLoadedObservable.clear(),this.onDisposeObservable.notifyObservers(void 0),this.onDisposeObservable.clear()}loadFile(e,t,r,s,n,a,o,i){if(ArrayBuffer.isView(t))return this._loadBinary(e,t,r,s,o,i),null;this._progressCallback=n;let l=t.name||(0,h.Tools).GetFilename(t);if(!a)return this._loadFile(e,t,t=>{this._validate(e,t,r,l),s({json:this._parseJson(t)})},!1,o);if(this.useRangeRequests){this.validate&&(0,p.Logger).Warn("glTF validation is not supported when range requests are enabled");let r={abort:()=>{},onCompleteObservable:new d.Observable};return this._unpackBinaryAsync(new m.DataReader({readAsync:(r,s)=>new Promise((n,a)=>{this._loadFile(e,t,e=>{n(new Uint8Array(e))},!0,e=>{a(e)},e=>{e.setRequestHeader("Range",`bytes=${r}-${r+s-1}`)})}),byteLength:0})).then(e=>{r.onCompleteObservable.notifyObservers(r),s(e)},o?e=>o(void 0,e):void 0),r}return this._loadFile(e,t,t=>{this._validate(e,new Uint8Array(t,0,t.byteLength),r,l),this._unpackBinaryAsync(new m.DataReader({readAsync:(e,r)=>g(t,e,r),byteLength:t.byteLength})).then(e=>{s(e)},o?e=>o(void 0,e):void 0)},!0,o)}_loadBinary(e,t,r,s,n,a){this._validate(e,new Uint8Array(t.buffer,t.byteOffset,t.byteLength),r,a),this._unpackBinaryAsync(new m.DataReader({readAsync:(e,r)=>(function(e,t,r){try{if(t<0||t>=e.byteLength)throw RangeError("Offset is out of range.");if(t+r>e.byteLength)throw RangeError("Length is out of range.");return Promise.resolve(new Uint8Array(e.buffer,e.byteOffset+t,r))}catch(e){return Promise.reject(e)}})(t,e,r),byteLength:t.byteLength})).then(e=>{s(e)},n?e=>n(void 0,e):void 0)}importMeshAsync(e,t,r,s,n,a){return Promise.resolve().then(()=>(this.onParsedObservable.notifyObservers(r),this.onParsedObservable.clear(),this._log(`Loading ${a||""}`),this._loader=this._getLoader(r),this._loader.importMeshAsync(e,t,null,r,s,n,a)))}loadAsync(e,t,r,s,n){return Promise.resolve().then(()=>(this.onParsedObservable.notifyObservers(t),this.onParsedObservable.clear(),this._log(`Loading ${n||""}`),this._loader=this._getLoader(t),this._loader.loadAsync(e,t,r,s,n)))}loadAssetContainerAsync(e,t,r,s,n){return Promise.resolve().then(()=>{this.onParsedObservable.notifyObservers(t),this.onParsedObservable.clear(),this._log(`Loading ${n||""}`),this._loader=this._getLoader(t);let a=new _.AssetContainer(e),o=[];this.onMaterialLoadedObservable.add(e=>{o.push(e)});let i=[];this.onTextureLoadedObservable.add(e=>{i.push(e)});let l=[];this.onCameraLoadedObservable.add(e=>{l.push(e)});let c=[];return this.onMeshLoadedObservable.add(e=>{e.morphTargetManager&&c.push(e.morphTargetManager)}),this._loader.importMeshAsync(null,e,a,t,r,s,n).then(e=>(Array.prototype.push.apply(a.geometries,e.geometries),Array.prototype.push.apply(a.meshes,e.meshes),Array.prototype.push.apply(a.particleSystems,e.particleSystems),Array.prototype.push.apply(a.skeletons,e.skeletons),Array.prototype.push.apply(a.animationGroups,e.animationGroups),Array.prototype.push.apply(a.materials,o),Array.prototype.push.apply(a.textures,i),Array.prototype.push.apply(a.lights,e.lights),Array.prototype.push.apply(a.transformNodes,e.transformNodes),Array.prototype.push.apply(a.cameras,l),Array.prototype.push.apply(a.morphTargetManagers,c),a))})}canDirectLoad(e){return -1!==e.indexOf("asset")&&-1!==e.indexOf("version")||e.startsWith("data:base64,"+T._MagicBase64Encoded)||e.startsWith("data:;base64,"+T._MagicBase64Encoded)||e.startsWith("data:application/octet-stream;base64,"+T._MagicBase64Encoded)||e.startsWith("data:model/gltf-binary;base64,"+T._MagicBase64Encoded)}directLoad(e,t){if(t.startsWith("base64,"+T._MagicBase64Encoded)||t.startsWith(";base64,"+T._MagicBase64Encoded)||t.startsWith("application/octet-stream;base64,"+T._MagicBase64Encoded)||t.startsWith("model/gltf-binary;base64,"+T._MagicBase64Encoded)){let r=(0,y.DecodeBase64UrlToBinary)(t);return this._validate(e,new Uint8Array(r,0,r.byteLength)),this._unpackBinaryAsync(new m.DataReader({readAsync:(e,t)=>g(r,e,t),byteLength:r.byteLength}))}return this._validate(e,t),Promise.resolve({json:this._parseJson(t)})}createPlugin(){return new T}get loaderState(){return this._state}whenCompleteAsync(){return new Promise((e,t)=>{this.onCompleteObservable.addOnce(()=>{e()}),this.onErrorObservable.addOnce(e=>{t(e)})})}_setState(e){this._state!==e&&(this._state=e,this.onLoaderStateChangedObservable.notifyObservers(this._state),this._log(l[this._state]))}_loadFile(e,t,r,s,n,a){let o=e._loadFile(t,r,e=>{this._onProgress(e,o)},!0,s,n,a);return o.onCompleteObservable.add(e=>{this._requests.splice(this._requests.indexOf(e),1)}),this._requests.push(o),o}_onProgress(e,t){if(!this._progressCallback)return;t._lengthComputable=e.lengthComputable,t._loaded=e.loaded,t._total=e.total;let r=!0,s=0,n=0;for(let e of this._requests){if(void 0===e._lengthComputable||void 0===e._loaded||void 0===e._total)return;r=r&&e._lengthComputable,s+=e._loaded,n+=e._total}this._progressCallback({lengthComputable:r,loaded:s,total:r?n:0})}_validate(e,t,r="",s=""){this.validate&&(this._startPerformanceCounter("Validate JSON"),(0,f.GLTFValidation).ValidateAsync(t,r,s,t=>this.preprocessUrlAsync(r+t).then(t=>e._loadFileAsync(t,void 0,!0,!0).then(e=>new Uint8Array(e,0,e.byteLength)))).then(e=>{this._endPerformanceCounter("Validate JSON"),this.onValidatedObservable.notifyObservers(e),this.onValidatedObservable.clear()},e=>{this._endPerformanceCounter("Validate JSON"),(0,h.Tools).Warn(`Failed to validate: ${e.message}`),this.onValidatedObservable.clear()}))}_getLoader(e){let t=e.json.asset||{};this._log(`Asset version: ${t.version}`),t.minVersion&&this._log(`Asset minimum version: ${t.minVersion}`),t.generator&&this._log(`Asset generator: ${t.generator}`);let r=T._parseVersion(t.version);if(!r)throw Error("Invalid version: "+t.version);if(void 0!==t.minVersion){let e=T._parseVersion(t.minVersion);if(!e)throw Error("Invalid minimum version: "+t.minVersion);if(T._compareVersion(e,{major:2,minor:0})>0)throw Error("Incompatible minimum version: "+t.minVersion)}let s={1:T._CreateGLTF1Loader,2:T._CreateGLTF2Loader}[r.major];if(!s)throw Error("Unsupported version: "+t.version);return s(this)}_parseJson(e){this._startPerformanceCounter("Parse JSON"),this._log(`JSON length: ${e.length}`);let t=JSON.parse(e);return this._endPerformanceCounter("Parse JSON"),t}_unpackBinaryAsync(e){return this._startPerformanceCounter("Unpack Binary"),e.loadAsync(20).then(()=>{let t;let r=e.readUint32();if(1179937895!==r)throw new b.RuntimeError("Unexpected magic: "+r,b.ErrorCodes.GLTFLoaderUnexpectedMagicError);let s=e.readUint32();this.loggingEnabled&&this._log(`Binary version: ${s}`);let n=e.readUint32();switch(this.useRangeRequests||n===e.buffer.byteLength||(0,p.Logger).Warn(`Length in header does not match actual data length: ${n} != ${e.buffer.byteLength}`),s){case 1:t=this._unpackBinaryV1Async(e,n);break;case 2:t=this._unpackBinaryV2Async(e,n);break;default:throw Error("Unsupported version: "+s)}return this._endPerformanceCounter("Unpack Binary"),t})}_unpackBinaryV1Async(e,t){let r=e.readUint32(),s=e.readUint32();if(0!==s)throw Error(`Unexpected content format: ${s}`);let n=t-e.byteOffset,a={json:this._parseJson(e.readString(r)),bin:null};if(0!==n){let t=e.byteOffset;a.bin={readAsync:(r,s)=>e.buffer.readAsync(t+r,s),byteLength:n}}return Promise.resolve(a)}_unpackBinaryV2Async(e,t){let r={JSON:1313821514,BIN:5130562},s=e.readUint32();if(e.readUint32()!==r.JSON)throw Error("First chunk format is not JSON");return e.byteOffset+s===t?e.loadAsync(s).then(()=>({json:this._parseJson(e.readString(s)),bin:null})):e.loadAsync(s+8).then(()=>{let n={json:this._parseJson(e.readString(s)),bin:null},a=()=>{let s=e.readUint32();switch(e.readUint32()){case r.JSON:throw Error("Unexpected JSON chunk");case r.BIN:{let t=e.byteOffset;n.bin={readAsync:(r,s)=>e.buffer.readAsync(t+r,s),byteLength:s},e.skipBytes(s);break}default:e.skipBytes(s)}return e.byteOffset!==t?e.loadAsync(8).then(a):Promise.resolve(n)};return a()})}static _parseVersion(e){if("1.0"===e||"1.0.1"===e)return{major:1,minor:0};let t=(e+"").match(/^(\d+)\.(\d+)/);return t?{major:parseInt(t[1]),minor:parseInt(t[2])}:null}static _compareVersion(e,t){return e.major>t.major?1:e.major<t.major?-1:e.minor>t.minor?1:e.minor<t.minor?-1:0}_logOpen(e){this._log(e),this._logIndentLevel++}_logClose(){--this._logIndentLevel}_logEnabled(e){let t=T._logSpaces.substr(0,2*this._logIndentLevel);(0,p.Logger).Log(`${t}${e}`)}_logDisabled(e){}_startPerformanceCounterEnabled(e){(0,h.Tools).StartPerformanceCounter(e)}_startPerformanceCounterDisabled(e){}_endPerformanceCounterEnabled(e){(0,h.Tools).EndPerformanceCounter(e)}_endPerformanceCounterDisabled(e){}}T.IncrementalLoading=!0,T.HomogeneousCoordinates=!1,T._MagicBase64Encoded="Z2xURg",T._logSpaces="                                ",u.SceneLoader&&(0,u.SceneLoader).RegisterPlugin(new T)},{"@babylonjs/core/Misc/observable.js":"7yHKY","@babylonjs/core/Misc/tools.js":"ieufJ","@babylonjs/core/Loading/sceneLoader.js":"8wULc","@babylonjs/core/assetContainer.js":"133YM","@babylonjs/core/Misc/logger.js":"5C8M2","@babylonjs/core/Misc/dataReader.js":"bHyjq","./glTFValidation.js":"jg0XJ","@babylonjs/core/Misc/fileTools.js":"cF4Gd","@babylonjs/core/Misc/error.js":"9T0Fo","@parcel/transformer-js/src/esmodule-helpers.js":"XTfsy"}],jg0XJ:[function(e,t,r){var s=e("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(r),s.export(r,"GLTFValidation",()=>i);var n=e("@babylonjs/core/Misc/tools.js");function a(e,t,r,s){let n={externalResourceFunction:s};return r&&(n.uri="file:"===t?r:t+r),ArrayBuffer.isView(e)?GLTFValidator.validateBytes(e,n):GLTFValidator.validateString(e,n)}function o(){let e=[];onmessage=t=>{let r=t.data;switch(r.id){case"init":importScripts(r.url);break;case"validate":a(r.data,r.rootUrl,r.fileName,t=>new Promise((r,s)=>{let n=e.length;e.push({resolve:r,reject:s}),postMessage({id:"getExternalResource",index:n,uri:t})})).then(e=>{postMessage({id:"validate.resolve",value:e})},e=>{postMessage({id:"validate.reject",reason:e})});break;case"getExternalResource.resolve":e[r.index].resolve(r.value);break;case"getExternalResource.reject":e[r.index].reject(r.reason)}}}class i{static ValidateAsync(e,t,r,s){return"function"==typeof Worker?new Promise((i,l)=>{let c=`${a}(${o})()`,d=new Worker(URL.createObjectURL(new Blob([c],{type:"application/javascript"}))),h=e=>{d.removeEventListener("error",h),d.removeEventListener("message",u),l(e)},u=e=>{let t=e.data;switch(t.id){case"getExternalResource":s(t.uri).then(e=>{d.postMessage({id:"getExternalResource.resolve",index:t.index,value:e},[e])},e=>{d.postMessage({id:"getExternalResource.reject",index:t.index,reason:e})});break;case"validate.resolve":d.removeEventListener("error",h),d.removeEventListener("message",u),i(t.value),d.terminate();break;case"validate.reject":d.removeEventListener("error",h),d.removeEventListener("message",u),l(t.reason),d.terminate()}};if(d.addEventListener("error",h),d.addEventListener("message",u),d.postMessage({id:"init",url:(0,n.Tools).GetBabylonScriptURL(this.Configuration.url)}),ArrayBuffer.isView(e)){let s=e.slice();d.postMessage({id:"validate",data:s,rootUrl:t,fileName:r},[s.buffer])}else d.postMessage({id:"validate",data:e,rootUrl:t,fileName:r})}):(this._LoadScriptPromise||(this._LoadScriptPromise=(0,n.Tools).LoadBabylonScriptAsync(this.Configuration.url)),this._LoadScriptPromise.then(()=>a(e,t,r,s)))}}i.Configuration={url:`${n.Tools._DefaultCdnUrl}/gltf_validator.js`}},{"@babylonjs/core/Misc/tools.js":"ieufJ","@parcel/transformer-js/src/esmodule-helpers.js":"XTfsy"}],"9noXw":[function(e,t,r){var s=e("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(r);var n=e("./glTFBinaryExtension.js");s.exportAll(n,r);var a=e("./glTFLoader.js");s.exportAll(a,r);var o=e("./glTFLoaderInterfaces.js");s.exportAll(o,r);var i=e("./glTFLoaderUtils.js");s.exportAll(i,r);var l=e("./glTFMaterialsCommonExtension.js");s.exportAll(l,r)},{"./glTFBinaryExtension.js":"7EBUT","./glTFLoader.js":"7RXC9","./glTFLoaderInterfaces.js":"eWSDw","./glTFLoaderUtils.js":"hTCOH","./glTFMaterialsCommonExtension.js":"hbxDH","@parcel/transformer-js/src/esmodule-helpers.js":"XTfsy"}],"7EBUT":[function(e,t,r){var s=e("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(r),s.export(r,"GLTFBinaryExtension",()=>i);var n=e("./glTFLoader.js"),a=e("./glTFLoaderUtils.js"),o=e("./glTFLoaderInterfaces.js");class i extends n.GLTFLoaderExtension{constructor(){super("KHR_binary_glTF")}loadRuntimeAsync(e,t,r,s){let a=t.json.extensionsUsed;return!!a&&-1!==a.indexOf(this.name)&&!!t.bin&&(this._bin=t.bin,s((0,n.GLTFLoaderBase).CreateRuntime(t.json,e,r)),!0)}loadBufferAsync(e,t,r,s){return -1!==e.extensionsUsed.indexOf(this.name)&&"binary_glTF"===t&&(this._bin.readAsync(0,this._bin.byteLength).then(r,e=>s(e.message)),!0)}loadTextureBufferAsync(e,t,r){let s=e.textures[t],n=e.images[s.source];if(!n.extensions||!(this.name in n.extensions))return!1;let i=n.extensions[this.name],l=e.bufferViews[i.bufferView];return r((0,a.GLTFUtils).GetBufferFromBufferView(e,l,0,l.byteLength,o.EComponentType.UNSIGNED_BYTE)),!0}loadShaderStringAsync(e,t,r){let s=e.shaders[t];if(!s.extensions||!(this.name in s.extensions))return!1;let n=s.extensions[this.name],i=e.bufferViews[n.bufferView],l=(0,a.GLTFUtils).GetBufferFromBufferView(e,i,0,i.byteLength,o.EComponentType.UNSIGNED_BYTE);return setTimeout(()=>{r((0,a.GLTFUtils).DecodeBufferToText(l))}),!0}}(0,n.GLTFLoader).RegisterExtension(new i)},{"./glTFLoader.js":"7RXC9","./glTFLoaderUtils.js":"hTCOH","./glTFLoaderInterfaces.js":"eWSDw","@parcel/transformer-js/src/esmodule-helpers.js":"XTfsy"}],"7RXC9":[function(e,t,r){var s,n,a=e("@parcel/transformer-js/src/esmodule-helpers.js");a.defineInteropFlag(r),a.export(r,"GLTFLoaderBase",()=>ed),a.export(r,"GLTFLoader",()=>eh),a.export(r,"GLTFLoaderExtension",()=>eu);var o=e("./glTFLoaderInterfaces.js"),i=e("@babylonjs/core/Maths/math.vector.js"),l=e("@babylonjs/core/Maths/math.color.js"),c=e("@babylonjs/core/Misc/tools.js"),d=e("@babylonjs/core/Cameras/camera.js"),h=e("@babylonjs/core/Cameras/freeCamera.js"),u=e("@babylonjs/core/Animations/animation.js"),_=e("@babylonjs/core/Bones/bone.js"),p=e("@babylonjs/core/Bones/skeleton.js"),m=e("@babylonjs/core/Materials/effect.js"),f=e("@babylonjs/core/Materials/material.js"),y=e("@babylonjs/core/Materials/multiMaterial.js"),b=e("@babylonjs/core/Materials/standardMaterial.js"),g=e("@babylonjs/core/Materials/shaderMaterial.js"),T=e("@babylonjs/core/Materials/Textures/texture.js"),A=e("@babylonjs/core/Meshes/mesh.vertexData.js"),x=e("@babylonjs/core/Buffers/buffer.js"),v=e("@babylonjs/core/Meshes/geometry.js"),M=e("@babylonjs/core/Meshes/subMesh.js"),j=e("@babylonjs/core/Meshes/abstractMesh.js"),E=e("@babylonjs/core/Meshes/mesh.js"),L=e("@babylonjs/core/Lights/hemisphericLight.js"),C=e("@babylonjs/core/Lights/directionalLight.js"),P=e("@babylonjs/core/Lights/pointLight.js"),F=e("@babylonjs/core/Lights/spotLight.js"),S=e("./glTFLoaderUtils.js"),w=e("../glTFFileLoader.js"),O=e("@babylonjs/core/Engines/constants.js");(s=n||(n={}))[s.IDENTIFIER=1]="IDENTIFIER",s[s.UNKNOWN=2]="UNKNOWN",s[s.END_OF_INPUT=3]="END_OF_INPUT";class R{constructor(e){this._pos=0,this.currentToken=n.UNKNOWN,this.currentIdentifier="",this.currentString="",this.isLetterOrDigitPattern=/^[a-zA-Z0-9]+$/,this._toParse=e,this._maxPos=e.length}getNextToken(){if(this.isEnd())return n.END_OF_INPUT;if(this.currentString=this.read(),this.currentToken=n.UNKNOWN,"_"===this.currentString||this.isLetterOrDigitPattern.test(this.currentString))for(this.currentToken=n.IDENTIFIER,this.currentIdentifier=this.currentString;!this.isEnd()&&(this.isLetterOrDigitPattern.test(this.currentString=this.peek())||"_"===this.currentString);)this.currentIdentifier+=this.currentString,this.forward();return this.currentToken}peek(){return this._toParse[this._pos]}read(){return this._toParse[this._pos++]}forward(){this._pos++}isEnd(){return this._pos>=this._maxPos}}let B=["MODEL","VIEW","PROJECTION","MODELVIEW","MODELVIEWPROJECTION","JOINTMATRIX"],I=["world","view","projection","worldView","worldViewProjection","mBones"],N=["translation","rotation","scale"],G=["position","rotationQuaternion","scaling"],H=(e,t)=>{for(let r in e){let s=e[r];t.buffers[r]=s,t.buffersCount++}},k=(e,t)=>{for(let r in e){let s=e[r];t.shaders[r]=s,t.shaderscount++}},D=(e,t,r)=>{for(let s in e){let n=e[s];r[t][s]=n}},V=e=>{if(e)for(let t=0;t<e.length/2;t++)e[2*t+1]=1-e[2*t+1]},$=e=>{if("NORMAL"===e.semantic)return"normal";if("POSITION"===e.semantic)return"position";if("JOINT"===e.semantic)return"matricesIndices";if("WEIGHT"===e.semantic)return"matricesWeights";if("COLOR"===e.semantic)return"color";if(e.semantic&&-1!==e.semantic.indexOf("TEXCOORD_")){let t=Number(e.semantic.split("_")[1]);return"uv"+(0===t?"":t+1)}return null},U=e=>{for(let t in e.animations){let r=e.animations[t];if(!r.channels||!r.samplers)continue;let s=null;for(let n=0;n<r.channels.length;n++){let a=r.channels[n],o=r.samplers[a.sampler];if(!o)continue;let l=null,d=null;r.parameters?(l=r.parameters[o.input],d=r.parameters[o.output]):(l=o.input,d=o.output);let h=(0,S.GLTFUtils).GetBufferFromAccessor(e,e.accessors[l]),p=(0,S.GLTFUtils).GetBufferFromAccessor(e,e.accessors[d]),m=a.target.id,f=e.scene.getNodeById(m);if(null===f&&(f=e.scene.getNodeByName(m)),null===f){(0,c.Tools).Warn("Creating animation named "+t+". But cannot find node named "+m+" to attach to");continue}let y=f instanceof _.Bone,b=a.target.path,g=N.indexOf(b);-1!==g&&(b=G[g]);let T=u.Animation.ANIMATIONTYPE_MATRIX;y||("rotationQuaternion"===b?(T=u.Animation.ANIMATIONTYPE_QUATERNION,f.rotationQuaternion=new i.Quaternion):T=u.Animation.ANIMATIONTYPE_VECTOR3);let A=null,x=[],v=0,M=!1;y&&s&&s.getKeys().length===h.length&&(A=s,M=!0),M||(e.scene._blockEntityCollection=!!e.assetContainer,A=new u.Animation(t,y?"_matrix":b,1,T,u.Animation.ANIMATIONLOOPMODE_CYCLE),e.scene._blockEntityCollection=!1);for(let e=0;e<h.length;e++){let t=null;if("rotationQuaternion"===b?(t=(0,i.Quaternion).FromArray([p[v],p[v+1],p[v+2],p[v+3]]),v+=4):(t=(0,i.Vector3).FromArray([p[v],p[v+1],p[v+2]]),v+=3),y){let r=f,n=(0,i.Vector3).Zero(),a=new i.Quaternion,o=(0,i.Vector3).Zero(),l=r.getBaseMatrix();M&&s&&(l=s.getKeys()[e].value),l.decompose(o,a,n),"position"===b?n=t:"rotationQuaternion"===b?a=t:o=t,t=(0,i.Matrix).Compose(o,a,n)}M?s&&(s.getKeys()[e].value=t):x.push({frame:h[e],value:t})}!M&&A&&(A.setKeys(x),f.animations.push(A)),s=A,e.scene.stopAnimation(f),e.scene.beginAnimation(f,0,h[h.length-1],!0,1)}}},W=e=>{let t=null;if(e.translation||e.rotation||e.scale){let r=(0,i.Vector3).FromArray(e.scale||[1,1,1]),s=(0,i.Quaternion).FromArray(e.rotation||[0,0,0,1]),n=(0,i.Vector3).FromArray(e.translation||[0,0,0]);t=(0,i.Matrix).Compose(r,s,n)}else t=(0,i.Matrix).FromArray(e.matrix);return t},K=(e,t,r,s)=>{for(let e=0;e<s.bones.length;e++)if(s.bones[e].name===r)return s.bones[e];let n=e.nodes;for(let a in n){let o=n[a];if(!o.jointName)continue;let i=o.children;for(let n=0;n<i.length;n++){let l=e.nodes[i[n]];if(l.jointName&&l.jointName===r){let r=W(o),n=new _.Bone(o.name||"",s,K(e,t,o.jointName,s),r);return n.id=a,n}}}return null},X=(e,t)=>{for(let r=0;r<e.length;r++){let s=e[r];for(let e=0;e<s.node.children.length;e++)if(s.node.children[e]===t)return s.bone}return null},q=(e,t)=>{let r=e.nodes,s=r[t];if(s)return{node:s,id:t};for(let e in r)if((s=r[e]).jointName===t)return{node:s,id:e};return null},Y=(e,t)=>{for(let r=0;r<e.jointNames.length;r++)if(e.jointNames[r]===t)return!0;return!1},Q=(e,t,r,s)=>{for(let n in e.nodes){let a=e.nodes[n];if(!a.jointName||Y(r,a.jointName))continue;let o=W(a),i=new _.Bone(a.name||"",t,null,o);i.id=n,s.push({bone:i,node:a,id:n})}for(let e=0;e<s.length;e++){let t=s[e],r=t.node.children;for(let e=0;e<r.length;e++){let n=null;for(let t=0;t<s.length;t++)if(s[t].id===r[e]){n=s[t];break}n&&(n.bone._parent=t.bone,t.bone.children.push(n.bone))}}},z=(e,t,r,s)=>{if(s||(s=new p.Skeleton(t.name||"","",e.scene)),!t.babylonSkeleton)return s;let n=[],a=[];Q(e,s,t,n),s.bones=[];for(let r=0;r<t.jointNames.length;r++){let o=q(e,t.jointNames[r]);if(!o)continue;let i=o.node;if(!i){(0,c.Tools).Warn("Joint named "+t.jointNames[r]+" does not exist");continue}let l=o.id,d=e.scene.getBoneById(l);if(d){s.bones.push(d);continue}let h=!1,u=null;for(let n=0;n<r;n++){let r=q(e,t.jointNames[n]);if(!r)continue;let a=r.node;if(!a){(0,c.Tools).Warn("Joint named "+t.jointNames[n]+" does not exist when looking for parent");continue}let o=a.children;if(o){h=!1;for(let r=0;r<o.length;r++)if(o[r]===l){u=K(e,t,t.jointNames[n],s),h=!0;break}if(h)break}}let p=W(i);!u&&n.length>0&&(u=X(n,l))&&-1===a.indexOf(u)&&a.push(u),new _.Bone(i.jointName||"",s,u,p).id=l}let o=s.bones;s.bones=[];for(let r=0;r<t.jointNames.length;r++){let n=q(e,t.jointNames[r]);if(n){for(let e=0;e<o.length;e++)if(o[e].id===n.id){s.bones.push(o[e]);break}}}s.prepare();for(let e=0;e<a.length;e++)s.bones.push(a[e]);return s},J=(e,t,r,s,n)=>{let a;if(n||(e.scene._blockEntityCollection=!!e.assetContainer,(n=new E.Mesh(t.name||"",e.scene))._parentContainer=e.assetContainer,e.scene._blockEntityCollection=!1,n.id=s),!t.babylonNode)return n;let o=[],i=null,l=[],c=[],d=[],h=[];for(let t=0;t<r.length;t++){let s=r[t],n=e.meshes[s];if(n)for(let t=0;t<n.primitives.length;t++){let r=new A.VertexData,s=n.primitives[t];s.mode;let a=s.attributes,u=null,_=null;for(let t in a)if(u=e.accessors[a[t]],_=(0,S.GLTFUtils).GetBufferFromAccessor(e,u),"NORMAL"===t)r.normals=new Float32Array(_.length),r.normals.set(_);else if("POSITION"===t){if(w.GLTFFileLoader.HomogeneousCoordinates){r.positions=new Float32Array(_.length-_.length/4);for(let e=0;e<_.length;e+=4)r.positions[e]=_[e],r.positions[e+1]=_[e+1],r.positions[e+2]=_[e+2]}else r.positions=new Float32Array(_.length),r.positions.set(_);c.push(r.positions.length)}else if(-1!==t.indexOf("TEXCOORD_")){let e=Number(t.split("_")[1]),s=x.VertexBuffer.UVKind+(0===e?"":e+1),n=new Float32Array(_.length);n.set(_),V(n),r.set(n,s)}else"JOINT"===t?(r.matricesIndices=new Float32Array(_.length),r.matricesIndices.set(_)):"WEIGHT"===t?(r.matricesWeights=new Float32Array(_.length),r.matricesWeights.set(_)):"COLOR"===t&&(r.colors=new Float32Array(_.length),r.colors.set(_));if(u=e.accessors[s.indices])_=(0,S.GLTFUtils).GetBufferFromAccessor(e,u),r.indices=new Int32Array(_.length),r.indices.set(_),h.push(r.indices.length);else{let e=[];for(let t=0;t<r.positions.length/3;t++)e.push(t);r.indices=new Int32Array(e),h.push(r.indices.length)}i?i.merge(r):i=r;let p=e.scene.getMaterialById(s.material);o.push(null===p?(0,S.GLTFUtils).GetDefaultMaterial(e.scene):p),l.push(0===l.length?0:l[l.length-1]+c[c.length-2]),d.push(0===d.length?0:d[d.length-1]+h[h.length-2])}}e.scene._blockEntityCollection=!!e.assetContainer,o.length>1?(a=new y.MultiMaterial("multimat"+s,e.scene)).subMaterials=o:a=new b.StandardMaterial("multimat"+s,e.scene),1===o.length&&(a=o[0]),a._parentContainer=e.assetContainer,n.material||(n.material=a),new v.Geometry(s,e.scene,i,!1,n),n.computeWorldMatrix(!0),e.scene._blockEntityCollection=!1,n.subMeshes=[];let u=0;for(let t=0;t<r.length;t++){let s=r[t],a=e.meshes[s];if(a)for(let e=0;e<a.primitives.length;e++)a.primitives[e].mode,(0,M.SubMesh).AddToMesh(u,l[u],c[u],d[u],h[u],n,n,!0),u++}return n},Z=(e,t,r,s)=>{e.position&&(e.position=t),(e.rotationQuaternion||e.rotation)&&(e.rotationQuaternion=r),e.scaling&&(e.scaling=s)},ee=(e,t)=>{if(t.matrix){let r=new i.Vector3(0,0,0),s=new i.Quaternion,n=new i.Vector3(0,0,0);(0,i.Matrix).FromArray(t.matrix).decompose(n,s,r),Z(e,r,s,n)}else t.translation&&t.rotation&&t.scale&&Z(e,(0,i.Vector3).FromArray(t.translation),(0,i.Quaternion).FromArray(t.rotation),(0,i.Vector3).FromArray(t.scale));e.computeWorldMatrix(!0)},et=(e,t,r)=>{let s=null;if(e.importOnlyMeshes&&(t.skin||t.meshes)&&e.importMeshesNames&&e.importMeshesNames.length>0&&-1===e.importMeshesNames.indexOf(t.name||""))return null;if(t.skin){if(t.meshes){let n=e.skins[t.skin],a=J(e,t,t.meshes,r,t.babylonNode);a.skeleton=e.scene.getLastSkeletonById(t.skin),null!==a.skeleton||(a.skeleton=z(e,n,a,n.babylonSkeleton),n.babylonSkeleton||(n.babylonSkeleton=a.skeleton)),s=a}}else if(t.meshes)s=J(e,t,t.mesh?[t.mesh]:t.meshes,r,t.babylonNode);else if(!t.light||t.babylonNode||e.importOnlyMeshes){if(t.camera&&!t.babylonNode&&!e.importOnlyMeshes){let r=e.cameras[t.camera];if(r){if(e.scene._blockEntityCollection=!!e.assetContainer,"orthographic"===r.type){let r=new h.FreeCamera(t.camera,(0,i.Vector3).Zero(),e.scene,!1);r.name=t.name||"",r.mode=d.Camera.ORTHOGRAPHIC_CAMERA,r.attachControl(),s=r,r._parentContainer=e.assetContainer}else if("perspective"===r.type){let n=r[r.type],a=new h.FreeCamera(t.camera,(0,i.Vector3).Zero(),e.scene,!1);a.name=t.name||"",a.attachControl(),n.aspectRatio||(n.aspectRatio=e.scene.getEngine().getRenderWidth()/e.scene.getEngine().getRenderHeight()),n.znear&&n.zfar&&(a.maxZ=n.zfar,a.minZ=n.znear),s=a,a._parentContainer=e.assetContainer}e.scene._blockEntityCollection=!1}}}else{let r=e.lights[t.light];if(r){if("ambient"===r.type){let n=r[r.type],a=new L.HemisphericLight(t.light,(0,i.Vector3).Zero(),e.scene);a.name=t.name||"",n.color&&(a.diffuse=(0,l.Color3).FromArray(n.color)),s=a}else if("directional"===r.type){let n=r[r.type],a=new C.DirectionalLight(t.light,(0,i.Vector3).Zero(),e.scene);a.name=t.name||"",n.color&&(a.diffuse=(0,l.Color3).FromArray(n.color)),s=a}else if("point"===r.type){let n=r[r.type],a=new P.PointLight(t.light,(0,i.Vector3).Zero(),e.scene);a.name=t.name||"",n.color&&(a.diffuse=(0,l.Color3).FromArray(n.color)),s=a}else if("spot"===r.type){let n=r[r.type],a=new F.SpotLight(t.light,(0,i.Vector3).Zero(),(0,i.Vector3).Zero(),0,0,e.scene);a.name=t.name||"",n.color&&(a.diffuse=(0,l.Color3).FromArray(n.color)),n.fallOfAngle&&(a.angle=n.fallOfAngle),n.fallOffExponent&&(a.exponent=n.fallOffExponent),s=a}}}if(!t.jointName){if(t.babylonNode)return t.babylonNode;if(null===s){e.scene._blockEntityCollection=!!e.assetContainer;let r=new E.Mesh(t.name||"",e.scene);r._parentContainer=e.assetContainer,e.scene._blockEntityCollection=!1,t.babylonNode=r,s=r}}if(null!==s){if(t.matrix&&s instanceof E.Mesh)ee(s,t);else{let e=t.translation||[0,0,0],r=t.rotation||[0,0,0,1],n=t.scale||[1,1,1];Z(s,(0,i.Vector3).FromArray(e),(0,i.Quaternion).FromArray(r),(0,i.Vector3).FromArray(n))}s.updateCache(!0),t.babylonNode=s}return s},er=(e,t,r,s=!1)=>{let n=e.nodes[t],a=null;if(s=!e.importOnlyMeshes||!!s||!e.importMeshesNames||-1!==e.importMeshesNames.indexOf(n.name||"")||0===e.importMeshesNames.length,!n.jointName&&s&&null!==(a=et(e,n,t))&&(a.id=t,a.parent=r),n.children)for(let t=0;t<n.children.length;t++)er(e,n.children[t],a,s)},es=e=>{let t=e.currentScene;if(t)for(let r=0;r<t.nodes.length;r++)er(e,t.nodes[r],null);else for(let r in e.scenes){t=e.scenes[r];for(let r=0;r<t.nodes.length;r++)er(e,t.nodes[r],null)}U(e);for(let t=0;t<e.scene.skeletons.length;t++){let r=e.scene.skeletons[t];e.scene.beginAnimation(r,0,Number.MAX_VALUE,!0,1)}},en=(e,t,r,s,n,a,i)=>{let l=a.values||n.parameters;for(let i in r){let c=r[i],d=c.type;if(d===o.EParameterType.FLOAT_MAT2||d===o.EParameterType.FLOAT_MAT3||d===o.EParameterType.FLOAT_MAT4){if(!c.semantic||c.source||c.node){if(c.semantic&&(c.source||c.node)){let e=t.scene.getNodeByName(c.source||c.node||"");if(null===e&&(e=t.scene.getNodeById(c.source||c.node||"")),null===e)continue;(0,S.GLTFUtils).SetMatrix(t.scene,e,c,i,s.getEffect())}}else(0,S.GLTFUtils).SetMatrix(t.scene,e,c,i,s.getEffect())}else{let e=l[n.uniforms[i]];if(!e)continue;if(d===o.EParameterType.SAMPLER_2D){let r=t.textures[a.values?e:c.value].babylonTexture;if(null==r)continue;s.getEffect().setTexture(i,r)}else(0,S.GLTFUtils).SetUniform(s.getEffect(),i,e,d)}}i(s)},ea=(e,t,r,s,n)=>{let a=s.values||r.parameters,i=r.uniforms;for(let r in n){let l=n[r],c=l.type,d=a[i[r]];if(void 0===d&&(d=l.value),!d)continue;let h=e=>r=>{l.value&&e&&(t.setTexture(e,r),delete n[e])};c===o.EParameterType.SAMPLER_2D?eu.LoadTextureAsync(e,s.values?d:l.value,h(r),()=>h(null)):l.value&&(0,S.GLTFUtils).SetUniform(t,r,s.values?d:l.value,c)&&delete n[r]}},eo=(e,t,r)=>(s,n)=>{t.dispose(!0),r("Cannot compile program named "+e.name+". Error: "+n+". Default material will be applied")},ei=(e,t,r,s,n,a)=>o=>{ea(e,t,r,s,n),t.onBind=o=>{en(o,e,n,t,r,s,a)}},el=(e,t,r)=>{for(let s in t.uniforms){let n=t.uniforms[s],a=t.parameters[n];if(e.currentIdentifier===s&&a.semantic&&!a.source&&!a.node){let e=B.indexOf(a.semantic);if(-1!==e)return delete r[s],I[e]}}return e.currentIdentifier},ec=e=>{for(let t in e.materials)eu.LoadMaterialAsync(e,t,()=>{},()=>{})};class ed{static CreateRuntime(e,t,r){let s={extensions:{},accessors:{},buffers:{},bufferViews:{},meshes:{},lights:{},cameras:{},nodes:{},images:{},textures:{},shaders:{},programs:{},samplers:{},techniques:{},materials:{},animations:{},skins:{},extensionsUsed:[],scenes:{},buffersCount:0,shaderscount:0,scene:t,rootUrl:r,loadedBufferCount:0,loadedBufferViews:{},loadedShaderCount:0,importOnlyMeshes:!1,dummyNodes:[],assetContainer:null};return e.extensions&&D(e.extensions,"extensions",s),e.extensionsUsed&&D(e.extensionsUsed,"extensionsUsed",s),e.buffers&&H(e.buffers,s),e.bufferViews&&D(e.bufferViews,"bufferViews",s),e.accessors&&D(e.accessors,"accessors",s),e.meshes&&D(e.meshes,"meshes",s),e.lights&&D(e.lights,"lights",s),e.cameras&&D(e.cameras,"cameras",s),e.nodes&&D(e.nodes,"nodes",s),e.images&&D(e.images,"images",s),e.textures&&D(e.textures,"textures",s),e.shaders&&k(e.shaders,s),e.programs&&D(e.programs,"programs",s),e.samplers&&D(e.samplers,"samplers",s),e.techniques&&D(e.techniques,"techniques",s),e.materials&&D(e.materials,"materials",s),e.animations&&D(e.animations,"animations",s),e.skins&&D(e.skins,"skins",s),e.scenes&&(s.scenes=e.scenes),e.scene&&e.scenes&&(s.currentScene=e.scenes[e.scene]),s}static LoadBufferAsync(e,t,r,s,n){let a=e.buffers[t];(0,c.Tools).IsBase64(a.uri)?setTimeout(()=>r(new Uint8Array((0,c.Tools).DecodeBase64(a.uri)))):(0,c.Tools).LoadFile(e.rootUrl+a.uri,e=>r(new Uint8Array(e)),n,void 0,!0,e=>{e&&s(e.status+" "+e.statusText)})}static LoadTextureBufferAsync(e,t,r,s){let n=e.textures[t];if(!n||!n.source){s("");return}if(n.babylonTexture){r(null);return}let a=e.images[n.source];(0,c.Tools).IsBase64(a.uri)?setTimeout(()=>r(new Uint8Array((0,c.Tools).DecodeBase64(a.uri)))):(0,c.Tools).LoadFile(e.rootUrl+a.uri,e=>r(new Uint8Array(e)),void 0,void 0,!0,e=>{e&&s(e.status+" "+e.statusText)})}static CreateTextureAsync(e,t,r,s){let n=e.textures[t];if(n.babylonTexture){s(n.babylonTexture);return}let a=e.samplers[n.sampler],i=a.minFilter===o.ETextureFilterType.NEAREST_MIPMAP_NEAREST||a.minFilter===o.ETextureFilterType.NEAREST_MIPMAP_LINEAR||a.minFilter===o.ETextureFilterType.LINEAR_MIPMAP_NEAREST||a.minFilter===o.ETextureFilterType.LINEAR_MIPMAP_LINEAR,l=T.Texture.BILINEAR_SAMPLINGMODE,c=null==r?new Blob:new Blob([r]),d=URL.createObjectURL(c),h=()=>URL.revokeObjectURL(d),u=new T.Texture(d,e.scene,!i,!0,l,h,h);void 0!==a.wrapS&&(u.wrapU=(0,S.GLTFUtils).GetWrapMode(a.wrapS)),void 0!==a.wrapT&&(u.wrapV=(0,S.GLTFUtils).GetWrapMode(a.wrapT)),u.name=t,n.babylonTexture=u,s(u)}static LoadShaderStringAsync(e,t,r,s){let n=e.shaders[t];if((0,c.Tools).IsBase64(n.uri)){let e=atob(n.uri.split(",")[1]);r&&r(e)}else(0,c.Tools).LoadFile(e.rootUrl+n.uri,r,void 0,void 0,!1,e=>{e&&s&&s(e.status+" "+e.statusText)})}static LoadMaterialAsync(e,t,r,s){let a=e.materials[t];if(!a.technique){s&&s("No technique found.");return}let i=e.techniques[a.technique];if(!i){e.scene._blockEntityCollection=!!e.assetContainer;let s=new b.StandardMaterial(t,e.scene);s._parentContainer=e.assetContainer,e.scene._blockEntityCollection=!1,s.diffuseColor=new l.Color3(.5,.5,.5),s.sideOrientation=f.Material.CounterClockWiseSideOrientation,r(s);return}let c=e.programs[i.program],d=i.states,h=m.Effect.ShadersStore[c.vertexShader+"VertexShader"],u=m.Effect.ShadersStore[c.fragmentShader+"PixelShader"],_="",p="",y=new R(h),T=new R(u),A={},x=[],v=[],M=[];for(let e in i.uniforms){let t=i.uniforms[e],r=i.parameters[t];if(A[e]=r,!r.semantic||r.node||r.source)r.type===o.EParameterType.SAMPLER_2D?M.push(e):x.push(e);else{let t=B.indexOf(r.semantic);-1!==t?(x.push(I[t]),delete A[e]):x.push(e)}}for(let e in i.attributes){let t=i.attributes[e],r=i.parameters[t];if(r.semantic){let e=$(r);e&&v.push(e)}}for(;!y.isEnd()&&y.getNextToken();){if(y.currentToken!==n.IDENTIFIER){_+=y.currentString;continue}let e=!1;for(let t in i.attributes){let r=i.attributes[t],s=i.parameters[r];if(y.currentIdentifier===t&&s.semantic){_+=$(s),e=!0;break}}e||(_+=el(y,i,A))}for(;!T.isEnd()&&T.getNextToken();){if(T.currentToken!==n.IDENTIFIER){p+=T.currentString;continue}p+=el(T,i,A)}let j={vertex:c.vertexShader+t,fragment:c.fragmentShader+t},E={attributes:v,uniforms:x,samplers:M,needAlphaBlending:d&&d.enable&&-1!==d.enable.indexOf(3042)};m.Effect.ShadersStore[c.vertexShader+t+"VertexShader"]=_,m.Effect.ShadersStore[c.fragmentShader+t+"PixelShader"]=p;let L=new g.ShaderMaterial(t,e.scene,j,E);if(L.onError=eo(c,L,s),L.onCompiled=ei(e,L,i,a,A,r),L.sideOrientation=f.Material.CounterClockWiseSideOrientation,d&&d.functions){let e=d.functions;e.cullFace&&e.cullFace[0]!==o.ECullingType.BACK&&(L.backFaceCulling=!1);let t=e.blendFuncSeparate;t&&(t[0]===o.EBlendingFunction.SRC_ALPHA&&t[1]===o.EBlendingFunction.ONE_MINUS_SRC_ALPHA&&t[2]===o.EBlendingFunction.ONE&&t[3]===o.EBlendingFunction.ONE?L.alphaMode=O.Constants.ALPHA_COMBINE:t[0]===o.EBlendingFunction.ONE&&t[1]===o.EBlendingFunction.ONE&&t[2]===o.EBlendingFunction.ZERO&&t[3]===o.EBlendingFunction.ONE?L.alphaMode=O.Constants.ALPHA_ONEONE:t[0]===o.EBlendingFunction.SRC_ALPHA&&t[1]===o.EBlendingFunction.ONE&&t[2]===o.EBlendingFunction.ZERO&&t[3]===o.EBlendingFunction.ONE?L.alphaMode=O.Constants.ALPHA_ADD:t[0]===o.EBlendingFunction.ZERO&&t[1]===o.EBlendingFunction.ONE_MINUS_SRC_COLOR&&t[2]===o.EBlendingFunction.ONE&&t[3]===o.EBlendingFunction.ONE?L.alphaMode=O.Constants.ALPHA_SUBTRACT:t[0]===o.EBlendingFunction.DST_COLOR&&t[1]===o.EBlendingFunction.ZERO&&t[2]===o.EBlendingFunction.ONE&&t[3]===o.EBlendingFunction.ONE?L.alphaMode=O.Constants.ALPHA_MULTIPLY:t[0]===o.EBlendingFunction.SRC_ALPHA&&t[1]===o.EBlendingFunction.ONE_MINUS_SRC_COLOR&&t[2]===o.EBlendingFunction.ONE&&t[3]===o.EBlendingFunction.ONE&&(L.alphaMode=O.Constants.ALPHA_MAXIMIZED))}}}class eh{static RegisterExtension(e){if(eh.Extensions[e.name]){(0,c.Tools).Error('Tool with the same name "'+e.name+'" already exists');return}eh.Extensions[e.name]=e}dispose(){}_importMeshAsync(e,t,r,s,n,a,o,i){return t.useRightHandedSystem=!0,eu.LoadRuntimeAsync(t,r,s,t=>{t.assetContainer=n,t.importOnlyMeshes=!0,""===e?t.importMeshesNames=[]:"string"==typeof e?t.importMeshesNames=[e]:!e||e instanceof Array?(t.importMeshesNames=[],(0,c.Tools).Warn("Argument meshesNames must be of type string or string[]")):t.importMeshesNames=[e],this._createNodes(t);let r=[],s=[];for(let e in t.nodes){let s=t.nodes[e];s.babylonNode instanceof j.AbstractMesh&&r.push(s.babylonNode)}for(let e in t.skins){let r=t.skins[e];r.babylonSkeleton instanceof p.Skeleton&&s.push(r.babylonSkeleton)}this._loadBuffersAsync(t,()=>{this._loadShadersAsync(t,()=>{ec(t),es(t),!w.GLTFFileLoader.IncrementalLoading&&a&&a(r,s)})}),w.GLTFFileLoader.IncrementalLoading&&a&&a(r,s)},i),!0}importMeshAsync(e,t,r,s,n,a){return new Promise((o,i)=>{this._importMeshAsync(e,t,s,n,r,(e,t)=>{o({meshes:e,particleSystems:[],skeletons:t,animationGroups:[],lights:[],transformNodes:[],geometries:[]})},a,e=>{i(Error(e))})})}_loadAsync(e,t,r,s,n,a){e.useRightHandedSystem=!0,eu.LoadRuntimeAsync(e,t,r,e=>{eu.LoadRuntimeExtensionsAsync(e,()=>{this._createNodes(e),this._loadBuffersAsync(e,()=>{this._loadShadersAsync(e,()=>{ec(e),es(e),w.GLTFFileLoader.IncrementalLoading||s()})}),w.GLTFFileLoader.IncrementalLoading&&s()},a)},a)}loadAsync(e,t,r,s){return new Promise((n,a)=>{this._loadAsync(e,t,r,()=>{n()},s,e=>{a(Error(e))})})}_loadShadersAsync(e,t){let r=!1,s=(r,s)=>{eu.LoadShaderStringAsync(e,r,n=>{n instanceof ArrayBuffer||(e.loadedShaderCount++,n&&(m.Effect.ShadersStore[r+(s.type===o.EShaderType.VERTEX?"VertexShader":"PixelShader")]=n),e.loadedShaderCount===e.shaderscount&&t())},()=>{(0,c.Tools).Error("Error when loading shader program named "+r+" located at "+s.uri)})};for(let t in e.shaders){r=!0;let n=e.shaders[t];n?s.bind(this,t,n)():(0,c.Tools).Error("No shader named: "+t)}r||t()}_loadBuffersAsync(e,t){let r=!1,s=(r,s)=>{eu.LoadBufferAsync(e,r,n=>{e.loadedBufferCount++,n&&(n.byteLength!=e.buffers[r].byteLength&&(0,c.Tools).Error("Buffer named "+r+" is length "+n.byteLength+". Expected: "+s.byteLength),e.loadedBufferViews[r]=n),e.loadedBufferCount===e.buffersCount&&t()},()=>{(0,c.Tools).Error("Error when loading buffer named "+r+" located at "+s.uri)})};for(let t in e.buffers){r=!0;let n=e.buffers[t];n?s.bind(this,t,n)():(0,c.Tools).Error("No buffer named: "+t)}r||t()}_createNodes(e){let t=e.currentScene;if(t)for(let r=0;r<t.nodes.length;r++)er(e,t.nodes[r],null);else for(let r in e.scenes){t=e.scenes[r];for(let r=0;r<t.nodes.length;r++)er(e,t.nodes[r],null)}}}eh.Extensions={};class eu{constructor(e){this._name=e}get name(){return this._name}loadRuntimeAsync(e,t,r,s,n){return!1}loadRuntimeExtensionsAsync(e,t,r){return!1}loadBufferAsync(e,t,r,s,n){return!1}loadTextureBufferAsync(e,t,r,s){return!1}createTextureAsync(e,t,r,s,n){return!1}loadShaderStringAsync(e,t,r,s){return!1}loadMaterialAsync(e,t,r,s){return!1}static LoadRuntimeAsync(e,t,r,s,n){eu._ApplyExtensions(a=>a.loadRuntimeAsync(e,t,r,s,n),()=>{setTimeout(()=>{s&&s(ed.CreateRuntime(t.json,e,r))})})}static LoadRuntimeExtensionsAsync(e,t,r){eu._ApplyExtensions(s=>s.loadRuntimeExtensionsAsync(e,t,r),()=>{setTimeout(()=>{t()})})}static LoadBufferAsync(e,t,r,s,n){eu._ApplyExtensions(a=>a.loadBufferAsync(e,t,r,s,n),()=>{ed.LoadBufferAsync(e,t,r,s,n)})}static LoadTextureAsync(e,t,r,s){eu._LoadTextureBufferAsync(e,t,n=>{n&&eu._CreateTextureAsync(e,t,n,r,s)},s)}static LoadShaderStringAsync(e,t,r,s){eu._ApplyExtensions(n=>n.loadShaderStringAsync(e,t,r,s),()=>{ed.LoadShaderStringAsync(e,t,r,s)})}static LoadMaterialAsync(e,t,r,s){eu._ApplyExtensions(n=>n.loadMaterialAsync(e,t,r,s),()=>{ed.LoadMaterialAsync(e,t,r,s)})}static _LoadTextureBufferAsync(e,t,r,s){eu._ApplyExtensions(n=>n.loadTextureBufferAsync(e,t,r,s),()=>{ed.LoadTextureBufferAsync(e,t,r,s)})}static _CreateTextureAsync(e,t,r,s,n){eu._ApplyExtensions(a=>a.createTextureAsync(e,t,r,s,n),()=>{ed.CreateTextureAsync(e,t,r,s)})}static _ApplyExtensions(e,t){for(let t in eh.Extensions)if(e(eh.Extensions[t]))return;t()}}w.GLTFFileLoader._CreateGLTF1Loader=()=>new eh},{"./glTFLoaderInterfaces.js":"eWSDw","@babylonjs/core/Maths/math.vector.js":"h33gd","@babylonjs/core/Maths/math.color.js":"78my4","@babylonjs/core/Misc/tools.js":"ieufJ","@babylonjs/core/Cameras/camera.js":"467SK","@babylonjs/core/Cameras/freeCamera.js":"5Dwi7","@babylonjs/core/Animations/animation.js":"aeJ0l","@babylonjs/core/Bones/bone.js":"4de78","@babylonjs/core/Bones/skeleton.js":"gq1Mh","@babylonjs/core/Materials/effect.js":"7Vmut","@babylonjs/core/Materials/material.js":"b0eUV","@babylonjs/core/Materials/multiMaterial.js":"iPjNC","@babylonjs/core/Materials/standardMaterial.js":"9hjVc","@babylonjs/core/Materials/shaderMaterial.js":"lH6q5","@babylonjs/core/Materials/Textures/texture.js":"bYxw8","@babylonjs/core/Meshes/mesh.vertexData.js":"apU8X","@babylonjs/core/Buffers/buffer.js":"aDZlT","@babylonjs/core/Meshes/geometry.js":"lnjEm","@babylonjs/core/Meshes/subMesh.js":"dyyBT","@babylonjs/core/Meshes/abstractMesh.js":"jf0Op","@babylonjs/core/Meshes/mesh.js":"9vBao","@babylonjs/core/Lights/hemisphericLight.js":"3ER0R","@babylonjs/core/Lights/directionalLight.js":"ed05w","@babylonjs/core/Lights/pointLight.js":"iBNs0","@babylonjs/core/Lights/spotLight.js":"kOHa2","./glTFLoaderUtils.js":"hTCOH","../glTFFileLoader.js":"GX9kb","@babylonjs/core/Engines/constants.js":"es9Cn","@parcel/transformer-js/src/esmodule-helpers.js":"XTfsy"}],eWSDw:[function(e,t,r){var s,n,a,o,i,l,c,d,h,u,_,p,m,f,y,b,g=e("@parcel/transformer-js/src/esmodule-helpers.js");g.defineInteropFlag(r),g.export(r,"EComponentType",()=>h),g.export(r,"EShaderType",()=>u),g.export(r,"EParameterType",()=>_),g.export(r,"ETextureWrapMode",()=>p),g.export(r,"ETextureFilterType",()=>m),g.export(r,"ETextureFormat",()=>f),g.export(r,"ECullingType",()=>y),g.export(r,"EBlendingFunction",()=>b),(s=h||(h={}))[s.BYTE=5120]="BYTE",s[s.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",s[s.SHORT=5122]="SHORT",s[s.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",s[s.FLOAT=5126]="FLOAT",(n=u||(u={}))[n.FRAGMENT=35632]="FRAGMENT",n[n.VERTEX=35633]="VERTEX",(a=_||(_={}))[a.BYTE=5120]="BYTE",a[a.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",a[a.SHORT=5122]="SHORT",a[a.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",a[a.INT=5124]="INT",a[a.UNSIGNED_INT=5125]="UNSIGNED_INT",a[a.FLOAT=5126]="FLOAT",a[a.FLOAT_VEC2=35664]="FLOAT_VEC2",a[a.FLOAT_VEC3=35665]="FLOAT_VEC3",a[a.FLOAT_VEC4=35666]="FLOAT_VEC4",a[a.INT_VEC2=35667]="INT_VEC2",a[a.INT_VEC3=35668]="INT_VEC3",a[a.INT_VEC4=35669]="INT_VEC4",a[a.BOOL=35670]="BOOL",a[a.BOOL_VEC2=35671]="BOOL_VEC2",a[a.BOOL_VEC3=35672]="BOOL_VEC3",a[a.BOOL_VEC4=35673]="BOOL_VEC4",a[a.FLOAT_MAT2=35674]="FLOAT_MAT2",a[a.FLOAT_MAT3=35675]="FLOAT_MAT3",a[a.FLOAT_MAT4=35676]="FLOAT_MAT4",a[a.SAMPLER_2D=35678]="SAMPLER_2D",(o=p||(p={}))[o.CLAMP_TO_EDGE=33071]="CLAMP_TO_EDGE",o[o.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",o[o.REPEAT=10497]="REPEAT",(i=m||(m={}))[i.NEAREST=9728]="NEAREST",i[i.LINEAR=9728]="LINEAR",i[i.NEAREST_MIPMAP_NEAREST=9984]="NEAREST_MIPMAP_NEAREST",i[i.LINEAR_MIPMAP_NEAREST=9985]="LINEAR_MIPMAP_NEAREST",i[i.NEAREST_MIPMAP_LINEAR=9986]="NEAREST_MIPMAP_LINEAR",i[i.LINEAR_MIPMAP_LINEAR=9987]="LINEAR_MIPMAP_LINEAR",(l=f||(f={}))[l.ALPHA=6406]="ALPHA",l[l.RGB=6407]="RGB",l[l.RGBA=6408]="RGBA",l[l.LUMINANCE=6409]="LUMINANCE",l[l.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",(c=y||(y={}))[c.FRONT=1028]="FRONT",c[c.BACK=1029]="BACK",c[c.FRONT_AND_BACK=1032]="FRONT_AND_BACK",(d=b||(b={}))[d.ZERO=0]="ZERO",d[d.ONE=1]="ONE",d[d.SRC_COLOR=768]="SRC_COLOR",d[d.ONE_MINUS_SRC_COLOR=769]="ONE_MINUS_SRC_COLOR",d[d.DST_COLOR=774]="DST_COLOR",d[d.ONE_MINUS_DST_COLOR=775]="ONE_MINUS_DST_COLOR",d[d.SRC_ALPHA=770]="SRC_ALPHA",d[d.ONE_MINUS_SRC_ALPHA=771]="ONE_MINUS_SRC_ALPHA",d[d.DST_ALPHA=772]="DST_ALPHA",d[d.ONE_MINUS_DST_ALPHA=773]="ONE_MINUS_DST_ALPHA",d[d.CONSTANT_COLOR=32769]="CONSTANT_COLOR",d[d.ONE_MINUS_CONSTANT_COLOR=32770]="ONE_MINUS_CONSTANT_COLOR",d[d.CONSTANT_ALPHA=32771]="CONSTANT_ALPHA",d[d.ONE_MINUS_CONSTANT_ALPHA=32772]="ONE_MINUS_CONSTANT_ALPHA",d[d.SRC_ALPHA_SATURATE=776]="SRC_ALPHA_SATURATE"},{"@parcel/transformer-js/src/esmodule-helpers.js":"XTfsy"}],hTCOH:[function(e,t,r){var s=e("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(r),s.export(r,"GLTFUtils",()=>d);var n=e("./glTFLoaderInterfaces.js"),a=e("@babylonjs/core/Maths/math.vector.js"),o=e("@babylonjs/core/Maths/math.color.js"),i=e("@babylonjs/core/Materials/effect.js"),l=e("@babylonjs/core/Materials/shaderMaterial.js"),c=e("@babylonjs/core/Materials/Textures/texture.js");class d{static SetMatrix(e,t,r,s,o){let i=null;if("MODEL"===r.semantic?i=t.getWorldMatrix():"PROJECTION"===r.semantic?i=e.getProjectionMatrix():"VIEW"===r.semantic?i=e.getViewMatrix():"MODELVIEWINVERSETRANSPOSE"===r.semantic?i=(0,a.Matrix).Transpose(t.getWorldMatrix().multiply(e.getViewMatrix()).invert()):"MODELVIEW"===r.semantic?i=t.getWorldMatrix().multiply(e.getViewMatrix()):"MODELVIEWPROJECTION"===r.semantic?i=t.getWorldMatrix().multiply(e.getTransformMatrix()):"MODELINVERSE"===r.semantic?i=t.getWorldMatrix().invert():"VIEWINVERSE"===r.semantic?i=e.getViewMatrix().invert():"PROJECTIONINVERSE"===r.semantic?i=e.getProjectionMatrix().invert():"MODELVIEWINVERSE"===r.semantic?i=t.getWorldMatrix().multiply(e.getViewMatrix()).invert():"MODELVIEWPROJECTIONINVERSE"===r.semantic?i=t.getWorldMatrix().multiply(e.getTransformMatrix()).invert():"MODELINVERSETRANSPOSE"===r.semantic&&(i=(0,a.Matrix).Transpose(t.getWorldMatrix().invert())),i)switch(r.type){case n.EParameterType.FLOAT_MAT2:o.setMatrix2x2(s,(0,a.Matrix).GetAsMatrix2x2(i));break;case n.EParameterType.FLOAT_MAT3:o.setMatrix3x3(s,(0,a.Matrix).GetAsMatrix3x3(i));break;case n.EParameterType.FLOAT_MAT4:o.setMatrix(s,i)}}static SetUniform(e,t,r,s){switch(s){case n.EParameterType.FLOAT:return e.setFloat(t,r),!0;case n.EParameterType.FLOAT_VEC2:return e.setVector2(t,(0,a.Vector2).FromArray(r)),!0;case n.EParameterType.FLOAT_VEC3:return e.setVector3(t,(0,a.Vector3).FromArray(r)),!0;case n.EParameterType.FLOAT_VEC4:return e.setVector4(t,(0,a.Vector4).FromArray(r)),!0;default:return!1}}static GetWrapMode(e){switch(e){case n.ETextureWrapMode.CLAMP_TO_EDGE:return c.Texture.CLAMP_ADDRESSMODE;case n.ETextureWrapMode.MIRRORED_REPEAT:return c.Texture.MIRROR_ADDRESSMODE;case n.ETextureWrapMode.REPEAT:default:return c.Texture.WRAP_ADDRESSMODE}}static GetByteStrideFromType(e){switch(e.type){case"VEC2":return 2;case"VEC3":return 3;case"VEC4":case"MAT2":return 4;case"MAT3":return 9;case"MAT4":return 16;default:return 1}}static GetTextureFilterMode(e){switch(e){case n.ETextureFilterType.LINEAR:case n.ETextureFilterType.LINEAR_MIPMAP_NEAREST:case n.ETextureFilterType.LINEAR_MIPMAP_LINEAR:return c.Texture.TRILINEAR_SAMPLINGMODE;case n.ETextureFilterType.NEAREST:case n.ETextureFilterType.NEAREST_MIPMAP_NEAREST:return c.Texture.NEAREST_SAMPLINGMODE;default:return c.Texture.BILINEAR_SAMPLINGMODE}}static GetBufferFromBufferView(e,t,r,s,a){r=t.byteOffset+r;let o=e.loadedBufferViews[t.buffer];if(r+s>o.byteLength)throw Error("Buffer access is out of range");let i=o.buffer;switch(r+=o.byteOffset,a){case n.EComponentType.BYTE:return new Int8Array(i,r,s);case n.EComponentType.UNSIGNED_BYTE:return new Uint8Array(i,r,s);case n.EComponentType.SHORT:return new Int16Array(i,r,s);case n.EComponentType.UNSIGNED_SHORT:return new Uint16Array(i,r,s);default:return new Float32Array(i,r,s)}}static GetBufferFromAccessor(e,t){let r=e.bufferViews[t.bufferView],s=t.count*d.GetByteStrideFromType(t);return d.GetBufferFromBufferView(e,r,t.byteOffset,s,t.componentType)}static DecodeBufferToText(e){let t="",r=e.byteLength;for(let s=0;s<r;++s)t+=String.fromCharCode(e[s]);return t}static GetDefaultMaterial(e){return d._DefaultMaterial||(i.Effect.ShadersStore.GLTFDefaultMaterialVertexShader="precision highp float;\n\nuniform mat4 worldView;\nuniform mat4 projection;\n\nattribute vec3 position;\n\nvoid main(void)\n{\n    gl_Position = projection * worldView * vec4(position, 1.0);\n}",i.Effect.ShadersStore.GLTFDefaultMaterialPixelShader="precision highp float;\n\nuniform vec4 u_emission;\n\nvoid main(void)\n{\n    gl_FragColor = u_emission;\n}",d._DefaultMaterial=new l.ShaderMaterial("GLTFDefaultMaterial",e,{vertex:"GLTFDefaultMaterial",fragment:"GLTFDefaultMaterial"},{attributes:["position"],uniforms:["worldView","projection","u_emission"],samplers:[],needAlphaBlending:!1}),d._DefaultMaterial.setColor4("u_emission",new o.Color4(.5,.5,.5,1))),d._DefaultMaterial}}d._DefaultMaterial=null},{"./glTFLoaderInterfaces.js":"eWSDw","@babylonjs/core/Maths/math.vector.js":"h33gd","@babylonjs/core/Maths/math.color.js":"78my4","@babylonjs/core/Materials/effect.js":"7Vmut","@babylonjs/core/Materials/shaderMaterial.js":"lH6q5","@babylonjs/core/Materials/Textures/texture.js":"bYxw8","@parcel/transformer-js/src/esmodule-helpers.js":"XTfsy"}],hbxDH:[function(e,t,r){var s=e("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(r),s.export(r,"GLTFMaterialsCommonExtension",()=>p);var n=e("./glTFLoader.js"),a=e("@babylonjs/core/Maths/math.vector.js"),o=e("@babylonjs/core/Maths/math.color.js"),i=e("@babylonjs/core/Misc/tools.js"),l=e("@babylonjs/core/Materials/material.js"),c=e("@babylonjs/core/Materials/standardMaterial.js"),d=e("@babylonjs/core/Lights/hemisphericLight.js"),h=e("@babylonjs/core/Lights/directionalLight.js"),u=e("@babylonjs/core/Lights/pointLight.js"),_=e("@babylonjs/core/Lights/spotLight.js");class p extends n.GLTFLoaderExtension{constructor(){super("KHR_materials_common")}loadRuntimeExtensionsAsync(e){if(!e.extensions)return!1;let t=e.extensions[this.name];if(!t)return!1;let r=t.lights;if(r)for(let t in r){let s=r[t];switch(s.type){case"ambient":{let t=new d.HemisphericLight(s.name,new a.Vector3(0,1,0),e.scene),r=s.ambient;r&&(t.diffuse=(0,o.Color3).FromArray(r.color||[1,1,1]));break}case"point":{let t=new u.PointLight(s.name,new a.Vector3(10,10,10),e.scene),r=s.point;r&&(t.diffuse=(0,o.Color3).FromArray(r.color||[1,1,1]));break}case"directional":{let t=new h.DirectionalLight(s.name,new a.Vector3(0,-1,0),e.scene),r=s.directional;r&&(t.diffuse=(0,o.Color3).FromArray(r.color||[1,1,1]));break}case"spot":{let t=s.spot;t&&(new _.SpotLight(s.name,new a.Vector3(0,10,0),new a.Vector3(0,-1,0),t.fallOffAngle||Math.PI,t.fallOffExponent||0,e.scene).diffuse=(0,o.Color3).FromArray(t.color||[1,1,1]));break}default:(0,i.Tools).Warn('GLTF Material Common extension: light type "'+s.type+" not supported")}}return!1}loadMaterialAsync(e,t,r,s){let n=e.materials[t];if(!n||!n.extensions)return!1;let a=n.extensions[this.name];if(!a)return!1;let i=new c.StandardMaterial(t,e.scene);return i.sideOrientation=l.Material.CounterClockWiseSideOrientation,"CONSTANT"===a.technique&&(i.disableLighting=!0),i.backFaceCulling=void 0!==a.doubleSided&&!a.doubleSided,i.alpha=void 0===a.values.transparency?1:a.values.transparency,i.specularPower=void 0===a.values.shininess?0:a.values.shininess,"string"==typeof a.values.ambient?this._loadTexture(e,a.values.ambient,i,"ambientTexture",s):i.ambientColor=(0,o.Color3).FromArray(a.values.ambient||[0,0,0]),"string"==typeof a.values.diffuse?this._loadTexture(e,a.values.diffuse,i,"diffuseTexture",s):i.diffuseColor=(0,o.Color3).FromArray(a.values.diffuse||[0,0,0]),"string"==typeof a.values.emission?this._loadTexture(e,a.values.emission,i,"emissiveTexture",s):i.emissiveColor=(0,o.Color3).FromArray(a.values.emission||[0,0,0]),"string"==typeof a.values.specular?this._loadTexture(e,a.values.specular,i,"specularTexture",s):i.specularColor=(0,o.Color3).FromArray(a.values.specular||[0,0,0]),!0}_loadTexture(e,t,r,s,a){(0,n.GLTFLoaderBase).LoadTextureBufferAsync(e,t,a=>{(0,n.GLTFLoaderBase).CreateTextureAsync(e,t,a,e=>r[s]=e)},a)}}(0,n.GLTFLoader).RegisterExtension(new p)},{"./glTFLoader.js":"7RXC9","@babylonjs/core/Maths/math.vector.js":"h33gd","@babylonjs/core/Maths/math.color.js":"78my4","@babylonjs/core/Misc/tools.js":"ieufJ","@babylonjs/core/Materials/material.js":"b0eUV","@babylonjs/core/Materials/standardMaterial.js":"9hjVc","@babylonjs/core/Lights/hemisphericLight.js":"3ER0R","@babylonjs/core/Lights/directionalLight.js":"ed05w","@babylonjs/core/Lights/pointLight.js":"iBNs0","@babylonjs/core/Lights/spotLight.js":"kOHa2","@parcel/transformer-js/src/esmodule-helpers.js":"XTfsy"}],h2sWA:[function(e,t,r){var s=e("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(r);var n=e("./glTFLoader.js");s.exportAll(n,r);var a=e("./glTFLoaderExtension.js");s.exportAll(a,r);var o=e("./glTFLoaderInterfaces.js");s.exportAll(o,r);var i=e("./Extensions/index.js");s.exportAll(i,r)},{"./glTFLoader.js":"lHQW2","./glTFLoaderExtension.js":"8nluN","./glTFLoaderInterfaces.js":"RWLbc","./Extensions/index.js":"eRnTs","@parcel/transformer-js/src/esmodule-helpers.js":"XTfsy"}],lHQW2:[function(e,t,r){var s=e("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(r),s.export(r,"ArrayItem",()=>P),s.export(r,"GLTFLoader",()=>F);var n=e("@babylonjs/core/Misc/deferred.js"),a=e("@babylonjs/core/Maths/math.vector.js"),o=e("@babylonjs/core/Maths/math.color.js"),i=e("@babylonjs/core/Misc/tools.js"),l=e("@babylonjs/core/Cameras/camera.js"),c=e("@babylonjs/core/Cameras/freeCamera.js"),d=e("@babylonjs/core/Animations/animationKey.js"),h=e("@babylonjs/core/Animations/animationGroup.js"),u=e("@babylonjs/core/Bones/bone.js"),_=e("@babylonjs/core/Bones/skeleton.js"),p=e("@babylonjs/core/Materials/material.js"),m=e("@babylonjs/core/Materials/PBR/pbrMaterial.js"),f=e("@babylonjs/core/Materials/Textures/texture.js"),y=e("@babylonjs/core/Meshes/transformNode.js"),b=e("@babylonjs/core/Buffers/buffer.js"),g=e("@babylonjs/core/Meshes/geometry.js"),T=e("@babylonjs/core/Meshes/abstractMesh.js"),A=e("@babylonjs/core/Meshes/mesh.js"),x=e("@babylonjs/core/Morph/morphTarget.js"),v=e("@babylonjs/core/Morph/morphTargetManager.js"),M=e("../glTFFileLoader.js"),j=e("@babylonjs/core/Misc/fileTools.js"),E=e("@babylonjs/core/Misc/logger.js"),L=e("@babylonjs/core/Culling/boundingInfo.js"),C=e("./glTFLoaderAnimation.js");class P{static Get(e,t,r){if(!t||void 0==r||!t[r])throw Error(`${e}: Failed to find index (${r})`);return t[r]}static TryGet(e,t){return e&&void 0!=t&&e[t]?e[t]:null}static Assign(e){if(e)for(let t=0;t<e.length;t++)e[t].index=t}}class F{static RegisterExtension(e,t){F.UnregisterExtension(e)&&(0,E.Logger).Warn(`Extension with the name '${e}' already exists`),F._RegisteredExtensions[e]={factory:t}}static UnregisterExtension(e){return!!F._RegisteredExtensions[e]&&(delete F._RegisteredExtensions[e],!0)}get gltf(){if(!this._gltf)throw Error("glTF JSON is not available");return this._gltf}get bin(){return this._bin}get parent(){return this._parent}get babylonScene(){if(!this._babylonScene)throw Error("Scene is not available");return this._babylonScene}get rootBabylonMesh(){return this._rootBabylonMesh}get rootUrl(){return this._rootUrl}constructor(e){this._completePromises=[],this._assetContainer=null,this._babylonLights=[],this._disableInstancedMesh=0,this._allMaterialsDirtyRequired=!1,this._extensions=[],this._disposed=!1,this._rootUrl=null,this._fileName=null,this._uniqueRootUrl=null,this._bin=null,this._rootBabylonMesh=null,this._defaultBabylonMaterialData={},this._postSceneLoadActions=[],this._parent=e}dispose(){this._disposed||(this._disposed=!0,this._completePromises.length=0,this._extensions.forEach(e=>e.dispose&&e.dispose()),this._extensions.length=0,this._gltf=null,this._bin=null,this._babylonScene=null,this._rootBabylonMesh=null,this._defaultBabylonMaterialData={},this._postSceneLoadActions.length=0,this._parent.dispose())}importMeshAsync(e,t,r,s,n,a,o=""){return Promise.resolve().then(()=>{this._babylonScene=t,this._assetContainer=r,this._loadData(s);let a=null;if(e){let t={};if(this._gltf.nodes)for(let e of this._gltf.nodes)e.name&&(t[e.name]=e.index);a=(e instanceof Array?e:[e]).map(e=>{let r=t[e];if(void 0===r)throw Error(`Failed to find node '${e}'`);return r})}return this._loadAsync(n,o,a,()=>({meshes:this._getMeshes(),particleSystems:[],skeletons:this._getSkeletons(),animationGroups:this._getAnimationGroups(),lights:this._babylonLights,transformNodes:this._getTransformNodes(),geometries:this._getGeometries()}))})}loadAsync(e,t,r,s,n=""){return Promise.resolve().then(()=>(this._babylonScene=e,this._loadData(t),this._loadAsync(r,n,null,()=>void 0)))}_loadAsync(e,t,r,s){return Promise.resolve().then(()=>{this._rootUrl=e,this._uniqueRootUrl=!e.startsWith("file:")&&t?e:`${e}${Date.now()}/`,this._fileName=t,this._allMaterialsDirtyRequired=!1,this._loadExtensions(),this._checkExtensions();let n=`${M.GLTFLoaderState[M.GLTFLoaderState.LOADING]} => ${M.GLTFLoaderState[M.GLTFLoaderState.READY]}`,a=`${M.GLTFLoaderState[M.GLTFLoaderState.LOADING]} => ${M.GLTFLoaderState[M.GLTFLoaderState.COMPLETE]}`;this._parent._startPerformanceCounter(n),this._parent._startPerformanceCounter(a),this._parent._setState(M.GLTFLoaderState.LOADING),this._extensionsOnLoading();let o=[],l=this._babylonScene.blockMaterialDirtyMechanism;if(this._babylonScene.blockMaterialDirtyMechanism=!0,!this.parent.loadOnlyMaterials){if(r)o.push(this.loadSceneAsync("/nodes",{nodes:r,index:-1}));else if(void 0!=this._gltf.scene||this._gltf.scenes&&this._gltf.scenes[0]){let e=P.Get("/scene",this._gltf.scenes,this._gltf.scene||0);o.push(this.loadSceneAsync(`/scenes/${e.index}`,e))}}if(!this.parent.skipMaterials&&this.parent.loadAllMaterials&&this._gltf.materials)for(let e=0;e<this._gltf.materials.length;++e){let t=this._gltf.materials[e],r="/materials/"+e,s=p.Material.TriangleFillMode;o.push(this._loadMaterialAsync(r,t,null,s,()=>{}))}return this._allMaterialsDirtyRequired?this._babylonScene.blockMaterialDirtyMechanism=l:this._babylonScene._forceBlockMaterialDirtyMechanism(l),this._parent.compileMaterials&&o.push(this._compileMaterialsAsync()),this._parent.compileShadowGenerators&&o.push(this._compileShadowGeneratorsAsync()),Promise.all(o).then(()=>(this._rootBabylonMesh&&this._rootBabylonMesh!==this._parent.customRootNode&&this._rootBabylonMesh.setEnabled(!0),this._extensionsOnReady(),this._parent._setState(M.GLTFLoaderState.READY),this._startAnimations(),s())).then(e=>(this._parent._endPerformanceCounter(n),(0,i.Tools).SetImmediate(()=>{this._disposed||Promise.all(this._completePromises).then(()=>{this._parent._endPerformanceCounter(a),this._parent._setState(M.GLTFLoaderState.COMPLETE),this._parent.onCompleteObservable.notifyObservers(void 0),this._parent.onCompleteObservable.clear(),this.dispose()},e=>{this._parent.onErrorObservable.notifyObservers(e),this._parent.onErrorObservable.clear(),this.dispose()})}),e))}).catch(e=>{throw this._disposed||(this._parent.onErrorObservable.notifyObservers(e),this._parent.onErrorObservable.clear(),this.dispose()),e})}_loadData(e){if(this._gltf=e.json,this._setupData(),e.bin){let t=this._gltf.buffers;if(t&&t[0]&&!t[0].uri){let r=t[0];(r.byteLength<e.bin.byteLength-3||r.byteLength>e.bin.byteLength)&&(0,E.Logger).Warn(`Binary buffer length (${r.byteLength}) from JSON does not match chunk length (${e.bin.byteLength})`),this._bin=e.bin}else(0,E.Logger).Warn("Unexpected BIN chunk")}}_setupData(){if(P.Assign(this._gltf.accessors),P.Assign(this._gltf.animations),P.Assign(this._gltf.buffers),P.Assign(this._gltf.bufferViews),P.Assign(this._gltf.cameras),P.Assign(this._gltf.images),P.Assign(this._gltf.materials),P.Assign(this._gltf.meshes),P.Assign(this._gltf.nodes),P.Assign(this._gltf.samplers),P.Assign(this._gltf.scenes),P.Assign(this._gltf.skins),P.Assign(this._gltf.textures),this._gltf.nodes){let e={};for(let t of this._gltf.nodes)if(t.children)for(let r of t.children)e[r]=t.index;let t=this._createRootNode();for(let r of this._gltf.nodes){let s=e[r.index];r.parent=void 0===s?t:this._gltf.nodes[s]}}}_loadExtensions(){for(let e in F._RegisteredExtensions){let t=F._RegisteredExtensions[e].factory(this);t.name!==e&&(0,E.Logger).Warn(`The name of the glTF loader extension instance does not match the registered name: ${t.name} !== ${e}`),this._extensions.push(t),this._parent.onExtensionLoadedObservable.notifyObservers(t)}this._extensions.sort((e,t)=>(e.order||Number.MAX_VALUE)-(t.order||Number.MAX_VALUE)),this._parent.onExtensionLoadedObservable.clear()}_checkExtensions(){if(this._gltf.extensionsRequired){for(let e of this._gltf.extensionsRequired)if(!this._extensions.some(t=>t.name===e&&t.enabled))throw Error(`Required extension ${e} is not available`)}}_createRootNode(){if(void 0!==this._parent.customRootNode)return this._rootBabylonMesh=this._parent.customRootNode,{_babylonTransformNode:null===this._rootBabylonMesh?void 0:this._rootBabylonMesh,index:-1};this._babylonScene._blockEntityCollection=!!this._assetContainer;let e=new A.Mesh("__root__",this._babylonScene);this._rootBabylonMesh=e,this._rootBabylonMesh._parentContainer=this._assetContainer,this._babylonScene._blockEntityCollection=!1,this._rootBabylonMesh.setEnabled(!1);let t={_babylonTransformNode:this._rootBabylonMesh,index:-1};switch(this._parent.coordinateSystemMode){case M.GLTFLoaderCoordinateSystemMode.AUTO:this._babylonScene.useRightHandedSystem||(t.rotation=[0,1,0,0],t.scale=[1,1,-1],F._LoadTransform(t,this._rootBabylonMesh));break;case M.GLTFLoaderCoordinateSystemMode.FORCE_RIGHT_HANDED:this._babylonScene.useRightHandedSystem=!0;break;default:throw Error(`Invalid coordinate system mode (${this._parent.coordinateSystemMode})`)}return this._parent.onMeshLoadedObservable.notifyObservers(e),t}loadSceneAsync(e,t){let r=this._extensionsLoadSceneAsync(e,t);if(r)return r;let s=[];if(this.logOpen(`${e} ${t.name||""}`),t.nodes)for(let r of t.nodes){let t=P.Get(`${e}/nodes/${r}`,this._gltf.nodes,r);s.push(this.loadNodeAsync(`/nodes/${t.index}`,t,e=>{e.parent=this._rootBabylonMesh}))}for(let e of this._postSceneLoadActions)e();return s.push(this._loadAnimationsAsync()),this.logClose(),Promise.all(s).then(()=>{})}_forEachPrimitive(e,t){if(e._primitiveBabylonMeshes)for(let r of e._primitiveBabylonMeshes)t(r)}_getGeometries(){let e=[],t=this._gltf.nodes;if(t)for(let r of t)this._forEachPrimitive(r,t=>{let r=t.geometry;r&&-1===e.indexOf(r)&&e.push(r)});return e}_getMeshes(){let e=[];this._rootBabylonMesh instanceof T.AbstractMesh&&e.push(this._rootBabylonMesh);let t=this._gltf.nodes;if(t)for(let r of t)this._forEachPrimitive(r,t=>{e.push(t)});return e}_getTransformNodes(){let e=[],t=this._gltf.nodes;if(t)for(let r of t)r._babylonTransformNode&&"TransformNode"===r._babylonTransformNode.getClassName()&&e.push(r._babylonTransformNode),r._babylonTransformNodeForSkin&&e.push(r._babylonTransformNodeForSkin);return e}_getSkeletons(){let e=[],t=this._gltf.skins;if(t)for(let r of t)r._data&&e.push(r._data.babylonSkeleton);return e}_getAnimationGroups(){let e=[],t=this._gltf.animations;if(t)for(let r of t)r._babylonAnimationGroup&&e.push(r._babylonAnimationGroup);return e}_startAnimations(){switch(this._parent.animationStartMode){case M.GLTFLoaderAnimationStartMode.NONE:break;case M.GLTFLoaderAnimationStartMode.FIRST:{let e=this._getAnimationGroups();0!==e.length&&e[0].start(!0);break}case M.GLTFLoaderAnimationStartMode.ALL:for(let e of this._getAnimationGroups())e.start(!0);break;default:(0,E.Logger).Error(`Invalid animation start mode (${this._parent.animationStartMode})`);return}}loadNodeAsync(e,t,r=()=>{}){let s=this._extensionsLoadNodeAsync(e,t,r);if(s)return s;if(t._babylonTransformNode)throw Error(`${e}: Invalid recursive node hierarchy`);let n=[];this.logOpen(`${e} ${t.name||""}`);let a=s=>{if(F.AddPointerMetadata(s,e),F._LoadTransform(t,s),void 0!=t.camera){let r=P.Get(`${e}/camera`,this._gltf.cameras,t.camera);n.push(this.loadCameraAsync(`/cameras/${r.index}`,r,e=>{e.parent=s}))}if(t.children)for(let r of t.children){let t=P.Get(`${e}/children/${r}`,this._gltf.nodes,r);n.push(this.loadNodeAsync(`/nodes/${t.index}`,t,e=>{e.parent=s}))}r(s)};if(void 0==t.mesh||void 0!=t.skin){let e=t.name||`node${t.index}`;this._babylonScene._blockEntityCollection=!!this._assetContainer;let r=new y.TransformNode(e,this._babylonScene);r._parentContainer=this._assetContainer,this._babylonScene._blockEntityCollection=!1,void 0==t.mesh?t._babylonTransformNode=r:t._babylonTransformNodeForSkin=r,a(r)}if(void 0!=t.mesh){if(void 0==t.skin){let r=P.Get(`${e}/mesh`,this._gltf.meshes,t.mesh);n.push(this._loadMeshAsync(`/meshes/${r.index}`,t,r,a))}else{let r=P.Get(`${e}/mesh`,this._gltf.meshes,t.mesh);n.push(this._loadMeshAsync(`/meshes/${r.index}`,t,r,r=>{let s=t._babylonTransformNodeForSkin;r.metadata=function e(...t){let r=e=>e&&"object"==typeof e;return t.reduce((t,s)=>(Object.keys(s).forEach(n=>{let a=t[n],o=s[n];Array.isArray(a)&&Array.isArray(o)?t[n]=a.concat(...o):r(a)&&r(o)?t[n]=e(a,o):t[n]=o}),t),{})}(s.metadata,r.metadata||{});let a=P.Get(`${e}/skin`,this._gltf.skins,t.skin);n.push(this._loadSkinAsync(`/skins/${a.index}`,t,a,e=>{this._forEachPrimitive(t,t=>{t.skeleton=e}),this._postSceneLoadActions.push(()=>{if(void 0!=a.skeleton){let e=P.Get(`/skins/${a.index}/skeleton`,this._gltf.nodes,a.skeleton).parent;t.index===e.index?r.parent=s.parent:r.parent=e._babylonTransformNode}else r.parent=this._rootBabylonMesh;this._parent.onSkinLoadedObservable.notifyObservers({node:s,skinnedNode:r})})}))}))}}return this.logClose(),Promise.all(n).then(()=>(this._forEachPrimitive(t,e=>{e.geometry&&e.geometry.useBoundingInfoFromGeometry?e._updateBoundingInfo():e.refreshBoundingInfo(!0)}),t._babylonTransformNode))}_loadMeshAsync(e,t,r,s){let n=r.primitives;if(!n||!n.length)throw Error(`${e}: Primitives are missing`);void 0==n[0].index&&P.Assign(n);let a=[];this.logOpen(`${e} ${r.name||""}`);let o=t.name||`node${t.index}`;if(1===n.length){let s=r.primitives[0];a.push(this._loadMeshPrimitiveAsync(`${e}/primitives/${s.index}`,o,t,r,s,e=>{t._babylonTransformNode=e,t._primitiveBabylonMeshes=[e]}))}else for(let s of(this._babylonScene._blockEntityCollection=!!this._assetContainer,t._babylonTransformNode=new y.TransformNode(o,this._babylonScene),t._babylonTransformNode._parentContainer=this._assetContainer,this._babylonScene._blockEntityCollection=!1,t._primitiveBabylonMeshes=[],n))a.push(this._loadMeshPrimitiveAsync(`${e}/primitives/${s.index}`,`${o}_primitive${s.index}`,t,r,s,e=>{e.parent=t._babylonTransformNode,t._primitiveBabylonMeshes.push(e)}));return s(t._babylonTransformNode),this.logClose(),Promise.all(a).then(()=>t._babylonTransformNode)}_loadMeshPrimitiveAsync(e,t,r,s,n,a){let o,i;let l=this._extensionsLoadMeshPrimitiveAsync(e,t,r,s,n,a);if(l)return l;this.logOpen(`${e}`);let c=0===this._disableInstancedMesh&&this._parent.createInstances&&void 0==r.skin&&!s.primitives[0].targets;if(c&&n._instanceData)this._babylonScene._blockEntityCollection=!!this._assetContainer,(o=n._instanceData.babylonSourceMesh.createInstance(t))._parentContainer=this._assetContainer,this._babylonScene._blockEntityCollection=!1,i=n._instanceData.promise;else{let a=[];this._babylonScene._blockEntityCollection=!!this._assetContainer;let l=new A.Mesh(t,this._babylonScene);l._parentContainer=this._assetContainer,this._babylonScene._blockEntityCollection=!1,l.overrideMaterialSideOrientation=this._babylonScene.useRightHandedSystem?p.Material.CounterClockWiseSideOrientation:p.Material.ClockWiseSideOrientation,this._createMorphTargets(e,r,s,n,l),a.push(this._loadVertexDataAsync(e,n,l).then(t=>this._loadMorphTargetsAsync(e,n,l,t).then(()=>{this._disposed||(this._babylonScene._blockEntityCollection=!!this._assetContainer,t.applyToMesh(l),t._parentContainer=this._assetContainer,this._babylonScene._blockEntityCollection=!1)})));let d=F._GetDrawMode(e,n.mode);if(void 0==n.material){let e=this._defaultBabylonMaterialData[d];e||(e=this._createDefaultMaterial("__GLTFLoader._default",d),this._parent.onMaterialLoadedObservable.notifyObservers(e),this._defaultBabylonMaterialData[d]=e),l.material=e}else if(!this.parent.skipMaterials){let t=P.Get(`${e}/material`,this._gltf.materials,n.material);a.push(this._loadMaterialAsync(`/materials/${t.index}`,t,l,d,e=>{l.material=e}))}i=Promise.all(a),c&&(n._instanceData={babylonSourceMesh:l,promise:i}),o=l}return F.AddPointerMetadata(o,e),this._parent.onMeshLoadedObservable.notifyObservers(o),a(o),this.logClose(),i.then(()=>o)}_loadVertexDataAsync(e,t,r){let s=this._extensionsLoadVertexDataAsync(e,t,r);if(s)return s;let n=t.attributes;if(!n)throw Error(`${e}: Attributes are missing`);let o=[],i=new g.Geometry(r.name,this._babylonScene);if(void 0==t.indices)r.isUnIndexed=!0;else{let r=P.Get(`${e}/indices`,this._gltf.accessors,t.indices);o.push(this._loadIndicesAccessorAsync(`/accessors/${r.index}`,r).then(e=>{i.setIndices(e)}))}let l=(t,s,l)=>{if(void 0==n[t])return;r._delayInfo=r._delayInfo||[],-1===r._delayInfo.indexOf(s)&&r._delayInfo.push(s);let c=P.Get(`${e}/attributes/${t}`,this._gltf.accessors,n[t]);o.push(this._loadVertexAccessorAsync(`/accessors/${c.index}`,c,s).then(e=>{if(e.getKind()===b.VertexBuffer.PositionKind&&!this.parent.alwaysComputeBoundingBox&&!r.skeleton&&c.min&&c.max){let e=(0,a.TmpVectors).Vector3[0].copyFromFloats(...c.min),t=(0,a.TmpVectors).Vector3[1].copyFromFloats(...c.max);if(c.normalized&&5126!==c.componentType){let r=1;switch(c.componentType){case 5120:r=127;break;case 5121:r=255;break;case 5122:r=32767;break;case 5123:r=65535}let s=1/r;e.scaleInPlace(s),t.scaleInPlace(s)}i._boundingInfo=new L.BoundingInfo(e,t),i.useBoundingInfoFromGeometry=!0}i.setVerticesBuffer(e,c.count)})),s==b.VertexBuffer.MatricesIndicesExtraKind&&(r.numBoneInfluencers=8),l&&l(c)};return l("POSITION",b.VertexBuffer.PositionKind),l("NORMAL",b.VertexBuffer.NormalKind),l("TANGENT",b.VertexBuffer.TangentKind),l("TEXCOORD_0",b.VertexBuffer.UVKind),l("TEXCOORD_1",b.VertexBuffer.UV2Kind),l("TEXCOORD_2",b.VertexBuffer.UV3Kind),l("TEXCOORD_3",b.VertexBuffer.UV4Kind),l("TEXCOORD_4",b.VertexBuffer.UV5Kind),l("TEXCOORD_5",b.VertexBuffer.UV6Kind),l("JOINTS_0",b.VertexBuffer.MatricesIndicesKind),l("WEIGHTS_0",b.VertexBuffer.MatricesWeightsKind),l("JOINTS_1",b.VertexBuffer.MatricesIndicesExtraKind),l("WEIGHTS_1",b.VertexBuffer.MatricesWeightsExtraKind),l("COLOR_0",b.VertexBuffer.ColorKind,e=>{"VEC4"===e.type&&(r.hasVertexAlpha=!0)}),Promise.all(o).then(()=>i)}_createMorphTargets(e,t,r,s,n){if(!s.targets)return;if(void 0==t._numMorphTargets)t._numMorphTargets=s.targets.length;else if(s.targets.length!==t._numMorphTargets)throw Error(`${e}: Primitives do not have the same number of targets`);let a=r.extras?r.extras.targetNames:null;this._babylonScene._blockEntityCollection=!!this._assetContainer,n.morphTargetManager=new v.MorphTargetManager(this._babylonScene),n.morphTargetManager._parentContainer=this._assetContainer,this._babylonScene._blockEntityCollection=!1,n.morphTargetManager.areUpdatesFrozen=!0;for(let e=0;e<s.targets.length;e++){let s=t.weights?t.weights[e]:r.weights?r.weights[e]:0,o=a?a[e]:`morphTarget${e}`;n.morphTargetManager.addTarget(new x.MorphTarget(o,s,n.getScene()))}}_loadMorphTargetsAsync(e,t,r,s){if(!t.targets)return Promise.resolve();let n=[],a=r.morphTargetManager;for(let r=0;r<a.numTargets;r++){let o=a.getTarget(r);n.push(this._loadMorphTargetVertexDataAsync(`${e}/targets/${r}`,s,t.targets[r],o))}return Promise.all(n).then(()=>{a.areUpdatesFrozen=!1})}_loadMorphTargetVertexDataAsync(e,t,r,s){let n=[],a=(s,a,o)=>{if(void 0==r[s])return;let i=t.getVertexBuffer(a);if(!i)return;let l=P.Get(`${e}/${s}`,this._gltf.accessors,r[s]);n.push(this._loadFloatAccessorAsync(`/accessors/${l.index}`,l).then(e=>{o(i,e)}))};return a("POSITION",b.VertexBuffer.PositionKind,(e,t)=>{let r=new Float32Array(t.length);e.forEach(t.length,(e,s)=>{r[s]=t[s]+e}),s.setPositions(r)}),a("NORMAL",b.VertexBuffer.NormalKind,(e,t)=>{let r=new Float32Array(t.length);e.forEach(r.length,(e,s)=>{r[s]=t[s]+e}),s.setNormals(r)}),a("TANGENT",b.VertexBuffer.TangentKind,(e,t)=>{let r=new Float32Array(t.length/3*4),n=0;e.forEach(t.length/3*4,(e,s)=>{(s+1)%4!=0&&(r[n]=t[n]+e,n++)}),s.setTangents(r)}),Promise.all(n).then(()=>{})}static _LoadTransform(e,t){if(void 0!=e.skin)return;let r=(0,a.Vector3).Zero(),s=(0,a.Quaternion).Identity(),n=(0,a.Vector3).One();e.matrix?(0,a.Matrix).FromArray(e.matrix).decompose(n,s,r):(e.translation&&(r=(0,a.Vector3).FromArray(e.translation)),e.rotation&&(s=(0,a.Quaternion).FromArray(e.rotation)),e.scale&&(n=(0,a.Vector3).FromArray(e.scale))),t.position=r,t.rotationQuaternion=s,t.scaling=n}_loadSkinAsync(e,t,r,s){let n=this._extensionsLoadSkinAsync(e,t,r);if(n)return n;if(r._data)return s(r._data.babylonSkeleton),r._data.promise;let a=`skeleton${r.index}`;this._babylonScene._blockEntityCollection=!!this._assetContainer;let o=new _.Skeleton(r.name||a,a,this._babylonScene);o._parentContainer=this._assetContainer,this._babylonScene._blockEntityCollection=!1,this._loadBones(e,r,o);let i=this._loadSkinInverseBindMatricesDataAsync(e,r).then(e=>{this._updateBoneMatrices(o,e)});return r._data={babylonSkeleton:o,promise:i},s(o),i}_loadBones(e,t,r){if(void 0==t.skeleton||this._parent.alwaysComputeSkeletonRootNode){let r=this._findSkeletonRootNode(`${e}/joints`,t.joints);if(r){if(void 0===t.skeleton)t.skeleton=r.index;else{let s=P.Get(`${e}/skeleton`,this._gltf.nodes,t.skeleton);s===r||((e,t)=>{for(;t.parent;t=t.parent)if(t.parent===e)return!0;return!1})(s,r)||((0,E.Logger).Warn(`${e}/skeleton: Overriding with nearest common ancestor as skeleton node is not a common root`),t.skeleton=r.index)}}else(0,E.Logger).Warn(`${e}: Failed to find common root`)}let s={};for(let n of t.joints){let a=P.Get(`${e}/joints/${n}`,this._gltf.nodes,n);this._loadBone(a,t,r,s)}}_findSkeletonRootNode(e,t){if(0===t.length)return null;let r={};for(let s of t){let t=[],n=P.Get(`${e}/${s}`,this._gltf.nodes,s);for(;-1!==n.index;)t.unshift(n),n=n.parent;r[s]=t}let s=null;for(let e=0;;++e){let n=r[t[0]];if(e>=n.length)return s;let a=n[e];for(let o=1;o<t.length;++o)if(e>=(n=r[t[o]]).length||a!==n[e])return s;s=a}}_loadBone(e,t,r,s){let n=s[e.index];if(n)return n;let a=null;e.index!==t.skeleton&&(e.parent&&-1!==e.parent.index?a=this._loadBone(e.parent,t,r,s):void 0!==t.skeleton&&(0,E.Logger).Warn(`/skins/${t.index}/skeleton: Skeleton node is not a common root`));let o=t.joints.indexOf(e.index);return n=new u.Bone(e.name||`joint${e.index}`,r,a,this._getNodeMatrix(e),null,null,o),s[e.index]=n,this._postSceneLoadActions.push(()=>{n.linkTransformNode(e._babylonTransformNode)}),n}_loadSkinInverseBindMatricesDataAsync(e,t){if(void 0==t.inverseBindMatrices)return Promise.resolve(null);let r=P.Get(`${e}/inverseBindMatrices`,this._gltf.accessors,t.inverseBindMatrices);return this._loadFloatAccessorAsync(`/accessors/${r.index}`,r)}_updateBoneMatrices(e,t){for(let r of e.bones){let e=(0,a.Matrix).Identity(),s=r._index;t&&-1!==s&&((0,a.Matrix).FromArrayToRef(t,16*s,e),e.invertToRef(e));let n=r.getParent();n&&e.multiplyToRef(n.getAbsoluteInverseBindMatrix(),e),r.updateMatrix(e,!1,!1),r._updateAbsoluteBindMatrices(void 0,!1)}}_getNodeMatrix(e){return e.matrix?(0,a.Matrix).FromArray(e.matrix):(0,a.Matrix).Compose(e.scale?(0,a.Vector3).FromArray(e.scale):(0,a.Vector3).One(),e.rotation?(0,a.Quaternion).FromArray(e.rotation):(0,a.Quaternion).Identity(),e.translation?(0,a.Vector3).FromArray(e.translation):(0,a.Vector3).Zero())}loadCameraAsync(e,t,r=()=>{}){let s=this._extensionsLoadCameraAsync(e,t,r);if(s)return s;this.logOpen(`${e} ${t.name||""}`),this._babylonScene._blockEntityCollection=!!this._assetContainer;let n=new c.FreeCamera(t.name||`camera${t.index}`,(0,a.Vector3).Zero(),this._babylonScene,!1);switch(n._parentContainer=this._assetContainer,this._babylonScene._blockEntityCollection=!1,n.ignoreParentScaling=!0,t._babylonCamera=n,n.rotation.set(0,Math.PI,0),t.type){case"perspective":{let r=t.perspective;if(!r)throw Error(`${e}: Camera perspective properties are missing`);n.fov=r.yfov,n.minZ=r.znear,n.maxZ=r.zfar||0;break}case"orthographic":if(!t.orthographic)throw Error(`${e}: Camera orthographic properties are missing`);n.mode=l.Camera.ORTHOGRAPHIC_CAMERA,n.orthoLeft=-t.orthographic.xmag,n.orthoRight=t.orthographic.xmag,n.orthoBottom=-t.orthographic.ymag,n.orthoTop=t.orthographic.ymag,n.minZ=t.orthographic.znear,n.maxZ=t.orthographic.zfar;break;default:throw Error(`${e}: Invalid camera type (${t.type})`)}return F.AddPointerMetadata(n,e),this._parent.onCameraLoadedObservable.notifyObservers(n),r(n),this.logClose(),Promise.all([]).then(()=>n)}_loadAnimationsAsync(){let e=this._gltf.animations;if(!e)return Promise.resolve();let t=[];for(let r=0;r<e.length;r++){let s=e[r];t.push(this.loadAnimationAsync(`/animations/${s.index}`,s).then(e=>{0===e.targetedAnimations.length&&e.dispose()}))}return Promise.all(t).then(()=>{})}loadAnimationAsync(e,t){let r=this._extensionsLoadAnimationAsync(e,t);if(r)return r;this._babylonScene._blockEntityCollection=!!this._assetContainer;let s=new h.AnimationGroup(t.name||`animation${t.index}`,this._babylonScene);s._parentContainer=this._assetContainer,this._babylonScene._blockEntityCollection=!1,t._babylonAnimationGroup=s;let n=[];for(let r of(P.Assign(t.channels),P.Assign(t.samplers),t.channels))n.push(this._loadAnimationChannelAsync(`${e}/channels/${r.index}`,e,t,r,(e,t)=>{e.animations=e.animations||[],e.animations.push(t),s.addTargetedAnimation(t,e)}));return Promise.all(n).then(()=>(s.normalize(0),s))}_loadAnimationChannelAsync(e,t,r,s,n){let a;let o=this._extensionsLoadAnimationChannelAsync(e,t,r,s,n);if(o)return o;if(void 0==s.target.node)return Promise.resolve();let i=P.Get(`${e}/target/node`,this._gltf.nodes,s.target.node);if("weights"===s.target.path&&!i._numMorphTargets||"weights"!==s.target.path&&!i._babylonTransformNode)return Promise.resolve();switch(s.target.path){case"translation":a=C.nodeAnimationData.translation;break;case"rotation":a=C.nodeAnimationData.rotation;break;case"scale":a=C.nodeAnimationData.scale;break;case"weights":a=C.nodeAnimationData.weights;break;default:throw Error(`${e}/target/path: Invalid value (${s.target.path})`)}let l={object:i,info:a};return this._loadAnimationChannelFromTargetInfoAsync(e,t,r,s,l,n)}_loadAnimationChannelFromTargetInfoAsync(e,t,r,s,n,a){let o=this.parent.targetFps,i=1/o,l=P.Get(`${e}/sampler`,r.samplers,s.sampler);return this._loadAnimationSamplerAsync(`${t}/samplers/${s.sampler}`,l).then(e=>{let t=0,l=n.object;for(let c of n.info){let n=c.getStride(l),h=e.input,u=e.output,_=Array(h.length),p=0;switch(e.interpolation){case"STEP":for(let e=0;e<h.length;e++){let t=c.getValue(l,u,p,1);p+=n,_[e]={frame:h[e]*o,value:t,interpolation:d.AnimationKeyInterpolation.STEP}}break;case"CUBICSPLINE":for(let e=0;e<h.length;e++){let t=c.getValue(l,u,p,i);p+=n;let r=c.getValue(l,u,p,1);p+=n;let s=c.getValue(l,u,p,i);p+=n,_[e]={frame:h[e]*o,inTangent:t,value:r,outTangent:s}}break;case"LINEAR":for(let e=0;e<h.length;e++){let t=c.getValue(l,u,p,1);p+=n,_[e]={frame:h[e]*o,value:t}}}if(p>0){let e=`${r.name||`animation${r.index}`}_channel${s.index}_${t}`;c.buildAnimations(l,e,o,_,(e,r)=>{++t,a(e,r)})}}})}_loadAnimationSamplerAsync(e,t){if(t._data)return t._data;let r=t.interpolation||"LINEAR";switch(r){case"STEP":case"LINEAR":case"CUBICSPLINE":break;default:throw Error(`${e}/interpolation: Invalid value (${t.interpolation})`)}let s=P.Get(`${e}/input`,this._gltf.accessors,t.input),n=P.Get(`${e}/output`,this._gltf.accessors,t.output);return t._data=Promise.all([this._loadFloatAccessorAsync(`/accessors/${s.index}`,s),this._loadFloatAccessorAsync(`/accessors/${n.index}`,n)]).then(([e,t])=>({input:e,interpolation:r,output:t})),t._data}loadBufferAsync(e,t,r,s){let n=this._extensionsLoadBufferAsync(e,t,r,s);if(n)return n;if(!t._data){if(t.uri)t._data=this.loadUriAsync(`${e}/uri`,t,t.uri);else{if(!this._bin)throw Error(`${e}: Uri is missing or the binary glTF is missing its binary chunk`);t._data=this._bin.readAsync(0,t.byteLength)}}return t._data.then(t=>{try{return new Uint8Array(t.buffer,t.byteOffset+r,s)}catch(t){throw Error(`${e}: ${t.message}`)}})}loadBufferViewAsync(e,t){let r=this._extensionsLoadBufferViewAsync(e,t);if(r)return r;if(t._data)return t._data;let s=P.Get(`${e}/buffer`,this._gltf.buffers,t.buffer);return t._data=this.loadBufferAsync(`/buffers/${s.index}`,s,t.byteOffset||0,t.byteLength),t._data}_loadAccessorAsync(e,t,r){if(t._data)return t._data;let s=F._GetNumComponents(e,t.type),n=s*(0,b.VertexBuffer).GetTypeByteLength(t.componentType),a=s*t.count;if(void 0==t.bufferView)t._data=Promise.resolve(new r(a));else{let o=P.Get(`${e}/bufferView`,this._gltf.bufferViews,t.bufferView);t._data=this.loadBufferViewAsync(`/bufferViews/${o.index}`,o).then(i=>{if(5126===t.componentType&&!t.normalized&&(!o.byteStride||o.byteStride===n))return F._GetTypedArray(e,t.componentType,i,t.byteOffset,a);{let e=new r(a);return(0,b.VertexBuffer).ForEach(i,t.byteOffset||0,o.byteStride||n,s,t.componentType,e.length,t.normalized||!1,(t,r)=>{e[r]=t}),e}})}if(t.sparse){let a=t.sparse;t._data=t._data.then(o=>{let i=P.Get(`${e}/sparse/indices/bufferView`,this._gltf.bufferViews,a.indices.bufferView),l=P.Get(`${e}/sparse/values/bufferView`,this._gltf.bufferViews,a.values.bufferView);return Promise.all([this.loadBufferViewAsync(`/bufferViews/${i.index}`,i),this.loadBufferViewAsync(`/bufferViews/${l.index}`,l)]).then(([i,l])=>{let c;let d=F._GetTypedArray(`${e}/sparse/indices`,a.indices.componentType,i,a.indices.byteOffset,a.count),h=s*a.count;if(5126!==t.componentType||t.normalized){let o=F._GetTypedArray(`${e}/sparse/values`,t.componentType,l,a.values.byteOffset,h);c=new r(h),(0,b.VertexBuffer).ForEach(o,0,n,s,t.componentType,c.length,t.normalized||!1,(e,t)=>{c[t]=e})}else c=F._GetTypedArray(`${e}/sparse/values`,t.componentType,l,a.values.byteOffset,h);let u=0;for(let e=0;e<d.length;e++){let t=d[e]*s;for(let e=0;e<s;e++)o[t++]=c[u++]}return o})})}return t._data}_loadFloatAccessorAsync(e,t){return this._loadAccessorAsync(e,t,Float32Array)}_loadIndicesAccessorAsync(e,t){if("SCALAR"!==t.type)throw Error(`${e}/type: Invalid value ${t.type}`);if(5121!==t.componentType&&5123!==t.componentType&&5125!==t.componentType)throw Error(`${e}/componentType: Invalid value ${t.componentType}`);if(t._data)return t._data;if(t.sparse){let r=F._GetTypedArrayConstructor(`${e}/componentType`,t.componentType);t._data=this._loadAccessorAsync(e,t,r)}else{let r=P.Get(`${e}/bufferView`,this._gltf.bufferViews,t.bufferView);t._data=this.loadBufferViewAsync(`/bufferViews/${r.index}`,r).then(r=>F._GetTypedArray(e,t.componentType,r,t.byteOffset,t.count))}return t._data}_loadVertexBufferViewAsync(e){if(e._babylonBuffer)return e._babylonBuffer;let t=this._babylonScene.getEngine();return e._babylonBuffer=this.loadBufferViewAsync(`/bufferViews/${e.index}`,e).then(e=>new b.Buffer(t,e,!1)),e._babylonBuffer}_loadVertexAccessorAsync(e,t,r){if(t._babylonVertexBuffer?.[r])return t._babylonVertexBuffer[r];t._babylonVertexBuffer||(t._babylonVertexBuffer={});let s=this._babylonScene.getEngine();if(t.sparse||void 0==t.bufferView)t._babylonVertexBuffer[r]=this._loadFloatAccessorAsync(e,t).then(e=>new b.VertexBuffer(s,e,r,!1));else{let n=P.Get(`${e}/bufferView`,this._gltf.bufferViews,t.bufferView);t._babylonVertexBuffer[r]=this._loadVertexBufferViewAsync(n).then(a=>{let o=F._GetNumComponents(e,t.type);return new b.VertexBuffer(s,a,r,!1,void 0,n.byteStride,void 0,t.byteOffset,o,t.componentType,t.normalized,!0,void 0,!0)})}return t._babylonVertexBuffer[r]}_loadMaterialMetallicRoughnessPropertiesAsync(e,t,r){if(!(r instanceof m.PBRMaterial))throw Error(`${e}: Material type not supported`);let s=[];return t&&(t.baseColorFactor?(r.albedoColor=(0,o.Color3).FromArray(t.baseColorFactor),r.alpha=t.baseColorFactor[3]):r.albedoColor=(0,o.Color3).White(),r.metallic=void 0==t.metallicFactor?1:t.metallicFactor,r.roughness=void 0==t.roughnessFactor?1:t.roughnessFactor,t.baseColorTexture&&s.push(this.loadTextureInfoAsync(`${e}/baseColorTexture`,t.baseColorTexture,e=>{e.name=`${r.name} (Base Color)`,r.albedoTexture=e})),t.metallicRoughnessTexture&&(t.metallicRoughnessTexture.nonColorData=!0,s.push(this.loadTextureInfoAsync(`${e}/metallicRoughnessTexture`,t.metallicRoughnessTexture,e=>{e.name=`${r.name} (Metallic Roughness)`,r.metallicTexture=e})),r.useMetallnessFromMetallicTextureBlue=!0,r.useRoughnessFromMetallicTextureGreen=!0,r.useRoughnessFromMetallicTextureAlpha=!1)),Promise.all(s).then(()=>{})}_loadMaterialAsync(e,t,r,s,n=()=>{}){let a=this._extensionsLoadMaterialAsync(e,t,r,s,n);if(a)return a;t._data=t._data||{};let o=t._data[s];if(!o){this.logOpen(`${e} ${t.name||""}`);let r=this.createMaterial(e,t,s);o={babylonMaterial:r,babylonMeshes:[],promise:this.loadMaterialPropertiesAsync(e,t,r)},t._data[s]=o,F.AddPointerMetadata(r,e),this._parent.onMaterialLoadedObservable.notifyObservers(r),this.logClose()}return r&&(o.babylonMeshes.push(r),r.onDisposeObservable.addOnce(()=>{let e=o.babylonMeshes.indexOf(r);-1!==e&&o.babylonMeshes.splice(e,1)})),n(o.babylonMaterial),o.promise.then(()=>o.babylonMaterial)}_createDefaultMaterial(e,t){this._babylonScene._blockEntityCollection=!!this._assetContainer;let r=new m.PBRMaterial(e,this._babylonScene);return r._parentContainer=this._assetContainer,this._babylonScene._blockEntityCollection=!1,r.fillMode=t,r.enableSpecularAntiAliasing=!0,r.useRadianceOverAlpha=!this._parent.transparencyAsCoverage,r.useSpecularOverAlpha=!this._parent.transparencyAsCoverage,r.transparencyMode=m.PBRMaterial.PBRMATERIAL_OPAQUE,r.metallic=1,r.roughness=1,r}createMaterial(e,t,r){let s=this._extensionsCreateMaterial(e,t,r);if(s)return s;let n=t.name||`material${t.index}`;return this._createDefaultMaterial(n,r)}loadMaterialPropertiesAsync(e,t,r){let s=this._extensionsLoadMaterialPropertiesAsync(e,t,r);if(s)return s;let n=[];return n.push(this.loadMaterialBasePropertiesAsync(e,t,r)),t.pbrMetallicRoughness&&n.push(this._loadMaterialMetallicRoughnessPropertiesAsync(`${e}/pbrMetallicRoughness`,t.pbrMetallicRoughness,r)),this.loadMaterialAlphaProperties(e,t,r),Promise.all(n).then(()=>{})}loadMaterialBasePropertiesAsync(e,t,r){if(!(r instanceof m.PBRMaterial))throw Error(`${e}: Material type not supported`);let s=[];return r.emissiveColor=t.emissiveFactor?(0,o.Color3).FromArray(t.emissiveFactor):new o.Color3(0,0,0),t.doubleSided&&(r.backFaceCulling=!1,r.twoSidedLighting=!0),t.normalTexture&&(t.normalTexture.nonColorData=!0,s.push(this.loadTextureInfoAsync(`${e}/normalTexture`,t.normalTexture,e=>{e.name=`${r.name} (Normal)`,r.bumpTexture=e})),r.invertNormalMapX=!this._babylonScene.useRightHandedSystem,r.invertNormalMapY=this._babylonScene.useRightHandedSystem,void 0!=t.normalTexture.scale&&r.bumpTexture&&(r.bumpTexture.level=t.normalTexture.scale),r.forceIrradianceInFragment=!0),t.occlusionTexture&&(t.occlusionTexture.nonColorData=!0,s.push(this.loadTextureInfoAsync(`${e}/occlusionTexture`,t.occlusionTexture,e=>{e.name=`${r.name} (Occlusion)`,r.ambientTexture=e})),r.useAmbientInGrayScale=!0,void 0!=t.occlusionTexture.strength&&(r.ambientTextureStrength=t.occlusionTexture.strength)),t.emissiveTexture&&s.push(this.loadTextureInfoAsync(`${e}/emissiveTexture`,t.emissiveTexture,e=>{e.name=`${r.name} (Emissive)`,r.emissiveTexture=e})),Promise.all(s).then(()=>{})}loadMaterialAlphaProperties(e,t,r){if(!(r instanceof m.PBRMaterial))throw Error(`${e}: Material type not supported`);switch(t.alphaMode||"OPAQUE"){case"OPAQUE":r.transparencyMode=m.PBRMaterial.PBRMATERIAL_OPAQUE,r.alpha=1;break;case"MASK":r.transparencyMode=m.PBRMaterial.PBRMATERIAL_ALPHATEST,r.alphaCutOff=void 0==t.alphaCutoff?.5:t.alphaCutoff,r.albedoTexture&&(r.albedoTexture.hasAlpha=!0);break;case"BLEND":r.transparencyMode=m.PBRMaterial.PBRMATERIAL_ALPHABLEND,r.albedoTexture&&(r.albedoTexture.hasAlpha=!0,r.useAlphaFromAlbedoTexture=!0);break;default:throw Error(`${e}/alphaMode: Invalid value (${t.alphaMode})`)}}loadTextureInfoAsync(e,t,r=()=>{}){let s=this._extensionsLoadTextureInfoAsync(e,t,r);if(s)return s;if(this.logOpen(`${e}`),t.texCoord>=6)throw Error(`${e}/texCoord: Invalid value (${t.texCoord})`);let n=P.Get(`${e}/index`,this._gltf.textures,t.index);n._textureInfo=t;let a=this._loadTextureAsync(`/textures/${t.index}`,n,s=>{s.coordinatesIndex=t.texCoord||0,F.AddPointerMetadata(s,e),this._parent.onTextureLoadedObservable.notifyObservers(s),r(s)});return this.logClose(),a}_loadTextureAsync(e,t,r=()=>{}){let s=this._extensionsLoadTextureAsync(e,t,r);if(s)return s;this.logOpen(`${e} ${t.name||""}`);let n=void 0==t.sampler?F.DefaultSampler:P.Get(`${e}/sampler`,this._gltf.samplers,t.sampler),a=P.Get(`${e}/source`,this._gltf.images,t.source),o=this._createTextureAsync(e,n,a,r,void 0,!t._textureInfo.nonColorData);return this.logClose(),o}_createTextureAsync(e,t,r,s=()=>{},a,o){let i=this._loadSampler(`/samplers/${t.index}`,t),l=[],c=new n.Deferred;this._babylonScene._blockEntityCollection=!!this._assetContainer;let d={noMipmap:i.noMipMaps,invertY:!1,samplingMode:i.samplingMode,onLoad:()=>{this._disposed||c.resolve()},onError:(t,r)=>{this._disposed||c.reject(Error(`${e}: ${r&&r.message?r.message:t||"Failed to load texture"}`))},mimeType:r.mimeType,loaderOptions:a,useSRGBBuffer:!!o&&this._parent.useSRGBBuffers},h=new f.Texture(null,this._babylonScene,d);return h._parentContainer=this._assetContainer,this._babylonScene._blockEntityCollection=!1,l.push(c.promise),l.push(this.loadImageAsync(`/images/${r.index}`,r).then(e=>{let t=r.uri||`${this._fileName}#image${r.index}`,s=`data:${this._uniqueRootUrl}${t}`;h.updateURL(s,e)})),h.wrapU=i.wrapU,h.wrapV=i.wrapV,s(h),Promise.all(l).then(()=>h)}_loadSampler(e,t){return t._data||(t._data={noMipMaps:9728===t.minFilter||9729===t.minFilter,samplingMode:F._GetTextureSamplingMode(e,t),wrapU:F._GetTextureWrapMode(`${e}/wrapS`,t.wrapS),wrapV:F._GetTextureWrapMode(`${e}/wrapT`,t.wrapT)}),t._data}loadImageAsync(e,t){if(!t._data){if(this.logOpen(`${e} ${t.name||""}`),t.uri)t._data=this.loadUriAsync(`${e}/uri`,t,t.uri);else{let r=P.Get(`${e}/bufferView`,this._gltf.bufferViews,t.bufferView);t._data=this.loadBufferViewAsync(`/bufferViews/${r.index}`,r)}this.logClose()}return t._data}loadUriAsync(e,t,r){let s=this._extensionsLoadUriAsync(e,t,r);if(s)return s;if(!F._ValidateUri(r))throw Error(`${e}: '${r}' is invalid`);if((0,j.IsBase64DataUrl)(r)){let t=new Uint8Array((0,j.DecodeBase64UrlToBinary)(r));return this.log(`${e}: Decoded ${r.substr(0,64)}... (${t.length} bytes)`),Promise.resolve(t)}return this.log(`${e}: Loading ${r}`),this._parent.preprocessUrlAsync(this._rootUrl+r).then(t=>new Promise((s,n)=>{this._parent._loadFile(this._babylonScene,t,t=>{this._disposed||(this.log(`${e}: Loaded ${r} (${t.byteLength} bytes)`),s(new Uint8Array(t)))},!0,t=>{n(new j.LoadFileError(`${e}: Failed to load '${r}'${t?": "+t.status+" "+t.statusText:""}`,t))})}))}static AddPointerMetadata(e,t){e.metadata=e.metadata||{};let r=e._internalMetadata=e._internalMetadata||{},s=r.gltf=r.gltf||{};(s.pointers=s.pointers||[]).push(t)}static _GetTextureWrapMode(e,t){switch(t=void 0==t?10497:t){case 33071:return f.Texture.CLAMP_ADDRESSMODE;case 33648:return f.Texture.MIRROR_ADDRESSMODE;case 10497:return f.Texture.WRAP_ADDRESSMODE;default:return(0,E.Logger).Warn(`${e}: Invalid value (${t})`),f.Texture.WRAP_ADDRESSMODE}}static _GetTextureSamplingMode(e,t){let r=void 0==t.magFilter?9729:t.magFilter,s=void 0==t.minFilter?9987:t.minFilter;if(9729===r)switch(s){case 9728:return f.Texture.LINEAR_NEAREST;case 9729:return f.Texture.LINEAR_LINEAR;case 9984:return f.Texture.LINEAR_NEAREST_MIPNEAREST;case 9985:return f.Texture.LINEAR_LINEAR_MIPNEAREST;case 9986:return f.Texture.LINEAR_NEAREST_MIPLINEAR;case 9987:return f.Texture.LINEAR_LINEAR_MIPLINEAR;default:return(0,E.Logger).Warn(`${e}/minFilter: Invalid value (${s})`),f.Texture.LINEAR_LINEAR_MIPLINEAR}else switch(9728!==r&&(0,E.Logger).Warn(`${e}/magFilter: Invalid value (${r})`),s){case 9728:return f.Texture.NEAREST_NEAREST;case 9729:return f.Texture.NEAREST_LINEAR;case 9984:return f.Texture.NEAREST_NEAREST_MIPNEAREST;case 9985:return f.Texture.NEAREST_LINEAR_MIPNEAREST;case 9986:return f.Texture.NEAREST_NEAREST_MIPLINEAR;case 9987:return f.Texture.NEAREST_LINEAR_MIPLINEAR;default:return(0,E.Logger).Warn(`${e}/minFilter: Invalid value (${s})`),f.Texture.NEAREST_NEAREST_MIPNEAREST}}static _GetTypedArrayConstructor(e,t){switch(t){case 5120:return Int8Array;case 5121:return Uint8Array;case 5122:return Int16Array;case 5123:return Uint16Array;case 5125:return Uint32Array;case 5126:return Float32Array;default:throw Error(`${e}: Invalid component type ${t}`)}}static _GetTypedArray(e,t,r,s,n){let a=r.buffer;s=r.byteOffset+(s||0);let o=F._GetTypedArrayConstructor(`${e}/componentType`,t),i=(0,b.VertexBuffer).GetTypeByteLength(t);return s%i!=0?((0,E.Logger).Warn(`${e}: Copying buffer as byte offset (${s}) is not a multiple of component type byte length (${i})`),new o(a.slice(s,s+n*i),0)):new o(a,s,n)}static _GetNumComponents(e,t){switch(t){case"SCALAR":return 1;case"VEC2":return 2;case"VEC3":return 3;case"VEC4":case"MAT2":return 4;case"MAT3":return 9;case"MAT4":return 16}throw Error(`${e}: Invalid type (${t})`)}static _ValidateUri(e){return(0,i.Tools).IsBase64(e)||-1===e.indexOf("..")}static _GetDrawMode(e,t){switch(void 0==t&&(t=4),t){case 0:return p.Material.PointListDrawMode;case 1:return p.Material.LineListDrawMode;case 2:return p.Material.LineLoopDrawMode;case 3:return p.Material.LineStripDrawMode;case 4:return p.Material.TriangleFillMode;case 5:return p.Material.TriangleStripDrawMode;case 6:return p.Material.TriangleFanDrawMode}throw Error(`${e}: Invalid mesh primitive mode (${t})`)}_compileMaterialsAsync(){this._parent._startPerformanceCounter("Compile materials");let e=[];if(this._gltf.materials){for(let t of this._gltf.materials)if(t._data)for(let r in t._data){let s=t._data[r];for(let t of s.babylonMeshes){t.computeWorldMatrix(!0);let r=s.babylonMaterial;e.push(r.forceCompilationAsync(t)),e.push(r.forceCompilationAsync(t,{useInstances:!0})),this._parent.useClipPlane&&(e.push(r.forceCompilationAsync(t,{clipPlane:!0})),e.push(r.forceCompilationAsync(t,{clipPlane:!0,useInstances:!0})))}}}return Promise.all(e).then(()=>{this._parent._endPerformanceCounter("Compile materials")})}_compileShadowGeneratorsAsync(){this._parent._startPerformanceCounter("Compile shadow generators");let e=[];for(let t of this._babylonScene.lights){let r=t.getShadowGenerator();r&&e.push(r.forceCompilationAsync())}return Promise.all(e).then(()=>{this._parent._endPerformanceCounter("Compile shadow generators")})}_forEachExtensions(e){for(let t of this._extensions)t.enabled&&e(t)}_applyExtensions(e,t,r){for(let s of this._extensions)if(s.enabled){let n=`${s.name}.${t}`;e._activeLoaderExtensionFunctions=e._activeLoaderExtensionFunctions||{};let a=e._activeLoaderExtensionFunctions;if(!a[n]){a[n]=!0;try{let e=r(s);if(e)return e}finally{delete a[n]}}}return null}_extensionsOnLoading(){this._forEachExtensions(e=>e.onLoading&&e.onLoading())}_extensionsOnReady(){this._forEachExtensions(e=>e.onReady&&e.onReady())}_extensionsLoadSceneAsync(e,t){return this._applyExtensions(t,"loadScene",r=>r.loadSceneAsync&&r.loadSceneAsync(e,t))}_extensionsLoadNodeAsync(e,t,r){return this._applyExtensions(t,"loadNode",s=>s.loadNodeAsync&&s.loadNodeAsync(e,t,r))}_extensionsLoadCameraAsync(e,t,r){return this._applyExtensions(t,"loadCamera",s=>s.loadCameraAsync&&s.loadCameraAsync(e,t,r))}_extensionsLoadVertexDataAsync(e,t,r){return this._applyExtensions(t,"loadVertexData",s=>s._loadVertexDataAsync&&s._loadVertexDataAsync(e,t,r))}_extensionsLoadMeshPrimitiveAsync(e,t,r,s,n,a){return this._applyExtensions(n,"loadMeshPrimitive",o=>o._loadMeshPrimitiveAsync&&o._loadMeshPrimitiveAsync(e,t,r,s,n,a))}_extensionsLoadMaterialAsync(e,t,r,s,n){return this._applyExtensions(t,"loadMaterial",a=>a._loadMaterialAsync&&a._loadMaterialAsync(e,t,r,s,n))}_extensionsCreateMaterial(e,t,r){return this._applyExtensions(t,"createMaterial",s=>s.createMaterial&&s.createMaterial(e,t,r))}_extensionsLoadMaterialPropertiesAsync(e,t,r){return this._applyExtensions(t,"loadMaterialProperties",s=>s.loadMaterialPropertiesAsync&&s.loadMaterialPropertiesAsync(e,t,r))}_extensionsLoadTextureInfoAsync(e,t,r){return this._applyExtensions(t,"loadTextureInfo",s=>s.loadTextureInfoAsync&&s.loadTextureInfoAsync(e,t,r))}_extensionsLoadTextureAsync(e,t,r){return this._applyExtensions(t,"loadTexture",s=>s._loadTextureAsync&&s._loadTextureAsync(e,t,r))}_extensionsLoadAnimationAsync(e,t){return this._applyExtensions(t,"loadAnimation",r=>r.loadAnimationAsync&&r.loadAnimationAsync(e,t))}_extensionsLoadAnimationChannelAsync(e,t,r,s,n){return this._applyExtensions(r,"loadAnimationChannel",a=>a._loadAnimationChannelAsync&&a._loadAnimationChannelAsync(e,t,r,s,n))}_extensionsLoadSkinAsync(e,t,r){return this._applyExtensions(r,"loadSkin",s=>s._loadSkinAsync&&s._loadSkinAsync(e,t,r))}_extensionsLoadUriAsync(e,t,r){return this._applyExtensions(t,"loadUri",s=>s._loadUriAsync&&s._loadUriAsync(e,t,r))}_extensionsLoadBufferViewAsync(e,t){return this._applyExtensions(t,"loadBufferView",r=>r.loadBufferViewAsync&&r.loadBufferViewAsync(e,t))}_extensionsLoadBufferAsync(e,t,r,s){return this._applyExtensions(t,"loadBuffer",n=>n.loadBufferAsync&&n.loadBufferAsync(e,t,r,s))}static LoadExtensionAsync(e,t,r,s){if(!t.extensions)return null;let n=t.extensions[r];return n?s(`${e}/extensions/${r}`,n):null}static LoadExtraAsync(e,t,r,s){if(!t.extras)return null;let n=t.extras[r];return n?s(`${e}/extras/${r}`,n):null}isExtensionUsed(e){return!!this._gltf.extensionsUsed&&-1!==this._gltf.extensionsUsed.indexOf(e)}logOpen(e){this._parent._logOpen(e)}logClose(){this._parent._logClose()}log(e){this._parent._log(e)}startPerformanceCounter(e){this._parent._startPerformanceCounter(e)}endPerformanceCounter(e){this._parent._endPerformanceCounter(e)}}F._RegisteredExtensions={},F.DefaultSampler={index:-1},M.GLTFFileLoader._CreateGLTF2Loader=e=>new F(e)},{"@babylonjs/core/Misc/deferred.js":"cceve","@babylonjs/core/Maths/math.vector.js":"h33gd","@babylonjs/core/Maths/math.color.js":"78my4","@babylonjs/core/Misc/tools.js":"ieufJ","@babylonjs/core/Cameras/camera.js":"467SK","@babylonjs/core/Cameras/freeCamera.js":"5Dwi7","@babylonjs/core/Animations/animationKey.js":"2xcni","@babylonjs/core/Animations/animationGroup.js":"ilhgI","@babylonjs/core/Bones/bone.js":"4de78","@babylonjs/core/Bones/skeleton.js":"gq1Mh","@babylonjs/core/Materials/material.js":"b0eUV","@babylonjs/core/Materials/PBR/pbrMaterial.js":"3wOWA","@babylonjs/core/Materials/Textures/texture.js":"bYxw8","@babylonjs/core/Meshes/transformNode.js":"3jk7X","@babylonjs/core/Buffers/buffer.js":"aDZlT","@babylonjs/core/Meshes/geometry.js":"lnjEm","@babylonjs/core/Meshes/abstractMesh.js":"jf0Op","@babylonjs/core/Meshes/mesh.js":"9vBao","@babylonjs/core/Morph/morphTarget.js":"cq84D","@babylonjs/core/Morph/morphTargetManager.js":"jwka7","../glTFFileLoader.js":"GX9kb","@babylonjs/core/Misc/fileTools.js":"cF4Gd","@babylonjs/core/Misc/logger.js":"5C8M2","@babylonjs/core/Culling/boundingInfo.js":"38KwI","./glTFLoaderAnimation.js":"3rmfu","@parcel/transformer-js/src/esmodule-helpers.js":"XTfsy"}],"3rmfu":[function(e,t,r){var s=e("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(r),s.export(r,"getVector3",()=>o),s.export(r,"getQuaternion",()=>i),s.export(r,"getWeights",()=>l),s.export(r,"AnimationPropertyInfo",()=>c),s.export(r,"TransformNodeAnimationPropertyInfo",()=>d),s.export(r,"WeightAnimationPropertyInfo",()=>h),s.export(r,"nodeAnimationData",()=>u);var n=e("@babylonjs/core/Animations/animation.js"),a=e("@babylonjs/core/Maths/math.vector.js");function o(e,t,r,s){return(0,a.Vector3).FromArray(t,r).scaleInPlace(s)}function i(e,t,r,s){return(0,a.Quaternion).FromArray(t,r).scaleInPlace(s)}function l(e,t,r,s){let n=Array(e._numMorphTargets);for(let e=0;e<n.length;e++)n[e]=t[r++]*s;return n}class c{constructor(e,t,r,s){this.type=e,this.name=t,this.getValue=r,this.getStride=s}_buildAnimation(e,t,r){let s=new n.Animation(e,this.name,t,this.type);return s.setKeys(r),s}}class d extends c{buildAnimations(e,t,r,s,n){n(e._babylonTransformNode,this._buildAnimation(t,r,s))}}class h extends c{buildAnimations(e,t,r,s,a){if(e._numMorphTargets)for(let o=0;o<e._numMorphTargets;o++){let i=new n.Animation(`${t}_${o}`,this.name,r,this.type);if(i.setKeys(s.map(e=>({frame:e.frame,inTangent:e.inTangent?e.inTangent[o]:void 0,value:e.value[o],outTangent:e.outTangent?e.outTangent[o]:void 0,interpolation:e.interpolation}))),e._primitiveBabylonMeshes){for(let t of e._primitiveBabylonMeshes)if(t.morphTargetManager){let e=t.morphTargetManager.getTarget(o),r=i.clone();e.animations.push(r),a(e,r)}}}}}let u={translation:[new d(n.Animation.ANIMATIONTYPE_VECTOR3,"position",o,()=>3)],rotation:[new d(n.Animation.ANIMATIONTYPE_QUATERNION,"rotationQuaternion",i,()=>4)],scale:[new d(n.Animation.ANIMATIONTYPE_VECTOR3,"scaling",o,()=>3)],weights:[new h(n.Animation.ANIMATIONTYPE_FLOAT,"influence",l,e=>e._numMorphTargets)]}},{"@babylonjs/core/Animations/animation.js":"aeJ0l","@babylonjs/core/Maths/math.vector.js":"h33gd","@parcel/transformer-js/src/esmodule-helpers.js":"XTfsy"}],"8nluN":[function(e,t,r){e("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(r)},{"@parcel/transformer-js/src/esmodule-helpers.js":"XTfsy"}],RWLbc:[function(e,t,r){e("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(r)},{"@parcel/transformer-js/src/esmodule-helpers.js":"XTfsy"}],eRnTs:[function(e,t,r){var s=e("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(r);var n=e("./EXT_lights_image_based.js");s.exportAll(n,r);var a=e("./EXT_mesh_gpu_instancing.js");s.exportAll(a,r);var o=e("./EXT_meshopt_compression.js");s.exportAll(o,r);var i=e("./EXT_texture_webp.js");s.exportAll(i,r);var l=e("./KHR_draco_mesh_compression.js");s.exportAll(l,r);var c=e("./KHR_lights_punctual.js");s.exportAll(c,r);var d=e("./KHR_materials_pbrSpecularGlossiness.js");s.exportAll(d,r);var h=e("./KHR_materials_unlit.js");s.exportAll(h,r);var u=e("./KHR_materials_clearcoat.js");s.exportAll(u,r);var _=e("./KHR_materials_iridescence.js");s.exportAll(_,r);var p=e("./KHR_materials_anisotropy.js");s.exportAll(p,r);var m=e("./KHR_materials_emissive_strength.js");s.exportAll(m,r);var f=e("./KHR_materials_sheen.js");s.exportAll(f,r);var y=e("./KHR_materials_specular.js");s.exportAll(y,r);var b=e("./KHR_materials_ior.js");s.exportAll(b,r);var g=e("./KHR_materials_variants.js");s.exportAll(g,r);var T=e("./KHR_materials_transmission.js");s.exportAll(T,r);var A=e("./KHR_materials_translucency.js");s.exportAll(A,r);var x=e("./KHR_materials_volume.js");s.exportAll(x,r);var v=e("./KHR_materials_dispersion.js");s.exportAll(v,r);var M=e("./KHR_mesh_quantization.js");s.exportAll(M,r);var j=e("./KHR_texture_basisu.js");s.exportAll(j,r);var E=e("./KHR_texture_transform.js");s.exportAll(E,r);var L=e("./KHR_xmp_json_ld.js");s.exportAll(L,r);var C=e("./KHR_animation_pointer.js");s.exportAll(C,r);var P=e("./MSFT_audio_emitter.js");s.exportAll(P,r);var F=e("./MSFT_lod.js");s.exportAll(F,r);var S=e("./MSFT_minecraftMesh.js");s.exportAll(S,r);var w=e("./MSFT_sRGBFactors.js");s.exportAll(w,r);var O=e("./KHR_interactivity.js");s.exportAll(O,r);var R=e("./ExtrasAsMetadata.js");s.exportAll(R,r)},{"./EXT_lights_image_based.js":"6pr0c","./EXT_mesh_gpu_instancing.js":"eK2PZ","./EXT_meshopt_compression.js":"jvEfZ","./EXT_texture_webp.js":"lh4C4","./KHR_draco_mesh_compression.js":"cvMeU","./KHR_lights_punctual.js":"jwdAu","./KHR_materials_pbrSpecularGlossiness.js":"koLT0","./KHR_materials_unlit.js":"49OYE","./KHR_materials_clearcoat.js":"fGYu8","./KHR_materials_iridescence.js":"a2HiQ","./KHR_materials_anisotropy.js":"8ab8j","./KHR_materials_emissive_strength.js":"cIp9S","./KHR_materials_sheen.js":"g5Rq3","./KHR_materials_specular.js":"1TONr","./KHR_materials_ior.js":"bnBX6","./KHR_materials_variants.js":"fb7Cl","./KHR_materials_transmission.js":"icJBJ","./KHR_materials_translucency.js":"2bI90","./KHR_materials_volume.js":"cQOgc","./KHR_materials_dispersion.js":"8W8DE","./KHR_mesh_quantization.js":"3N7Mu","./KHR_texture_basisu.js":"gy9Ea","./KHR_texture_transform.js":"a8Aai","./KHR_xmp_json_ld.js":"8ucaF","./KHR_animation_pointer.js":"d4S7R","./MSFT_audio_emitter.js":"br9T4","./MSFT_lod.js":"jiyCf","./MSFT_minecraftMesh.js":"bxMkM","./MSFT_sRGBFactors.js":"lyqob","./KHR_interactivity.js":"bNByP","./ExtrasAsMetadata.js":"4HJMs","@parcel/transformer-js/src/esmodule-helpers.js":"XTfsy"}],"6pr0c":[function(e,t,r){var s=e("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(r),s.export(r,"EXT_lights_image_based",()=>d);var n=e("@babylonjs/core/Maths/math.scalar.js"),a=e("@babylonjs/core/Maths/sphericalPolynomial.js"),o=e("@babylonjs/core/Maths/math.vector.js"),i=e("@babylonjs/core/Materials/Textures/rawCubeTexture.js"),l=e("../glTFLoader.js");let c="EXT_lights_image_based";class d{constructor(e){this.name=c,this._loader=e,this.enabled=this._loader.isExtensionUsed(c)}dispose(){this._loader=null,delete this._lights}onLoading(){let e=this._loader.gltf.extensions;if(e&&e[this.name]){let t=e[this.name];this._lights=t.lights}}loadSceneAsync(e,t){return(0,l.GLTFLoader).LoadExtensionAsync(e,t,this.name,(r,s)=>{this._loader._allMaterialsDirtyRequired=!0;let n=[];n.push(this._loader.loadSceneAsync(e,t)),this._loader.logOpen(`${r}`);let a=(0,l.ArrayItem).Get(`${r}/light`,this._lights,s.light);return n.push(this._loadLightAsync(`/extensions/${this.name}/lights/${s.light}`,a).then(e=>{this._loader.babylonScene.environmentTexture=e})),this._loader.logClose(),Promise.all(n).then(()=>{})})}_loadLightAsync(e,t){if(!t._loaded){let r=[];this._loader.logOpen(`${e}`);let s=Array(t.specularImages.length);for(let n=0;n<t.specularImages.length;n++){let a=t.specularImages[n];s[n]=Array(a.length);for(let t=0;t<a.length;t++){let o=`${e}/specularImages/${n}/${t}`;this._loader.logOpen(`${o}`);let i=a[t],c=(0,l.ArrayItem).Get(o,this._loader.gltf.images,i);r.push(this._loader.loadImageAsync(`/images/${i}`,c).then(e=>{s[n][t]=e})),this._loader.logClose()}}this._loader.logClose(),t._loaded=Promise.all(r).then(()=>{let r=new i.RawCubeTexture(this._loader.babylonScene,null,t.specularImageSize);if(r.name=t.name||"environment",t._babylonTexture=r,void 0!=t.intensity&&(r.level=t.intensity),t.rotation){let e=(0,o.Quaternion).FromArray(t.rotation);this._loader.babylonScene.useRightHandedSystem||(e=(0,o.Quaternion).Inverse(e)),(0,o.Matrix).FromQuaternionToRef(e,r.getReflectionTextureMatrix())}if(!t.irradianceCoefficients)throw Error(`${e}: Irradiance coefficients are missing`);let l=(0,a.SphericalHarmonics).FromArray(t.irradianceCoefficients);l.scaleInPlace(t.intensity),l.convertIrradianceToLambertianRadiance();let c=(0,a.SphericalPolynomial).FromHarmonics(l),d=(s.length-1)/(0,n.Scalar).Log2(t.specularImageSize);return r.updateRGBDAsync(s,c,d)})}return t._loaded.then(()=>t._babylonTexture)}}(0,l.GLTFLoader).RegisterExtension(c,e=>new d(e))},{"@babylonjs/core/Maths/math.scalar.js":"aWK9a","@babylonjs/core/Maths/sphericalPolynomial.js":"2Xm7l","@babylonjs/core/Maths/math.vector.js":"h33gd","@babylonjs/core/Materials/Textures/rawCubeTexture.js":"l0iMW","../glTFLoader.js":"lHQW2","@parcel/transformer-js/src/esmodule-helpers.js":"XTfsy"}],eK2PZ:[function(e,t,r){var s=e("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(r),s.export(r,"EXT_mesh_gpu_instancing",()=>i);var n=e("@babylonjs/core/Maths/math.vector.js"),a=e("../glTFLoader.js");e("@babylonjs/core/Meshes/thinInstanceMesh.js");let o="EXT_mesh_gpu_instancing";class i{constructor(e){this.name=o,this._loader=e,this.enabled=this._loader.isExtensionUsed(o)}dispose(){this._loader=null}loadNodeAsync(e,t,r){return(0,a.GLTFLoader).LoadExtensionAsync(e,t,this.name,(e,s)=>{this._loader._disableInstancedMesh++;let o=this._loader.loadNodeAsync(`/nodes/${t.index}`,t,r);if(this._loader._disableInstancedMesh--,!t._primitiveBabylonMeshes)return o;let i=[],l=0,c=t=>{if(void 0==s.attributes[t]){i.push(Promise.resolve(null));return}let r=(0,a.ArrayItem).Get(`${e}/attributes/${t}`,this._loader.gltf.accessors,s.attributes[t]);if(i.push(this._loader._loadFloatAccessorAsync(`/accessors/${r.bufferView}`,r)),0===l)l=r.count;else if(l!==r.count)throw Error(`${e}/attributes: Instance buffer accessors do not have the same count.`)};return c("TRANSLATION"),c("ROTATION"),c("SCALE"),o.then(e=>Promise.all(i).then(([r,s,a])=>{let o=new Float32Array(16*l);(0,n.TmpVectors).Vector3[0].copyFromFloats(0,0,0),(0,n.TmpVectors).Quaternion[0].copyFromFloats(0,0,0,1),(0,n.TmpVectors).Vector3[1].copyFromFloats(1,1,1);for(let e=0;e<l;++e)r&&(0,n.Vector3).FromArrayToRef(r,3*e,n.TmpVectors.Vector3[0]),s&&(0,n.Quaternion).FromArrayToRef(s,4*e,n.TmpVectors.Quaternion[0]),a&&(0,n.Vector3).FromArrayToRef(a,3*e,n.TmpVectors.Vector3[1]),(0,n.Matrix).ComposeToRef(n.TmpVectors.Vector3[1],n.TmpVectors.Quaternion[0],n.TmpVectors.Vector3[0],n.TmpVectors.Matrix[0]),(0,n.TmpVectors).Matrix[0].copyToArray(o,16*e);for(let e of t._primitiveBabylonMeshes)e.thinInstanceSetBuffer("matrix",o,16,!0);return e}))})}}(0,a.GLTFLoader).RegisterExtension(o,e=>new i(e))},{"@babylonjs/core/Maths/math.vector.js":"h33gd","../glTFLoader.js":"lHQW2","@babylonjs/core/Meshes/thinInstanceMesh.js":"i7EXT","@parcel/transformer-js/src/esmodule-helpers.js":"XTfsy"}],jvEfZ:[function(e,t,r){var s=e("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(r),s.export(r,"EXT_meshopt_compression",()=>i);var n=e("../glTFLoader.js"),a=e("@babylonjs/core/Meshes/Compression/meshoptCompression.js");let o="EXT_meshopt_compression";class i{constructor(e){this.name=o,this.enabled=e.isExtensionUsed(o),this._loader=e}dispose(){this._loader=null}loadBufferViewAsync(e,t){return(0,n.GLTFLoader).LoadExtensionAsync(e,t,this.name,(r,s)=>{if(t._meshOptData)return t._meshOptData;let o=(0,n.ArrayItem).Get(`${e}/buffer`,this._loader.gltf.buffers,s.buffer);return t._meshOptData=this._loader.loadBufferAsync(`/buffers/${o.index}`,o,s.byteOffset||0,s.byteLength).then(e=>(0,a.MeshoptCompression).Default.decodeGltfBufferAsync(e,s.count,s.byteStride,s.mode,s.filter)),t._meshOptData})}}(0,n.GLTFLoader).RegisterExtension(o,e=>new i(e))},{"../glTFLoader.js":"lHQW2","@babylonjs/core/Meshes/Compression/meshoptCompression.js":"jS66H","@parcel/transformer-js/src/esmodule-helpers.js":"XTfsy"}],lh4C4:[function(e,t,r){var s=e("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(r),s.export(r,"EXT_texture_webp",()=>o);var n=e("../glTFLoader.js");let a="EXT_texture_webp";class o{constructor(e){this.name=a,this._loader=e,this.enabled=e.isExtensionUsed(a)}dispose(){this._loader=null}_loadTextureAsync(e,t,r){return(0,n.GLTFLoader).LoadExtensionAsync(e,t,this.name,(s,a)=>{let o=void 0==t.sampler?n.GLTFLoader.DefaultSampler:(0,n.ArrayItem).Get(`${e}/sampler`,this._loader.gltf.samplers,t.sampler),i=(0,n.ArrayItem).Get(`${s}/source`,this._loader.gltf.images,a.source);return this._loader._createTextureAsync(e,o,i,e=>{r(e)},void 0,!t._textureInfo.nonColorData)})}}(0,n.GLTFLoader).RegisterExtension(a,e=>new o(e))},{"../glTFLoader.js":"lHQW2","@parcel/transformer-js/src/esmodule-helpers.js":"XTfsy"}],cvMeU:[function(e,t,r){var s=e("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(r),s.export(r,"KHR_draco_mesh_compression",()=>l);var n=e("@babylonjs/core/Meshes/Compression/dracoCompression.js"),a=e("@babylonjs/core/Buffers/buffer.js"),o=e("../glTFLoader.js");let i="KHR_draco_mesh_compression";class l{constructor(e){this.name=i,this.useNormalizedFlagFromAccessor=!0,this._loader=e,this.enabled=n.DracoCompression.DecoderAvailable&&this._loader.isExtensionUsed(i)}dispose(){delete this.dracoCompression,this._loader=null}_loadVertexDataAsync(e,t,r){return(0,o.GLTFLoader).LoadExtensionAsync(e,t,this.name,(s,i)=>{if(void 0!=t.mode&&4!==t.mode&&5!==t.mode)throw Error(`${e}: Unsupported mode ${t.mode}`);let l={},c={},d=(e,s)=>{let n=i.attributes[e];if(void 0!=n&&(r._delayInfo=r._delayInfo||[],-1===r._delayInfo.indexOf(s)&&r._delayInfo.push(s),l[s]=n,this.useNormalizedFlagFromAccessor)){let r=(0,o.ArrayItem).TryGet(this._loader.gltf.accessors,t.attributes[e]);r&&(c[s]=r.normalized||!1)}};d("POSITION",a.VertexBuffer.PositionKind),d("NORMAL",a.VertexBuffer.NormalKind),d("TANGENT",a.VertexBuffer.TangentKind),d("TEXCOORD_0",a.VertexBuffer.UVKind),d("TEXCOORD_1",a.VertexBuffer.UV2Kind),d("TEXCOORD_2",a.VertexBuffer.UV3Kind),d("TEXCOORD_3",a.VertexBuffer.UV4Kind),d("TEXCOORD_4",a.VertexBuffer.UV5Kind),d("TEXCOORD_5",a.VertexBuffer.UV6Kind),d("JOINTS_0",a.VertexBuffer.MatricesIndicesKind),d("WEIGHTS_0",a.VertexBuffer.MatricesWeightsKind),d("COLOR_0",a.VertexBuffer.ColorKind);let h=(0,o.ArrayItem).Get(s,this._loader.gltf.bufferViews,i.bufferView);return h._dracoBabylonGeometry||(h._dracoBabylonGeometry=this._loader.loadBufferViewAsync(`/bufferViews/${h.index}`,h).then(t=>(this.dracoCompression||n.DracoCompression.Default)._decodeMeshToGeometryForGltfAsync(r.name,this._loader.babylonScene,t,l,c).catch(t=>{throw Error(`${e}: ${t.message}`)}))),h._dracoBabylonGeometry})}}(0,o.GLTFLoader).RegisterExtension(i,e=>new l(e))},{"@babylonjs/core/Meshes/Compression/dracoCompression.js":"h6U9u","@babylonjs/core/Buffers/buffer.js":"aDZlT","../glTFLoader.js":"lHQW2","@parcel/transformer-js/src/esmodule-helpers.js":"XTfsy"}],jwdAu:[function(e,t,r){var s=e("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(r),s.export(r,"KHR_lights",()=>u);var n=e("@babylonjs/core/Maths/math.vector.js"),a=e("@babylonjs/core/Maths/math.color.js"),o=e("@babylonjs/core/Lights/directionalLight.js"),i=e("@babylonjs/core/Lights/pointLight.js"),l=e("@babylonjs/core/Lights/spotLight.js"),c=e("@babylonjs/core/Lights/light.js"),d=e("../glTFLoader.js");let h="KHR_lights_punctual";class u{constructor(e){this.name=h,this._loader=e,this.enabled=this._loader.isExtensionUsed(h)}dispose(){this._loader=null,delete this._lights}onLoading(){let e=this._loader.gltf.extensions;if(e&&e[this.name]){let t=e[this.name];this._lights=t.lights,(0,d.ArrayItem).Assign(this._lights)}}loadNodeAsync(e,t,r){return(0,d.GLTFLoader).LoadExtensionAsync(e,t,this.name,(s,h)=>(this._loader._allMaterialsDirtyRequired=!0,this._loader.loadNodeAsync(e,t,e=>{let t;let u=(0,d.ArrayItem).Get(s,this._lights,h.light),_=u.name||e.name;switch(this._loader.babylonScene._blockEntityCollection=!!this._loader._assetContainer,u.type){case"directional":{let e=new o.DirectionalLight(_,(0,n.Vector3).Backward(),this._loader.babylonScene);e.position.setAll(0),t=e;break}case"point":t=new i.PointLight(_,(0,n.Vector3).Zero(),this._loader.babylonScene);break;case"spot":{let e=new l.SpotLight(_,(0,n.Vector3).Zero(),(0,n.Vector3).Backward(),0,1,this._loader.babylonScene);e.angle=2*(u.spot&&u.spot.outerConeAngle||Math.PI/4),e.innerAngle=2*(u.spot&&u.spot.innerConeAngle||0),t=e;break}default:throw this._loader.babylonScene._blockEntityCollection=!1,Error(`${s}: Invalid light type (${u.type})`)}t._parentContainer=this._loader._assetContainer,this._loader.babylonScene._blockEntityCollection=!1,u._babylonLight=t,t.falloffType=c.Light.FALLOFF_GLTF,t.diffuse=u.color?(0,a.Color3).FromArray(u.color):(0,a.Color3).White(),t.intensity=void 0==u.intensity?1:u.intensity,t.range=void 0==u.range?Number.MAX_VALUE:u.range,t.parent=e,this._loader._babylonLights.push(t),(0,d.GLTFLoader).AddPointerMetadata(t,s),r(e)})))}}(0,d.GLTFLoader).RegisterExtension(h,e=>new u(e))},{"@babylonjs/core/Maths/math.vector.js":"h33gd","@babylonjs/core/Maths/math.color.js":"78my4","@babylonjs/core/Lights/directionalLight.js":"ed05w","@babylonjs/core/Lights/pointLight.js":"iBNs0","@babylonjs/core/Lights/spotLight.js":"kOHa2","@babylonjs/core/Lights/light.js":"jIPhj","../glTFLoader.js":"lHQW2","@parcel/transformer-js/src/esmodule-helpers.js":"XTfsy"}],koLT0:[function(e,t,r){var s=e("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(r),s.export(r,"KHR_materials_pbrSpecularGlossiness",()=>l);var n=e("@babylonjs/core/Maths/math.color.js"),a=e("@babylonjs/core/Materials/PBR/pbrMaterial.js"),o=e("../glTFLoader.js");let i="KHR_materials_pbrSpecularGlossiness";class l{constructor(e){this.name=i,this.order=200,this._loader=e,this.enabled=this._loader.isExtensionUsed(i)}dispose(){this._loader=null}loadMaterialPropertiesAsync(e,t,r){return(0,o.GLTFLoader).LoadExtensionAsync(e,t,this.name,(s,n)=>{let a=[];return a.push(this._loader.loadMaterialBasePropertiesAsync(e,t,r)),a.push(this._loadSpecularGlossinessPropertiesAsync(s,n,r)),this._loader.loadMaterialAlphaProperties(e,t,r),Promise.all(a).then(()=>{})})}_loadSpecularGlossinessPropertiesAsync(e,t,r){if(!(r instanceof a.PBRMaterial))throw Error(`${e}: Material type not supported`);let s=[];return r.metallic=null,r.roughness=null,t.diffuseFactor?(r.albedoColor=(0,n.Color3).FromArray(t.diffuseFactor),r.alpha=t.diffuseFactor[3]):r.albedoColor=(0,n.Color3).White(),r.reflectivityColor=t.specularFactor?(0,n.Color3).FromArray(t.specularFactor):(0,n.Color3).White(),r.microSurface=void 0==t.glossinessFactor?1:t.glossinessFactor,t.diffuseTexture&&s.push(this._loader.loadTextureInfoAsync(`${e}/diffuseTexture`,t.diffuseTexture,e=>{e.name=`${r.name} (Diffuse)`,r.albedoTexture=e})),t.specularGlossinessTexture&&(s.push(this._loader.loadTextureInfoAsync(`${e}/specularGlossinessTexture`,t.specularGlossinessTexture,e=>{e.name=`${r.name} (Specular Glossiness)`,r.reflectivityTexture=e,r.reflectivityTexture.hasAlpha=!0})),r.useMicroSurfaceFromReflectivityMapAlpha=!0),Promise.all(s).then(()=>{})}}(0,o.GLTFLoader).RegisterExtension(i,e=>new l(e))},{"@babylonjs/core/Maths/math.color.js":"78my4","@babylonjs/core/Materials/PBR/pbrMaterial.js":"3wOWA","../glTFLoader.js":"lHQW2","@parcel/transformer-js/src/esmodule-helpers.js":"XTfsy"}],"49OYE":[function(e,t,r){var s=e("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(r),s.export(r,"KHR_materials_unlit",()=>l);var n=e("@babylonjs/core/Maths/math.color.js"),a=e("@babylonjs/core/Materials/PBR/pbrMaterial.js"),o=e("../glTFLoader.js");let i="KHR_materials_unlit";class l{constructor(e){this.name=i,this.order=210,this._loader=e,this.enabled=this._loader.isExtensionUsed(i)}dispose(){this._loader=null}loadMaterialPropertiesAsync(e,t,r){return(0,o.GLTFLoader).LoadExtensionAsync(e,t,this.name,()=>this._loadUnlitPropertiesAsync(e,t,r))}_loadUnlitPropertiesAsync(e,t,r){if(!(r instanceof a.PBRMaterial))throw Error(`${e}: Material type not supported`);let s=[];r.unlit=!0;let o=t.pbrMetallicRoughness;return o&&(o.baseColorFactor?(r.albedoColor=(0,n.Color3).FromArray(o.baseColorFactor),r.alpha=o.baseColorFactor[3]):r.albedoColor=(0,n.Color3).White(),o.baseColorTexture&&s.push(this._loader.loadTextureInfoAsync(`${e}/baseColorTexture`,o.baseColorTexture,e=>{e.name=`${r.name} (Base Color)`,r.albedoTexture=e}))),t.doubleSided&&(r.backFaceCulling=!1,r.twoSidedLighting=!0),this._loader.loadMaterialAlphaProperties(e,t,r),Promise.all(s).then(()=>{})}}(0,o.GLTFLoader).RegisterExtension(i,e=>new l(e))},{"@babylonjs/core/Maths/math.color.js":"78my4","@babylonjs/core/Materials/PBR/pbrMaterial.js":"3wOWA","../glTFLoader.js":"lHQW2","@parcel/transformer-js/src/esmodule-helpers.js":"XTfsy"}],fGYu8:[function(e,t,r){var s=e("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(r),s.export(r,"KHR_materials_clearcoat",()=>i);var n=e("@babylonjs/core/Materials/PBR/pbrMaterial.js"),a=e("../glTFLoader.js");let o="KHR_materials_clearcoat";class i{constructor(e){this.name=o,this.order=190,this._loader=e,this.enabled=this._loader.isExtensionUsed(o)}dispose(){this._loader=null}loadMaterialPropertiesAsync(e,t,r){return(0,a.GLTFLoader).LoadExtensionAsync(e,t,this.name,(s,n)=>{let a=[];return a.push(this._loader.loadMaterialPropertiesAsync(e,t,r)),a.push(this._loadClearCoatPropertiesAsync(s,n,r)),Promise.all(a).then(()=>{})})}_loadClearCoatPropertiesAsync(e,t,r){if(!(r instanceof n.PBRMaterial))throw Error(`${e}: Material type not supported`);let s=[];return r.clearCoat.isEnabled=!0,r.clearCoat.useRoughnessFromMainTexture=!1,r.clearCoat.remapF0OnInterfaceChange=!1,void 0!=t.clearcoatFactor?r.clearCoat.intensity=t.clearcoatFactor:r.clearCoat.intensity=0,t.clearcoatTexture&&s.push(this._loader.loadTextureInfoAsync(`${e}/clearcoatTexture`,t.clearcoatTexture,e=>{e.name=`${r.name} (ClearCoat Intensity)`,r.clearCoat.texture=e})),void 0!=t.clearcoatRoughnessFactor?r.clearCoat.roughness=t.clearcoatRoughnessFactor:r.clearCoat.roughness=0,t.clearcoatRoughnessTexture&&(t.clearcoatRoughnessTexture.nonColorData=!0,s.push(this._loader.loadTextureInfoAsync(`${e}/clearcoatRoughnessTexture`,t.clearcoatRoughnessTexture,e=>{e.name=`${r.name} (ClearCoat Roughness)`,r.clearCoat.textureRoughness=e}))),t.clearcoatNormalTexture&&(t.clearcoatNormalTexture.nonColorData=!0,s.push(this._loader.loadTextureInfoAsync(`${e}/clearcoatNormalTexture`,t.clearcoatNormalTexture,e=>{e.name=`${r.name} (ClearCoat Normal)`,r.clearCoat.bumpTexture=e})),r.invertNormalMapX=!r.getScene().useRightHandedSystem,r.invertNormalMapY=r.getScene().useRightHandedSystem,void 0!=t.clearcoatNormalTexture.scale&&(r.clearCoat.bumpTexture.level=t.clearcoatNormalTexture.scale)),Promise.all(s).then(()=>{})}}(0,a.GLTFLoader).RegisterExtension(o,e=>new i(e))},{"@babylonjs/core/Materials/PBR/pbrMaterial.js":"3wOWA","../glTFLoader.js":"lHQW2","@parcel/transformer-js/src/esmodule-helpers.js":"XTfsy"}],a2HiQ:[function(e,t,r){var s=e("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(r),s.export(r,"KHR_materials_iridescence",()=>i);var n=e("@babylonjs/core/Materials/PBR/pbrMaterial.js"),a=e("../glTFLoader.js");let o="KHR_materials_iridescence";class i{constructor(e){this.name=o,this.order=195,this._loader=e,this.enabled=this._loader.isExtensionUsed(o)}dispose(){this._loader=null}loadMaterialPropertiesAsync(e,t,r){return(0,a.GLTFLoader).LoadExtensionAsync(e,t,this.name,(s,n)=>{let a=[];return a.push(this._loader.loadMaterialPropertiesAsync(e,t,r)),a.push(this._loadIridescencePropertiesAsync(s,n,r)),Promise.all(a).then(()=>{})})}_loadIridescencePropertiesAsync(e,t,r){if(!(r instanceof n.PBRMaterial))throw Error(`${e}: Material type not supported`);let s=[];return r.iridescence.isEnabled=!0,r.iridescence.intensity=t.iridescenceFactor??0,r.iridescence.indexOfRefraction=t.iridescenceIor??t.iridescenceIOR??1.3,r.iridescence.minimumThickness=t.iridescenceThicknessMinimum??100,r.iridescence.maximumThickness=t.iridescenceThicknessMaximum??400,t.iridescenceTexture&&s.push(this._loader.loadTextureInfoAsync(`${e}/iridescenceTexture`,t.iridescenceTexture,e=>{e.name=`${r.name} (Iridescence Intensity)`,r.iridescence.texture=e})),t.iridescenceThicknessTexture&&s.push(this._loader.loadTextureInfoAsync(`${e}/iridescenceThicknessTexture`,t.iridescenceThicknessTexture,e=>{e.name=`${r.name} (Iridescence Thickness)`,r.iridescence.thicknessTexture=e})),Promise.all(s).then(()=>{})}}(0,a.GLTFLoader).RegisterExtension(o,e=>new i(e))},{"@babylonjs/core/Materials/PBR/pbrMaterial.js":"3wOWA","../glTFLoader.js":"lHQW2","@parcel/transformer-js/src/esmodule-helpers.js":"XTfsy"}],"8ab8j":[function(e,t,r){var s=e("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(r),s.export(r,"KHR_materials_anisotropy",()=>i);var n=e("@babylonjs/core/Materials/PBR/pbrMaterial.js"),a=e("../glTFLoader.js");let o="KHR_materials_anisotropy";class i{constructor(e){this.name=o,this.order=195,this._loader=e,this.enabled=this._loader.isExtensionUsed(o)}dispose(){this._loader=null}loadMaterialPropertiesAsync(e,t,r){return(0,a.GLTFLoader).LoadExtensionAsync(e,t,this.name,(s,n)=>{let a=[];return a.push(this._loader.loadMaterialPropertiesAsync(e,t,r)),a.push(this._loadIridescencePropertiesAsync(s,n,r)),Promise.all(a).then(()=>{})})}_loadIridescencePropertiesAsync(e,t,r){if(!(r instanceof n.PBRMaterial))throw Error(`${e}: Material type not supported`);let s=[];return r.anisotropy.isEnabled=!0,r.anisotropy.intensity=t.anisotropyStrength??0,r.anisotropy.angle=t.anisotropyRotation??0,t.anisotropyTexture&&s.push(this._loader.loadTextureInfoAsync(`${e}/anisotropyTexture`,t.anisotropyTexture,e=>{e.name=`${r.name} (Anisotropy Intensity)`,r.anisotropy.texture=e})),Promise.all(s).then(()=>{})}}(0,a.GLTFLoader).RegisterExtension(o,e=>new i(e))},{"@babylonjs/core/Materials/PBR/pbrMaterial.js":"3wOWA","../glTFLoader.js":"lHQW2","@parcel/transformer-js/src/esmodule-helpers.js":"XTfsy"}],cIp9S:[function(e,t,r){var s=e("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(r),s.export(r,"KHR_materials_emissive_strength",()=>i);var n=e("@babylonjs/core/Materials/PBR/pbrMaterial.js"),a=e("../glTFLoader.js");let o="KHR_materials_emissive_strength";class i{constructor(e){this.name=o,this.order=170,this._loader=e,this.enabled=this._loader.isExtensionUsed(o)}dispose(){this._loader=null}loadMaterialPropertiesAsync(e,t,r){return(0,a.GLTFLoader).LoadExtensionAsync(e,t,this.name,(s,n)=>this._loader.loadMaterialPropertiesAsync(e,t,r).then(()=>{this._loadEmissiveProperties(s,n,r)}))}_loadEmissiveProperties(e,t,r){if(!(r instanceof n.PBRMaterial))throw Error(`${e}: Material type not supported`);void 0!==t.emissiveStrength&&r.emissiveColor.scaleToRef(t.emissiveStrength,r.emissiveColor)}}(0,a.GLTFLoader).RegisterExtension(o,e=>new i(e))},{"@babylonjs/core/Materials/PBR/pbrMaterial.js":"3wOWA","../glTFLoader.js":"lHQW2","@parcel/transformer-js/src/esmodule-helpers.js":"XTfsy"}],g5Rq3:[function(e,t,r){var s=e("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(r),s.export(r,"KHR_materials_sheen",()=>l);var n=e("@babylonjs/core/Materials/PBR/pbrMaterial.js"),a=e("../glTFLoader.js"),o=e("@babylonjs/core/Maths/math.color.js");let i="KHR_materials_sheen";class l{constructor(e){this.name=i,this.order=190,this._loader=e,this.enabled=this._loader.isExtensionUsed(i)}dispose(){this._loader=null}loadMaterialPropertiesAsync(e,t,r){return(0,a.GLTFLoader).LoadExtensionAsync(e,t,this.name,(s,n)=>{let a=[];return a.push(this._loader.loadMaterialPropertiesAsync(e,t,r)),a.push(this._loadSheenPropertiesAsync(s,n,r)),Promise.all(a).then(()=>{})})}_loadSheenPropertiesAsync(e,t,r){if(!(r instanceof n.PBRMaterial))throw Error(`${e}: Material type not supported`);let s=[];return r.sheen.isEnabled=!0,r.sheen.intensity=1,void 0!=t.sheenColorFactor?r.sheen.color=(0,o.Color3).FromArray(t.sheenColorFactor):r.sheen.color=(0,o.Color3).Black(),t.sheenColorTexture&&s.push(this._loader.loadTextureInfoAsync(`${e}/sheenColorTexture`,t.sheenColorTexture,e=>{e.name=`${r.name} (Sheen Color)`,r.sheen.texture=e})),void 0!==t.sheenRoughnessFactor?r.sheen.roughness=t.sheenRoughnessFactor:r.sheen.roughness=0,t.sheenRoughnessTexture&&(t.sheenRoughnessTexture.nonColorData=!0,s.push(this._loader.loadTextureInfoAsync(`${e}/sheenRoughnessTexture`,t.sheenRoughnessTexture,e=>{e.name=`${r.name} (Sheen Roughness)`,r.sheen.textureRoughness=e}))),r.sheen.albedoScaling=!0,r.sheen.useRoughnessFromMainTexture=!1,Promise.all(s).then(()=>{})}}(0,a.GLTFLoader).RegisterExtension(i,e=>new l(e))},{"@babylonjs/core/Materials/PBR/pbrMaterial.js":"3wOWA","../glTFLoader.js":"lHQW2","@babylonjs/core/Maths/math.color.js":"78my4","@parcel/transformer-js/src/esmodule-helpers.js":"XTfsy"}],"1TONr":[function(e,t,r){var s=e("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(r),s.export(r,"KHR_materials_specular",()=>l);var n=e("@babylonjs/core/Materials/PBR/pbrMaterial.js"),a=e("../glTFLoader.js"),o=e("@babylonjs/core/Maths/math.color.js");let i="KHR_materials_specular";class l{constructor(e){this.name=i,this.order=190,this._loader=e,this.enabled=this._loader.isExtensionUsed(i)}dispose(){this._loader=null}loadMaterialPropertiesAsync(e,t,r){return(0,a.GLTFLoader).LoadExtensionAsync(e,t,this.name,(s,n)=>{let a=[];return a.push(this._loader.loadMaterialPropertiesAsync(e,t,r)),a.push(this._loadSpecularPropertiesAsync(s,n,r)),Promise.all(a).then(()=>{})})}_loadSpecularPropertiesAsync(e,t,r){if(!(r instanceof n.PBRMaterial))throw Error(`${e}: Material type not supported`);let s=[];return void 0!==t.specularFactor&&(r.metallicF0Factor=t.specularFactor),void 0!==t.specularColorFactor&&(r.metallicReflectanceColor=(0,o.Color3).FromArray(t.specularColorFactor)),t.specularTexture&&(t.specularTexture.nonColorData=!0,s.push(this._loader.loadTextureInfoAsync(`${e}/specularTexture`,t.specularTexture,e=>{e.name=`${r.name} (Specular F0 Strength)`,r.metallicReflectanceTexture=e,r.useOnlyMetallicFromMetallicReflectanceTexture=!0}))),t.specularColorTexture&&s.push(this._loader.loadTextureInfoAsync(`${e}/specularColorTexture`,t.specularColorTexture,e=>{e.name=`${r.name} (Specular F0 Color)`,r.reflectanceTexture=e})),Promise.all(s).then(()=>{})}}(0,a.GLTFLoader).RegisterExtension(i,e=>new l(e))},{"@babylonjs/core/Materials/PBR/pbrMaterial.js":"3wOWA","../glTFLoader.js":"lHQW2","@babylonjs/core/Maths/math.color.js":"78my4","@parcel/transformer-js/src/esmodule-helpers.js":"XTfsy"}],bnBX6:[function(e,t,r){var s=e("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(r),s.export(r,"KHR_materials_ior",()=>i);var n=e("@babylonjs/core/Materials/PBR/pbrMaterial.js"),a=e("../glTFLoader.js");let o="KHR_materials_ior";class i{constructor(e){this.name=o,this.order=180,this._loader=e,this.enabled=this._loader.isExtensionUsed(o)}dispose(){this._loader=null}loadMaterialPropertiesAsync(e,t,r){return(0,a.GLTFLoader).LoadExtensionAsync(e,t,this.name,(s,n)=>{let a=[];return a.push(this._loader.loadMaterialPropertiesAsync(e,t,r)),a.push(this._loadIorPropertiesAsync(s,n,r)),Promise.all(a).then(()=>{})})}_loadIorPropertiesAsync(e,t,r){if(!(r instanceof n.PBRMaterial))throw Error(`${e}: Material type not supported`);return void 0!==t.ior?r.indexOfRefraction=t.ior:r.indexOfRefraction=i._DEFAULT_IOR,Promise.resolve()}}i._DEFAULT_IOR=1.5,(0,a.GLTFLoader).RegisterExtension(o,e=>new i(e))},{"@babylonjs/core/Materials/PBR/pbrMaterial.js":"3wOWA","../glTFLoader.js":"lHQW2","@parcel/transformer-js/src/esmodule-helpers.js":"XTfsy"}],fb7Cl:[function(e,t,r){var s=e("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(r),s.export(r,"KHR_materials_variants",()=>i);var n=e("../glTFLoader.js"),a=e("@babylonjs/core/Meshes/mesh.js");let o="KHR_materials_variants";class i{constructor(e){this.name=o,this._loader=e,this.enabled=this._loader.isExtensionUsed(o)}dispose(){this._loader=null}static GetAvailableVariants(e){let t=this._GetExtensionMetadata(e);return t?Object.keys(t.variants):[]}getAvailableVariants(e){return i.GetAvailableVariants(e)}static SelectVariant(e,t){let r=this._GetExtensionMetadata(e);if(!r)throw Error(`Cannot select variant on a glTF mesh that does not have the ${o} extension`);let s=e=>{let t=r.variants[e];if(t)for(let e of t)e.mesh.material=e.material};if(t instanceof Array)for(let e of t)s(e);else s(t);r.lastSelected=t}selectVariant(e,t){i.SelectVariant(e,t)}static Reset(e){let t=this._GetExtensionMetadata(e);if(!t)throw Error(`Cannot reset on a glTF mesh that does not have the ${o} extension`);for(let e of t.original)e.mesh.material=e.material;t.lastSelected=null}reset(e){i.Reset(e)}static GetLastSelectedVariant(e){let t=this._GetExtensionMetadata(e);if(!t)throw Error(`Cannot get the last selected variant on a glTF mesh that does not have the ${o} extension`);return t.lastSelected}getLastSelectedVariant(e){return i.GetLastSelectedVariant(e)}static _GetExtensionMetadata(e){return e?._internalMetadata?.gltf?.[o]||null}onLoading(){let e=this._loader.gltf.extensions;if(e&&e[this.name]){let t=e[this.name];this._variants=t.variants}}_loadMeshPrimitiveAsync(e,t,r,s,l,c){return(0,n.GLTFLoader).LoadExtensionAsync(e,l,this.name,(d,h)=>{let u=[];return u.push(this._loader._loadMeshPrimitiveAsync(e,t,r,s,l,t=>{if(c(t),t instanceof a.Mesh){let r=(0,n.GLTFLoader)._GetDrawMode(e,l.mode),s=this._loader.rootBabylonMesh,a=s?s._internalMetadata=s._internalMetadata||{}:{},c=a.gltf=a.gltf||{},_=c[o]=c[o]||{lastSelected:null,original:[],variants:{}};_.original.push({mesh:t,material:t.material});for(let e=0;e<h.mappings.length;++e){let a=h.mappings[e],l=(0,n.ArrayItem).Get(`${d}/mappings/${e}/material`,this._loader.gltf.materials,a.material);u.push(this._loader._loadMaterialAsync(`#/materials/${a.material}`,l,t,r,e=>{for(let r=0;r<a.variants.length;++r){let l=a.variants[r],c=(0,n.ArrayItem).Get(`/extensions/${o}/variants/${l}`,this._variants,l);_.variants[c.name]=_.variants[c.name]||[],_.variants[c.name].push({mesh:t,material:e}),t.onClonedObservable.add(e=>{let r=null,n=e;do{if(!(n=n.parent))return;r=i._GetExtensionMetadata(n)}while(null===r)if(s&&r===i._GetExtensionMetadata(s)){for(let e in n._internalMetadata={},s._internalMetadata)n._internalMetadata[e]=s._internalMetadata[e];for(let e in n._internalMetadata.gltf=[],s._internalMetadata.gltf)n._internalMetadata.gltf[e]=s._internalMetadata.gltf[e];for(let e of(n._internalMetadata.gltf[o]={lastSelected:null,original:[],variants:{}},r.original))n._internalMetadata.gltf[o].original.push({mesh:e.mesh,material:e.material});for(let e in r.variants)if(Object.prototype.hasOwnProperty.call(r.variants,e))for(let t of(n._internalMetadata.gltf[o].variants[e]=[],r.variants[e]))n._internalMetadata.gltf[o].variants[e].push({mesh:t.mesh,material:t.material});r=n._internalMetadata.gltf[o]}for(let s of r.original)s.mesh===t&&(s.mesh=e);for(let s of r.variants[c.name])s.mesh===t&&(s.mesh=e)})}}))}}})),Promise.all(u).then(([e])=>e)})}}(0,n.GLTFLoader).RegisterExtension(o,e=>new i(e))},{"../glTFLoader.js":"lHQW2","@babylonjs/core/Meshes/mesh.js":"9vBao","@parcel/transformer-js/src/esmodule-helpers.js":"XTfsy"}],icJBJ:[function(e,t,r){var s=e("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(r),s.export(r,"KHR_materials_transmission",()=>u);var n=e("@babylonjs/core/Materials/PBR/pbrMaterial.js"),a=e("../glTFLoader.js"),o=e("@babylonjs/core/Materials/Textures/renderTargetTexture.js"),i=e("@babylonjs/core/Misc/observable.js"),l=e("@babylonjs/core/Engines/constants.js"),c=e("@babylonjs/core/Misc/tools.js");class d{static _GetDefaultOptions(){return{renderSize:1024,samples:4,lodGenerationScale:1,lodGenerationOffset:-4,renderTargetTextureType:l.Constants.TEXTURETYPE_HALF_FLOAT,generateMipmaps:!0}}constructor(e,t){this._opaqueRenderTarget=null,this._opaqueMeshesCache=[],this._transparentMeshesCache=[],this._materialObservers={},this._options={...d._GetDefaultOptions(),...e},this._scene=t,this._scene._transmissionHelper=this,this.onErrorObservable=new i.Observable,this._scene.onDisposeObservable.addOnce(()=>{this.dispose()}),this._parseScene(),this._setupRenderTargets()}updateOptions(e){if(!Object.keys(e).filter(t=>this._options[t]!==e[t]).length)return;let t={...this._options,...e},r=this._options;this._options=t,t.renderSize===r.renderSize&&t.renderTargetTextureType===r.renderTargetTextureType&&t.generateMipmaps===r.generateMipmaps&&this._opaqueRenderTarget?(this._opaqueRenderTarget.samples=t.samples,this._opaqueRenderTarget.lodGenerationScale=t.lodGenerationScale,this._opaqueRenderTarget.lodGenerationOffset=t.lodGenerationOffset):this._setupRenderTargets()}getOpaqueTarget(){return this._opaqueRenderTarget}_shouldRenderAsTransmission(e){return!!e&&e instanceof n.PBRMaterial&&!!e.subSurface.isRefractionEnabled}_addMesh(e){this._materialObservers[e.uniqueId]=e.onMaterialChangedObservable.add(this._onMeshMaterialChanged.bind(this)),(0,c.Tools).SetImmediate(()=>{this._shouldRenderAsTransmission(e.material)?(e.material.refractionTexture=this._opaqueRenderTarget,-1===this._transparentMeshesCache.indexOf(e)&&this._transparentMeshesCache.push(e)):-1===this._opaqueMeshesCache.indexOf(e)&&this._opaqueMeshesCache.push(e)})}_removeMesh(e){e.onMaterialChangedObservable.remove(this._materialObservers[e.uniqueId]),delete this._materialObservers[e.uniqueId];let t=this._transparentMeshesCache.indexOf(e);-1!==t&&this._transparentMeshesCache.splice(t,1),-1!==(t=this._opaqueMeshesCache.indexOf(e))&&this._opaqueMeshesCache.splice(t,1)}_parseScene(){this._scene.meshes.forEach(this._addMesh.bind(this)),this._scene.onNewMeshAddedObservable.add(this._addMesh.bind(this)),this._scene.onMeshRemovedObservable.add(this._removeMesh.bind(this))}_onMeshMaterialChanged(e){let t=this._transparentMeshesCache.indexOf(e),r=this._opaqueMeshesCache.indexOf(e);this._shouldRenderAsTransmission(e.material)?(e.material instanceof n.PBRMaterial&&(e.material.subSurface.refractionTexture=this._opaqueRenderTarget),-1!==r?(this._opaqueMeshesCache.splice(r,1),this._transparentMeshesCache.push(e)):-1===t&&this._transparentMeshesCache.push(e)):-1!==t?(this._transparentMeshesCache.splice(t,1),this._opaqueMeshesCache.push(e)):-1===r&&this._opaqueMeshesCache.push(e)}_isRenderTargetValid(){return this._opaqueRenderTarget?.getInternalTexture()!==null}_setupRenderTargets(){let e,t;this._opaqueRenderTarget&&this._opaqueRenderTarget.dispose(),this._opaqueRenderTarget=new o.RenderTargetTexture("opaqueSceneTexture",this._options.renderSize,this._scene,this._options.generateMipmaps,void 0,this._options.renderTargetTextureType),this._opaqueRenderTarget.ignoreCameraViewport=!0,this._opaqueRenderTarget.renderList=this._opaqueMeshesCache,this._opaqueRenderTarget.clearColor=this._options.clearColor?.clone()??this._scene.clearColor.clone(),this._opaqueRenderTarget.gammaSpace=!1,this._opaqueRenderTarget.lodGenerationScale=this._options.lodGenerationScale,this._opaqueRenderTarget.lodGenerationOffset=this._options.lodGenerationOffset,this._opaqueRenderTarget.samples=this._options.samples,this._opaqueRenderTarget.renderSprites=!0,this._opaqueRenderTarget.renderParticles=!0,this._opaqueRenderTarget.onBeforeBindObservable.add(r=>{t=this._scene.environmentIntensity,this._scene.environmentIntensity=1,e=this._scene.imageProcessingConfiguration.applyByPostProcess,this._options.clearColor?r.clearColor.copyFrom(this._options.clearColor):this._scene.clearColor.toLinearSpaceToRef(r.clearColor,this._scene.getEngine().useExactSrgbConversions),this._scene.imageProcessingConfiguration._applyByPostProcess=!0}),this._opaqueRenderTarget.onAfterUnbindObservable.add(()=>{this._scene.environmentIntensity=t,this._scene.imageProcessingConfiguration._applyByPostProcess=e}),this._transparentMeshesCache.forEach(e=>{this._shouldRenderAsTransmission(e.material)&&(e.material.refractionTexture=this._opaqueRenderTarget)})}dispose(){this._scene._transmissionHelper=void 0,this._opaqueRenderTarget&&(this._opaqueRenderTarget.dispose(),this._opaqueRenderTarget=null),this._transparentMeshesCache=[],this._opaqueMeshesCache=[]}}let h="KHR_materials_transmission";class u{constructor(e){this.name=h,this.order=175,this._loader=e,this.enabled=this._loader.isExtensionUsed(h),this.enabled&&(e.parent.transparencyAsCoverage=!0)}dispose(){this._loader=null}loadMaterialPropertiesAsync(e,t,r){return(0,a.GLTFLoader).LoadExtensionAsync(e,t,this.name,(s,n)=>{let a=[];return a.push(this._loader.loadMaterialBasePropertiesAsync(e,t,r)),a.push(this._loader.loadMaterialPropertiesAsync(e,t,r)),a.push(this._loadTransparentPropertiesAsync(s,t,r,n)),Promise.all(a).then(()=>{})})}_loadTransparentPropertiesAsync(e,t,r,s){if(!(r instanceof n.PBRMaterial))throw Error(`${e}: Material type not supported`);if(r.subSurface.isRefractionEnabled=!0,r.subSurface.volumeIndexOfRefraction=1,r.subSurface.useAlbedoToTintRefraction=!0,void 0===s.transmissionFactor)return r.subSurface.refractionIntensity=0,r.subSurface.isRefractionEnabled=!1,Promise.resolve();{r.subSurface.refractionIntensity=s.transmissionFactor;let e=r.getScene();r.subSurface.refractionIntensity&&!e._transmissionHelper?new d({},r.getScene()):r.subSurface.refractionIntensity&&!e._transmissionHelper?._isRenderTargetValid()&&e._transmissionHelper?._setupRenderTargets()}return(r.subSurface.minimumThickness=0,r.subSurface.maximumThickness=0,s.transmissionTexture)?(s.transmissionTexture.nonColorData=!0,this._loader.loadTextureInfoAsync(`${e}/transmissionTexture`,s.transmissionTexture,void 0).then(e=>{r.subSurface.refractionIntensityTexture=e,r.subSurface.useGltfStyleTextures=!0})):Promise.resolve()}}(0,a.GLTFLoader).RegisterExtension(h,e=>new u(e))},{"@babylonjs/core/Materials/PBR/pbrMaterial.js":"3wOWA","../glTFLoader.js":"lHQW2","@babylonjs/core/Materials/Textures/renderTargetTexture.js":"d2aud","@babylonjs/core/Misc/observable.js":"7yHKY","@babylonjs/core/Engines/constants.js":"es9Cn","@babylonjs/core/Misc/tools.js":"ieufJ","@parcel/transformer-js/src/esmodule-helpers.js":"XTfsy"}],"2bI90":[function(e,t,r){var s=e("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(r),s.export(r,"KHR_materials_translucency",()=>i);var n=e("@babylonjs/core/Materials/PBR/pbrMaterial.js"),a=e("../glTFLoader.js");let o="KHR_materials_translucency";class i{constructor(e){this.name=o,this.order=174,this._loader=e,this.enabled=this._loader.isExtensionUsed(o),this.enabled&&(e.parent.transparencyAsCoverage=!0)}dispose(){this._loader=null}loadMaterialPropertiesAsync(e,t,r){return(0,a.GLTFLoader).LoadExtensionAsync(e,t,this.name,(s,n)=>{let a=[];return a.push(this._loader.loadMaterialBasePropertiesAsync(e,t,r)),a.push(this._loader.loadMaterialPropertiesAsync(e,t,r)),a.push(this._loadTranslucentPropertiesAsync(s,t,r,n)),Promise.all(a).then(()=>{})})}_loadTranslucentPropertiesAsync(e,t,r,s){if(!(r instanceof n.PBRMaterial))throw Error(`${e}: Material type not supported`);return(r.subSurface.isTranslucencyEnabled=!0,r.subSurface.volumeIndexOfRefraction=1,r.subSurface.minimumThickness=0,r.subSurface.maximumThickness=0,r.subSurface.useAlbedoToTintTranslucency=!0,void 0===s.translucencyFactor)?(r.subSurface.translucencyIntensity=0,r.subSurface.isTranslucencyEnabled=!1,Promise.resolve()):(r.subSurface.translucencyIntensity=s.translucencyFactor,s.translucencyTexture)?(s.translucencyTexture.nonColorData=!0,this._loader.loadTextureInfoAsync(`${e}/translucencyTexture`,s.translucencyTexture).then(e=>{r.subSurface.translucencyIntensityTexture=e})):Promise.resolve()}}(0,a.GLTFLoader).RegisterExtension(o,e=>new i(e))},{"@babylonjs/core/Materials/PBR/pbrMaterial.js":"3wOWA","../glTFLoader.js":"lHQW2","@parcel/transformer-js/src/esmodule-helpers.js":"XTfsy"}],cQOgc:[function(e,t,r){var s=e("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(r),s.export(r,"KHR_materials_volume",()=>i);var n=e("@babylonjs/core/Materials/PBR/pbrMaterial.js"),a=e("../glTFLoader.js");let o="KHR_materials_volume";class i{constructor(e){this.name=o,this.order=173,this._loader=e,this.enabled=this._loader.isExtensionUsed(o),this.enabled&&this._loader._disableInstancedMesh++}dispose(){this.enabled&&this._loader._disableInstancedMesh--,this._loader=null}loadMaterialPropertiesAsync(e,t,r){return(0,a.GLTFLoader).LoadExtensionAsync(e,t,this.name,(s,n)=>{let a=[];return a.push(this._loader.loadMaterialBasePropertiesAsync(e,t,r)),a.push(this._loader.loadMaterialPropertiesAsync(e,t,r)),a.push(this._loadVolumePropertiesAsync(s,t,r,n)),Promise.all(a).then(()=>{})})}_loadVolumePropertiesAsync(e,t,r,s){if(!(r instanceof n.PBRMaterial))throw Error(`${e}: Material type not supported`);if(!r.subSurface.isRefractionEnabled&&!r.subSurface.isTranslucencyEnabled||!s.thicknessFactor)return Promise.resolve();r.subSurface.volumeIndexOfRefraction=r.indexOfRefraction;let a=void 0!==s.attenuationDistance?s.attenuationDistance:Number.MAX_VALUE;return(r.subSurface.tintColorAtDistance=a,void 0!==s.attenuationColor&&3==s.attenuationColor.length&&r.subSurface.tintColor.copyFromFloats(s.attenuationColor[0],s.attenuationColor[1],s.attenuationColor[2]),r.subSurface.minimumThickness=0,r.subSurface.maximumThickness=s.thicknessFactor,r.subSurface.useThicknessAsDepth=!0,s.thicknessTexture)?(s.thicknessTexture.nonColorData=!0,this._loader.loadTextureInfoAsync(`${e}/thicknessTexture`,s.thicknessTexture).then(e=>{r.subSurface.thicknessTexture=e,r.subSurface.useGltfStyleTextures=!0})):Promise.resolve()}}(0,a.GLTFLoader).RegisterExtension(o,e=>new i(e))},{"@babylonjs/core/Materials/PBR/pbrMaterial.js":"3wOWA","../glTFLoader.js":"lHQW2","@parcel/transformer-js/src/esmodule-helpers.js":"XTfsy"}],"8W8DE":[function(e,t,r){var s=e("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(r),s.export(r,"KHR_materials_dispersion",()=>i);var n=e("@babylonjs/core/Materials/PBR/pbrMaterial.js"),a=e("../glTFLoader.js");let o="KHR_materials_dispersion";class i{constructor(e){this.name=o,this.order=174,this._loader=e,this.enabled=this._loader.isExtensionUsed(o)}dispose(){this._loader=null}loadMaterialPropertiesAsync(e,t,r){return(0,a.GLTFLoader).LoadExtensionAsync(e,t,this.name,(s,n)=>{let a=[];return a.push(this._loader.loadMaterialBasePropertiesAsync(e,t,r)),a.push(this._loader.loadMaterialPropertiesAsync(e,t,r)),a.push(this._loadDispersionPropertiesAsync(s,t,r,n)),Promise.all(a).then(()=>{})})}_loadDispersionPropertiesAsync(e,t,r,s){if(!(r instanceof n.PBRMaterial))throw Error(`${e}: Material type not supported`);return r.subSurface.isRefractionEnabled&&s.dispersion&&(r.subSurface.isDispersionEnabled=!0,r.subSurface.dispersion=s.dispersion),Promise.resolve()}}(0,a.GLTFLoader).RegisterExtension(o,e=>new i(e))},{"@babylonjs/core/Materials/PBR/pbrMaterial.js":"3wOWA","../glTFLoader.js":"lHQW2","@parcel/transformer-js/src/esmodule-helpers.js":"XTfsy"}],"3N7Mu":[function(e,t,r){var s=e("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(r),s.export(r,"KHR_mesh_quantization",()=>o);var n=e("../glTFLoader.js");let a="KHR_mesh_quantization";class o{constructor(e){this.name=a,this.enabled=e.isExtensionUsed(a)}dispose(){}}(0,n.GLTFLoader).RegisterExtension(a,e=>new o(e))},{"../glTFLoader.js":"lHQW2","@parcel/transformer-js/src/esmodule-helpers.js":"XTfsy"}],gy9Ea:[function(e,t,r){var s=e("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(r),s.export(r,"KHR_texture_basisu",()=>o);var n=e("../glTFLoader.js");let a="KHR_texture_basisu";class o{constructor(e){this.name=a,this._loader=e,this.enabled=e.isExtensionUsed(a)}dispose(){this._loader=null}_loadTextureAsync(e,t,r){return(0,n.GLTFLoader).LoadExtensionAsync(e,t,this.name,(s,a)=>{let o=void 0==t.sampler?n.GLTFLoader.DefaultSampler:(0,n.ArrayItem).Get(`${e}/sampler`,this._loader.gltf.samplers,t.sampler),i=(0,n.ArrayItem).Get(`${s}/source`,this._loader.gltf.images,a.source);return this._loader._createTextureAsync(e,o,i,e=>{r(e)},t._textureInfo.nonColorData?{useRGBAIfASTCBC7NotAvailableWhenUASTC:!0}:void 0,!t._textureInfo.nonColorData)})}}(0,n.GLTFLoader).RegisterExtension(a,e=>new o(e))},{"../glTFLoader.js":"lHQW2","@parcel/transformer-js/src/esmodule-helpers.js":"XTfsy"}],a8Aai:[function(e,t,r){var s=e("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(r),s.export(r,"KHR_texture_transform",()=>i);var n=e("@babylonjs/core/Materials/Textures/texture.js"),a=e("../glTFLoader.js");let o="KHR_texture_transform";class i{constructor(e){this.name=o,this._loader=e,this.enabled=this._loader.isExtensionUsed(o)}dispose(){this._loader=null}loadTextureInfoAsync(e,t,r){return(0,a.GLTFLoader).LoadExtensionAsync(e,t,this.name,(s,a)=>this._loader.loadTextureInfoAsync(e,t,e=>{if(!(e instanceof n.Texture))throw Error(`${s}: Texture type not supported`);a.offset&&(e.uOffset=a.offset[0],e.vOffset=a.offset[1]),e.uRotationCenter=0,e.vRotationCenter=0,a.rotation&&(e.wAng=-a.rotation),a.scale&&(e.uScale=a.scale[0],e.vScale=a.scale[1]),void 0!=a.texCoord&&(e.coordinatesIndex=a.texCoord),r(e)}))}}(0,a.GLTFLoader).RegisterExtension(o,e=>new i(e))},{"@babylonjs/core/Materials/Textures/texture.js":"bYxw8","../glTFLoader.js":"lHQW2","@parcel/transformer-js/src/esmodule-helpers.js":"XTfsy"}],"8ucaF":[function(e,t,r){var s=e("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(r),s.export(r,"KHR_xmp_json_ld",()=>o);var n=e("../glTFLoader.js");let a="KHR_xmp_json_ld";class o{constructor(e){this.name=a,this.order=100,this._loader=e,this.enabled=this._loader.isExtensionUsed(a)}dispose(){this._loader=null}onLoading(){if(null===this._loader.rootBabylonMesh)return;let e=this._loader.gltf.extensions?.KHR_xmp_json_ld,t=this._loader.gltf.asset?.extensions?.KHR_xmp_json_ld;if(e&&t){let r=+t.packet;e.packets&&r<e.packets.length&&(this._loader.rootBabylonMesh.metadata=this._loader.rootBabylonMesh.metadata||{},this._loader.rootBabylonMesh.metadata.xmp=e.packets[r])}}}(0,n.GLTFLoader).RegisterExtension(a,e=>new o(e))},{"../glTFLoader.js":"lHQW2","@parcel/transformer-js/src/esmodule-helpers.js":"XTfsy"}],d4S7R:[function(e,t,r){var s=e("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(r),s.export(r,"KHR_animation_pointer",()=>d);var n=e("../glTFLoader.js"),a=e("@babylonjs/core/Misc/logger.js"),o=e("./KHR_animation_pointer.data.js"),i=e("./gltfPathToObjectConverter.js");let l="KHR_animation_pointer";class c extends i.GLTFPathToObjectConverter{constructor(e){super(e,o.animationPointerTree)}}class d{constructor(e){this.name=l,this._loader=e,this._pathToObjectConverter=new c(this._loader.gltf)}get enabled(){return this._loader.isExtensionUsed(l)}dispose(){this._loader=null,delete this._pathToObjectConverter}_loadAnimationChannelAsync(e,t,r,s,n){let o=s.target.extensions?.KHR_animation_pointer;if(!o||!this._pathToObjectConverter)return null;"pointer"!==s.target.path&&(0,a.Logger).Warn(`${e}/target/path: Value (${s.target.path}) must be (pointer) when using the ${this.name} extension`),void 0!=s.target.node&&(0,a.Logger).Warn(`${e}/target/node: Value (${s.target.node}) must not be present when using the ${this.name} extension`);let i=`${e}/extensions/${this.name}`,l=o.pointer;if(!l)throw Error(`${i}: Pointer is missing`);try{let a=this._pathToObjectConverter.convert(l);return this._loader._loadAnimationChannelFromTargetInfoAsync(e,t,r,s,a,n)}catch(e){return(0,a.Logger).Warn(`${i}/pointer: Invalid pointer (${l}) skipped`),null}}}(0,n.GLTFLoader).RegisterExtension(l,e=>new d(e))},{"../glTFLoader.js":"lHQW2","@babylonjs/core/Misc/logger.js":"5C8M2","./KHR_animation_pointer.data.js":"aiEQG","./gltfPathToObjectConverter.js":"bSBwk","@parcel/transformer-js/src/esmodule-helpers.js":"XTfsy"}],aiEQG:[function(e,t,r){var s=e("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(r),s.export(r,"animationPointerTree",()=>b);var n=e("@babylonjs/core/Animations/animation.js"),a=e("../glTFLoaderAnimation.js"),o=e("@babylonjs/core/Maths/math.color.js");function i(e,t,r,s){return(0,o.Color3).FromArray(t,r).scale(s)}function l(e,t,r,s){return t[r]*s}function c(e,t,r,s){return-t[r]*s}function d(e,t,r,s){return t[r+1]*s}function h(e,t,r,s){return t[r]*s*2}function u(e){return{scale:[new p(n.Animation.ANIMATIONTYPE_FLOAT,`${e}.uScale`,l,()=>2),new p(n.Animation.ANIMATIONTYPE_FLOAT,`${e}.vScale`,d,()=>2)],offset:[new p(n.Animation.ANIMATIONTYPE_FLOAT,`${e}.uOffset`,l,()=>2),new p(n.Animation.ANIMATIONTYPE_FLOAT,`${e}.vOffset`,d,()=>2)],rotation:[new p(n.Animation.ANIMATIONTYPE_FLOAT,`${e}.wAng`,c,()=>1)]}}class _ extends a.AnimationPropertyInfo{buildAnimations(e,t,r,s,n){n(e._babylonCamera,this._buildAnimation(t,r,s))}}class p extends a.AnimationPropertyInfo{buildAnimations(e,t,r,s,n){for(let a in e._data)n(e._data[a].babylonMaterial,this._buildAnimation(t,r,s))}}class m extends a.AnimationPropertyInfo{buildAnimations(e,t,r,s,n){n(e._babylonLight,this._buildAnimation(t,r,s))}}let f={__array__:{__target__:!0,...a.nodeAnimationData}},y={__array__:{__target__:!0,orthographic:{xmag:[new _(n.Animation.ANIMATIONTYPE_FLOAT,"orthoLeft",c,()=>1),new _(n.Animation.ANIMATIONTYPE_FLOAT,"orthoRight",d,()=>1)],ymag:[new _(n.Animation.ANIMATIONTYPE_FLOAT,"orthoBottom",c,()=>1),new _(n.Animation.ANIMATIONTYPE_FLOAT,"orthoTop",d,()=>1)],zfar:[new _(n.Animation.ANIMATIONTYPE_FLOAT,"maxZ",l,()=>1)],znear:[new _(n.Animation.ANIMATIONTYPE_FLOAT,"minZ",l,()=>1)]},perspective:{yfov:[new _(n.Animation.ANIMATIONTYPE_FLOAT,"fov",l,()=>1)],zfar:[new _(n.Animation.ANIMATIONTYPE_FLOAT,"maxZ",l,()=>1)],znear:[new _(n.Animation.ANIMATIONTYPE_FLOAT,"minZ",l,()=>1)]}}},b={nodes:f,materials:{__array__:{__target__:!0,pbrMetallicRoughness:{baseColorFactor:[new p(n.Animation.ANIMATIONTYPE_COLOR3,"albedoColor",i,()=>4),new p(n.Animation.ANIMATIONTYPE_FLOAT,"alpha",function(e,t,r,s){return t[r+3]*s},()=>4)],metallicFactor:[new p(n.Animation.ANIMATIONTYPE_FLOAT,"metallic",l,()=>1)],roughnessFactor:[new p(n.Animation.ANIMATIONTYPE_FLOAT,"roughness",l,()=>1)],baseColorTexture:{extensions:{KHR_texture_transform:u("albedoTexture")}}},emissiveFactor:[new p(n.Animation.ANIMATIONTYPE_COLOR3,"emissiveColor",i,()=>3)],normalTexture:{scale:[new p(n.Animation.ANIMATIONTYPE_FLOAT,"bumpTexture.level",l,()=>1)]},occlusionTexture:{strength:[new p(n.Animation.ANIMATIONTYPE_FLOAT,"ambientTextureStrength",l,()=>1)],extensions:{KHR_texture_transform:u("ambientTexture")}},emissiveTexture:{extensions:{KHR_texture_transform:u("emissiveTexture")}},extensions:{KHR_materials_ior:{ior:[new p(n.Animation.ANIMATIONTYPE_FLOAT,"indexOfRefraction",l,()=>1)]},KHR_materials_clearcoat:{clearcoatFactor:[new p(n.Animation.ANIMATIONTYPE_FLOAT,"clearCoat.intensity",l,()=>1)],clearcoatRoughnessFactor:[new p(n.Animation.ANIMATIONTYPE_FLOAT,"clearCoat.roughness",l,()=>1)]},KHR_materials_sheen:{sheenColorFactor:[new p(n.Animation.ANIMATIONTYPE_COLOR3,"sheen.color",i,()=>3)],sheenRoughnessFactor:[new p(n.Animation.ANIMATIONTYPE_FLOAT,"sheen.roughness",l,()=>1)]},KHR_materials_specular:{specularFactor:[new p(n.Animation.ANIMATIONTYPE_FLOAT,"metallicF0Factor",l,()=>1)],specularColorFactor:[new p(n.Animation.ANIMATIONTYPE_COLOR3,"metallicReflectanceColor",i,()=>3)]},KHR_materials_emissive_strength:{emissiveStrength:[new p(n.Animation.ANIMATIONTYPE_FLOAT,"emissiveIntensity",l,()=>1)]},KHR_materials_transmission:{transmissionFactor:[new p(n.Animation.ANIMATIONTYPE_FLOAT,"subSurface.refractionIntensity",l,()=>1)]},KHR_materials_volume:{attenuationColor:[new p(n.Animation.ANIMATIONTYPE_COLOR3,"subSurface.tintColor",i,()=>3)],attenuationDistance:[new p(n.Animation.ANIMATIONTYPE_FLOAT,"subSurface.tintColorAtDistance",l,()=>1)],thicknessFactor:[new p(n.Animation.ANIMATIONTYPE_FLOAT,"subSurface.maximumThickness",l,()=>1)]},KHR_materials_dispersion:{dispersion:[new p(n.Animation.ANIMATIONTYPE_FLOAT,"subSurface.dispersion",l,()=>1)]},KHR_materials_iridescence:{iridescenceFactor:[new p(n.Animation.ANIMATIONTYPE_FLOAT,"iridescence.intensity",l,()=>1)],iridescenceIor:[new p(n.Animation.ANIMATIONTYPE_FLOAT,"iridescence.indexOfRefraction",l,()=>1)],iridescenceThicknessMinimum:[new p(n.Animation.ANIMATIONTYPE_FLOAT,"iridescence.minimumThickness",l,()=>1)],iridescenceThicknessMaximum:[new p(n.Animation.ANIMATIONTYPE_FLOAT,"iridescence.maximumThickness",l,()=>1)]},KHR_materials_anisotropy:{anisotropyStrength:[new p(n.Animation.ANIMATIONTYPE_FLOAT,"anisotropy.intensity",l,()=>1)],anisotropyRotation:[new p(n.Animation.ANIMATIONTYPE_FLOAT,"anisotropy.angle",l,()=>1)]}}}},cameras:y,extensions:{KHR_lights_punctual:{lights:{__array__:{__target__:!0,color:[new m(n.Animation.ANIMATIONTYPE_COLOR3,"diffuse",i,()=>3)],intensity:[new m(n.Animation.ANIMATIONTYPE_FLOAT,"intensity",l,()=>1)],range:[new m(n.Animation.ANIMATIONTYPE_FLOAT,"range",l,()=>1)],spot:{innerConeAngle:[new m(n.Animation.ANIMATIONTYPE_FLOAT,"innerAngle",h,()=>1)],outerConeAngle:[new m(n.Animation.ANIMATIONTYPE_FLOAT,"angle",h,()=>1)]}}}}}}},{"@babylonjs/core/Animations/animation.js":"aeJ0l","../glTFLoaderAnimation.js":"3rmfu","@babylonjs/core/Maths/math.color.js":"78my4","@parcel/transformer-js/src/esmodule-helpers.js":"XTfsy"}],bSBwk:[function(e,t,r){var s=e("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(r),s.export(r,"GLTFPathToObjectConverter",()=>n);class n{constructor(e,t){this._gltf=e,this._infoTree=t}convert(e){let t,r=this._gltf,s=this._infoTree;if(!e.startsWith("/"))throw Error("Path must start with a /");let n=e.split("/");for(let a of(n.shift(),n)){if(s.__array__)s=s.__array__;else if(!(s=s[a]))throw Error(`Path ${e} is invalid`);if(void 0===r)throw Error(`Path ${e} is invalid`);r=r[a],s.__target__&&(t=r)}return{object:t,info:s}}}},{"@parcel/transformer-js/src/esmodule-helpers.js":"XTfsy"}],br9T4:[function(e,t,r){var s=e("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(r),s.export(r,"MSFT_audio_emitter",()=>h);var n=e("@babylonjs/core/Maths/math.vector.js"),a=e("@babylonjs/core/Misc/tools.js"),o=e("@babylonjs/core/Animations/animationEvent.js"),i=e("@babylonjs/core/Audio/sound.js"),l=e("@babylonjs/core/Audio/weightedsound.js"),c=e("../glTFLoader.js");let d="MSFT_audio_emitter";class h{constructor(e){this.name=d,this._loader=e,this.enabled=this._loader.isExtensionUsed(d)}dispose(){this._loader=null,this._clips=null,this._emitters=null}onLoading(){let e=this._loader.gltf.extensions;if(e&&e[this.name]){let t=e[this.name];this._clips=t.clips,this._emitters=t.emitters,(0,c.ArrayItem).Assign(this._clips),(0,c.ArrayItem).Assign(this._emitters)}}loadSceneAsync(e,t){return(0,c.GLTFLoader).LoadExtensionAsync(e,t,this.name,(r,s)=>{let n=[];for(let a of(n.push(this._loader.loadSceneAsync(e,t)),s.emitters)){let e=(0,c.ArrayItem).Get(`${r}/emitters`,this._emitters,a);if(void 0!=e.refDistance||void 0!=e.maxDistance||void 0!=e.rolloffFactor||void 0!=e.distanceModel||void 0!=e.innerAngle||void 0!=e.outerAngle)throw Error(`${r}: Direction or Distance properties are not allowed on emitters attached to a scene`);n.push(this._loadEmitterAsync(`${r}/emitters/${e.index}`,e))}return Promise.all(n).then(()=>{})})}loadNodeAsync(e,t,r){return(0,c.GLTFLoader).LoadExtensionAsync(e,t,this.name,(e,s)=>{let o=[];return this._loader.loadNodeAsync(e,t,t=>{for(let r of s.emitters){let s=(0,c.ArrayItem).Get(`${e}/emitters`,this._emitters,r);o.push(this._loadEmitterAsync(`${e}/emitters/${s.index}`,s).then(()=>{for(let e of s._babylonSounds)e.attachToMesh(t),(void 0!=s.innerAngle||void 0!=s.outerAngle)&&(e.setLocalDirectionToMesh((0,n.Vector3).Forward()),e.setDirectionalCone(2*(0,a.Tools).ToDegrees(void 0==s.innerAngle?Math.PI:s.innerAngle),2*(0,a.Tools).ToDegrees(void 0==s.outerAngle?Math.PI:s.outerAngle),0))}))}r(t)}).then(e=>Promise.all(o).then(()=>e))})}loadAnimationAsync(e,t){return(0,c.GLTFLoader).LoadExtensionAsync(e,t,this.name,(r,s)=>this._loader.loadAnimationAsync(e,t).then(n=>{let a=[];for(let o of((0,c.ArrayItem).Assign(s.events),s.events))a.push(this._loadAnimationEventAsync(`${r}/events/${o.index}`,e,t,o,n));return Promise.all(a).then(()=>n)}))}_loadClipAsync(e,t){let r;if(t._objectURL)return t._objectURL;if(t.uri)r=this._loader.loadUriAsync(e,t,t.uri);else{let s=(0,c.ArrayItem).Get(`${e}/bufferView`,this._loader.gltf.bufferViews,t.bufferView);r=this._loader.loadBufferViewAsync(`/bufferViews/${s.index}`,s)}return t._objectURL=r.then(e=>URL.createObjectURL(new Blob([e],{type:t.mimeType}))),t._objectURL}_loadEmitterAsync(e,t){if(t._babylonSounds=t._babylonSounds||[],!t._babylonData){let e=[],r=t.name||`emitter${t.index}`,s={loop:!1,autoplay:!1,volume:void 0==t.volume?1:t.volume};for(let n=0;n<t.clips.length;n++){let a=`/extensions/${this.name}/clips`,o=(0,c.ArrayItem).Get(a,this._clips,t.clips[n].clip);e.push(this._loadClipAsync(`${a}/${t.clips[n].clip}`,o).then(e=>{let a=t._babylonSounds[n]=new i.Sound(r,e,this._loader.babylonScene,null,s);a.refDistance=t.refDistance||1,a.maxDistance=t.maxDistance||256,a.rolloffFactor=t.rolloffFactor||1,a.distanceModel=t.distanceModel||"exponential"}))}let n=Promise.all(e).then(()=>{let e=t.clips.map(e=>e.weight||1),r=new l.WeightedSound(t.loop||!1,t._babylonSounds,e);t.innerAngle&&(r.directionalConeInnerAngle=2*(0,a.Tools).ToDegrees(t.innerAngle)),t.outerAngle&&(r.directionalConeOuterAngle=2*(0,a.Tools).ToDegrees(t.outerAngle)),t.volume&&(r.volume=t.volume),t._babylonData.sound=r});t._babylonData={loaded:n}}return t._babylonData.loaded}_getEventAction(e,t,r,s,n){switch(r){case"play":return e=>{t.play((n||0)+(e-s))};case"stop":return()=>{t.stop()};case"pause":return()=>{t.pause()};default:throw Error(`${e}: Unsupported action ${r}`)}}_loadAnimationEventAsync(e,t,r,s,n){if(0==n.targetedAnimations.length)return Promise.resolve();let a=n.targetedAnimations[0],i=s.emitter,l=(0,c.ArrayItem).Get(`/extensions/${this.name}/emitters`,this._emitters,i);return this._loadEmitterAsync(e,l).then(()=>{let t=l._babylonData.sound;if(t){let r=new o.AnimationEvent(s.time,this._getEventAction(e,t,s.action,s.time,s.startOffset));a.animation.addEvent(r),n.onAnimationGroupEndObservable.add(()=>{t.stop()}),n.onAnimationGroupPauseObservable.add(()=>{t.pause()})}})}}(0,c.GLTFLoader).RegisterExtension(d,e=>new h(e))},{"@babylonjs/core/Maths/math.vector.js":"h33gd","@babylonjs/core/Misc/tools.js":"ieufJ","@babylonjs/core/Animations/animationEvent.js":"ksTr3","@babylonjs/core/Audio/sound.js":"11KUt","@babylonjs/core/Audio/weightedsound.js":"dPqOj","../glTFLoader.js":"lHQW2","@parcel/transformer-js/src/esmodule-helpers.js":"XTfsy"}],jiyCf:[function(e,t,r){var s=e("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(r),s.export(r,"MSFT_lod",()=>l);var n=e("@babylonjs/core/Misc/observable.js"),a=e("@babylonjs/core/Misc/deferred.js"),o=e("../glTFLoader.js");let i="MSFT_lod";class l{constructor(e){this.name=i,this.order=100,this.maxLODsToLoad=10,this.onNodeLODsLoadedObservable=new n.Observable,this.onMaterialLODsLoadedObservable=new n.Observable,this._bufferLODs=[],this._nodeIndexLOD=null,this._nodeSignalLODs=[],this._nodePromiseLODs=[],this._nodeBufferLODs=[],this._materialIndexLOD=null,this._materialSignalLODs=[],this._materialPromiseLODs=[],this._materialBufferLODs=[],this._loader=e,this.enabled=this._loader.isExtensionUsed(i)}dispose(){this._loader=null,this._nodeIndexLOD=null,this._nodeSignalLODs.length=0,this._nodePromiseLODs.length=0,this._nodeBufferLODs.length=0,this._materialIndexLOD=null,this._materialSignalLODs.length=0,this._materialPromiseLODs.length=0,this._materialBufferLODs.length=0,this.onMaterialLODsLoadedObservable.clear(),this.onNodeLODsLoadedObservable.clear()}onReady(){for(let e=0;e<this._nodePromiseLODs.length;e++){let t=Promise.all(this._nodePromiseLODs[e]).then(()=>{0!==e&&(this._loader.endPerformanceCounter(`Node LOD ${e}`),this._loader.log(`Loaded node LOD ${e}`)),this.onNodeLODsLoadedObservable.notifyObservers(e),e!==this._nodePromiseLODs.length-1&&(this._loader.startPerformanceCounter(`Node LOD ${e+1}`),this._loadBufferLOD(this._nodeBufferLODs,e+1),this._nodeSignalLODs[e]&&this._nodeSignalLODs[e].resolve())});this._loader._completePromises.push(t)}for(let e=0;e<this._materialPromiseLODs.length;e++){let t=Promise.all(this._materialPromiseLODs[e]).then(()=>{0!==e&&(this._loader.endPerformanceCounter(`Material LOD ${e}`),this._loader.log(`Loaded material LOD ${e}`)),this.onMaterialLODsLoadedObservable.notifyObservers(e),e!==this._materialPromiseLODs.length-1&&(this._loader.startPerformanceCounter(`Material LOD ${e+1}`),this._loadBufferLOD(this._materialBufferLODs,e+1),this._materialSignalLODs[e]&&this._materialSignalLODs[e].resolve())});this._loader._completePromises.push(t)}}loadSceneAsync(e,t){let r=this._loader.loadSceneAsync(e,t);return this._loadBufferLOD(this._bufferLODs,0),r}loadNodeAsync(e,t,r){return(0,o.GLTFLoader).LoadExtensionAsync(e,t,this.name,(e,s)=>{let n;let o=this._getLODs(e,t,this._loader.gltf.nodes,s.ids);this._loader.logOpen(`${e}`);for(let e=0;e<o.length;e++){let t=o[e];0!==e&&(this._nodeIndexLOD=e,this._nodeSignalLODs[e]=this._nodeSignalLODs[e]||new a.Deferred);let s=e=>{r(e),e.setEnabled(!1)},i=this._loader.loadNodeAsync(`/nodes/${t.index}`,t,s).then(t=>{if(0!==e){let t=o[e-1];t._babylonTransformNode&&(this._disposeTransformNode(t._babylonTransformNode),delete t._babylonTransformNode)}return t.setEnabled(!0),t});this._nodePromiseLODs[e]=this._nodePromiseLODs[e]||[],0===e?n=i:(this._nodeIndexLOD=null,this._nodePromiseLODs[e].push(i))}return this._loader.logClose(),n})}_loadMaterialAsync(e,t,r,s,n){return this._nodeIndexLOD?null:(0,o.GLTFLoader).LoadExtensionAsync(e,t,this.name,(e,a)=>{let o;let i=this._getLODs(e,t,this._loader.gltf.materials,a.ids);this._loader.logOpen(`${e}`);for(let e=0;e<i.length;e++){let t=i[e];0!==e&&(this._materialIndexLOD=e);let a=this._loader._loadMaterialAsync(`/materials/${t.index}`,t,r,s,t=>{0===e&&n(t)}).then(t=>{if(0!==e){n(t);let r=i[e-1]._data;r[s]&&(this._disposeMaterials([r[s].babylonMaterial]),delete r[s])}return t});this._materialPromiseLODs[e]=this._materialPromiseLODs[e]||[],0===e?o=a:(this._materialIndexLOD=null,this._materialPromiseLODs[e].push(a))}return this._loader.logClose(),o})}_loadUriAsync(e,t,r){if(null!==this._nodeIndexLOD){this._loader.log("deferred");let s=this._nodeIndexLOD-1;return this._nodeSignalLODs[s]=this._nodeSignalLODs[s]||new a.Deferred,this._nodeSignalLODs[this._nodeIndexLOD-1].promise.then(()=>this._loader.loadUriAsync(e,t,r))}if(null!==this._materialIndexLOD){this._loader.log("deferred");let s=this._materialIndexLOD-1;return this._materialSignalLODs[s]=this._materialSignalLODs[s]||new a.Deferred,this._materialSignalLODs[s].promise.then(()=>this._loader.loadUriAsync(e,t,r))}return null}loadBufferAsync(e,t,r,s){if(this._loader.parent.useRangeRequests&&!t.uri){if(!this._loader.bin)throw Error(`${e}: Uri is missing or the binary glTF is missing its binary chunk`);let t=(e,t)=>{let n=r+s-1,o=e[t];return o?(o.start=Math.min(o.start,r),o.end=Math.max(o.end,n)):(o={start:r,end:n,loaded:new a.Deferred},e[t]=o),o.loaded.promise.then(e=>new Uint8Array(e.buffer,e.byteOffset+r-o.start,s))};return(this._loader.log("deferred"),null!==this._nodeIndexLOD)?t(this._nodeBufferLODs,this._nodeIndexLOD):null!==this._materialIndexLOD?t(this._materialBufferLODs,this._materialIndexLOD):t(this._bufferLODs,0)}return null}_loadBufferLOD(e,t){let r=e[t];r&&(this._loader.log(`Loading buffer range [${r.start}-${r.end}]`),this._loader.bin.readAsync(r.start,r.end-r.start+1).then(e=>{r.loaded.resolve(e)},e=>{r.loaded.reject(e)}))}_getLODs(e,t,r,s){if(this.maxLODsToLoad<=0)throw Error("maxLODsToLoad must be greater than zero");let n=[];for(let t=s.length-1;t>=0;t--)if(n.push((0,o.ArrayItem).Get(`${e}/ids/${s[t]}`,r,s[t])),n.length===this.maxLODsToLoad)return n;return n.push(t),n}_disposeTransformNode(e){let t=[],r=e.material;for(let s of(r&&t.push(r),e.getChildMeshes()))s.material&&t.push(s.material);e.dispose();let s=t.filter(e=>this._loader.babylonScene.meshes.every(t=>t.material!=e));this._disposeMaterials(s)}_disposeMaterials(e){let t={};for(let r of e){for(let e of r.getActiveTextures())t[e.uniqueId]=e;r.dispose()}for(let e in t)for(let r of this._loader.babylonScene.materials)r.hasTexture(t[e])&&delete t[e];for(let e in t)t[e].dispose()}}(0,o.GLTFLoader).RegisterExtension(i,e=>new l(e))},{"@babylonjs/core/Misc/observable.js":"7yHKY","@babylonjs/core/Misc/deferred.js":"cceve","../glTFLoader.js":"lHQW2","@parcel/transformer-js/src/esmodule-helpers.js":"XTfsy"}],bxMkM:[function(e,t,r){var s=e("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(r),s.export(r,"MSFT_minecraftMesh",()=>i);var n=e("@babylonjs/core/Materials/PBR/pbrMaterial.js"),a=e("../glTFLoader.js");let o="MSFT_minecraftMesh";class i{constructor(e){this.name=o,this._loader=e,this.enabled=this._loader.isExtensionUsed(o)}dispose(){this._loader=null}loadMaterialPropertiesAsync(e,t,r){return(0,a.GLTFLoader).LoadExtraAsync(e,t,this.name,(s,a)=>{if(a){if(!(r instanceof n.PBRMaterial))throw Error(`${s}: Material type not supported`);let a=this._loader.loadMaterialPropertiesAsync(e,t,r);return r.needAlphaBlending()&&(r.forceDepthWrite=!0,r.separateCullingPass=!0),r.backFaceCulling=r.forceDepthWrite,r.twoSidedLighting=!0,a}return null})}}(0,a.GLTFLoader).RegisterExtension(o,e=>new i(e))},{"@babylonjs/core/Materials/PBR/pbrMaterial.js":"3wOWA","../glTFLoader.js":"lHQW2","@parcel/transformer-js/src/esmodule-helpers.js":"XTfsy"}],lyqob:[function(e,t,r){var s=e("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(r),s.export(r,"MSFT_sRGBFactors",()=>i);var n=e("@babylonjs/core/Materials/PBR/pbrMaterial.js"),a=e("../glTFLoader.js");let o="MSFT_sRGBFactors";class i{constructor(e){this.name=o,this._loader=e,this.enabled=this._loader.isExtensionUsed(o)}dispose(){this._loader=null}loadMaterialPropertiesAsync(e,t,r){return(0,a.GLTFLoader).LoadExtraAsync(e,t,this.name,(s,a)=>{if(a){if(!(r instanceof n.PBRMaterial))throw Error(`${s}: Material type not supported`);let a=this._loader.loadMaterialPropertiesAsync(e,t,r),o=r.getScene().getEngine().useExactSrgbConversions;return r.albedoTexture||r.albedoColor.toLinearSpaceToRef(r.albedoColor,o),r.reflectivityTexture||r.reflectivityColor.toLinearSpaceToRef(r.reflectivityColor,o),a}return null})}}(0,a.GLTFLoader).RegisterExtension(o,e=>new i(e))},{"@babylonjs/core/Materials/PBR/pbrMaterial.js":"3wOWA","../glTFLoader.js":"lHQW2","@parcel/transformer-js/src/esmodule-helpers.js":"XTfsy"}],bNByP:[function(e,t,r){var s=e("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(r),s.export(r,"KHR_interactivity",()=>d);var n=e("../glTFLoader.js"),a=e("@babylonjs/core/FlowGraph/flowGraphCoordinator.js"),o=e("@babylonjs/core/FlowGraph/flowGraph.js"),i=e("./interactivityFunctions.js"),l=e("./interactivityPathToObjectConverter.js");let c="KHR_interactivity";class d{constructor(e){this._loader=e,this.name=c,this.enabled=this._loader.isExtensionUsed(c),this._pathConverter=new l.InteractivityPathToObjectConverter(this._loader.gltf)}dispose(){this._loader=null,delete this._pathConverter}onReady(){if(!this._loader.babylonScene||!this._pathConverter)return;let e=this._loader.babylonScene,t=this._loader.gltf.extensions?.KHR_interactivity,r=(0,i.convertGLTFToSerializedFlowGraph)(t),s=new a.FlowGraphCoordinator({scene:e});(0,o.FlowGraph).Parse(r,{coordinator:s,pathConverter:this._pathConverter}),s.start()}}(0,n.GLTFLoader).RegisterExtension(c,e=>new d(e))},{"../glTFLoader.js":"lHQW2","@babylonjs/core/FlowGraph/flowGraphCoordinator.js":"i0yHU","@babylonjs/core/FlowGraph/flowGraph.js":"8hkIU","./interactivityFunctions.js":"5ji4r","./interactivityPathToObjectConverter.js":"8KnBg","@parcel/transformer-js/src/esmodule-helpers.js":"XTfsy"}],"5ji4r":[function(e,t,r){var s=e("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(r),s.export(r,"convertGLTFToSerializedFlowGraph",()=>l);var n=e("@babylonjs/core/Misc/guid.js"),a=e("./interactivityUtils.js"),o=e("@babylonjs/core/FlowGraph/flowGraphConnection.js");function i(e,t,r){if(void 0===e.type)return e.value;{let s=t.types&&t.types[e.type];if(!s)throw Error(`${r}: Unknown type: ${e.type}`);let n=s.signature;if(!n)throw Error(`${r}: Type ${e.type} has no signature`);let o=a.gltfTypeToBabylonType[n];return{value:e.value,className:o}}}function l(e){let t={uniqueId:(0,n.RandomGUID)(),_userVariables:{},_connectionValues:{}},r=[];for(let t=0;t<e.nodes.length;t++){let s=e.nodes[t],n=function(e,t,r){let s=a.gltfToFlowGraphTypeMap[t.type];if(!s)throw Error(`/extensions/KHR_interactivity/nodes/${e}: Unknown block type: ${t.type}`);let n=e.toString();return{className:s,config:function(e,t,r){let s={};for(let n of e.configuration??[])if("customEvent"===n.id){let e=t.customEvents&&t.customEvents[n.value];if(!e)throw Error(`/extensions/KHR_interactivity/nodes/${r}: Unknown custom event: ${n.value}`);s.eventId=e.id,s.eventData=e.values.map(e=>e.id)}else if("variable"===n.id){let e=t.variables&&t.variables[n.value];if(!e)throw Error(`/extensions/KHR_interactivity/nodes/${r}: Unknown variable: ${n.value}`);s.variableName=e.id}else if("path"===n.id){let e=n.value;s.path=e}else s[n.id]=i(n,t,`/extensions/KHR_interactivity/nodes/${r}`);return s}(t,r,n),uniqueId:n,metadata:t.metadata,dataInputs:[],dataOutputs:[],signalInputs:[],signalOutputs:[]}}(t,s,e);r.push(n)}for(let s=0;s<e.nodes.length;s++){let a=e.nodes[s],l=r[s];for(let e of a.flows??[]){let t=e.id,a={uniqueId:(0,n.RandomGUID)(),name:t,_connectionType:o.FlowGraphConnectionType.Output,connectedPointIds:[]};l.signalOutputs.push(a);let i=e.node,c=e.socket,d=r[i];if(!d)throw Error(`/extensions/KHR_interactivity/nodes/${s}: Could not find node with id ${i} that connects its input with with node ${s}'s output ${t}`);let h=d.signalInputs.find(e=>e.name===c);h||(h={uniqueId:(0,n.RandomGUID)(),name:c,_connectionType:o.FlowGraphConnectionType.Input,connectedPointIds:[]},d.signalInputs.push(h)),h.connectedPointIds.push(a.uniqueId),a.connectedPointIds.push(h.uniqueId)}for(let c of a.values??[]){let a=c.id,d={uniqueId:(0,n.RandomGUID)(),name:a,_connectionType:o.FlowGraphConnectionType.Input,connectedPointIds:[]};if(l.dataInputs.push(d),void 0!==c.value){let r=i(c,e,`/extensions/KHR_interactivity/nodes/${s}`);t._connectionValues[d.uniqueId]=r}else if(void 0!==c.node&&void 0!==c.socket){let e=c.node,t=c.socket,i=r[e];if(!i)throw Error(`/extensions/KHR_interactivity/nodes/${s}: Could not find node with id ${e} that connects its output with node${s}'s input ${a}`);let l=i.dataOutputs.find(e=>e.name===t);l||(l={uniqueId:(0,n.RandomGUID)(),name:t,_connectionType:o.FlowGraphConnectionType.Output,connectedPointIds:[]},i.dataOutputs.push(l)),d.connectedPointIds.push(l.uniqueId),l.connectedPointIds.push(d.uniqueId)}else throw Error(`/extensions/KHR_interactivity/nodes/${s}: Invalid socket ${a} in node ${s}`)}}let s=e.variables??[];for(let r=0;r<s.length;r++){let n=s[r],a=n.id;t._userVariables[a]=i(n,e,`/extensions/KHR_interactivity/variables/${r}`)}return{allBlocks:r,executionContexts:[t]}}},{"@babylonjs/core/Misc/guid.js":"aGfjE","./interactivityUtils.js":"d7WUq","@babylonjs/core/FlowGraph/flowGraphConnection.js":"gBdlo","@parcel/transformer-js/src/esmodule-helpers.js":"XTfsy"}],d7WUq:[function(e,t,r){var s=e("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(r),s.export(r,"gltfToFlowGraphTypeMap",()=>b),s.export(r,"gltfTypeToBabylonType",()=>g);var n=e("@babylonjs/core/FlowGraph/Blocks/Event/flowGraphSceneReadyEventBlock.js"),a=e("@babylonjs/core/FlowGraph/Blocks/Event/flowGraphSceneTickEventBlock.js"),o=e("@babylonjs/core/FlowGraph/Blocks/Execution/flowGraphConsoleLogBlock.js"),i=e("@babylonjs/core/FlowGraph/Blocks/Execution/ControlFlow/flowGraphTimerBlock.js"),l=e("@babylonjs/core/FlowGraph/Blocks/Execution/flowGraphSendCustomEventBlock.js"),c=e("@babylonjs/core/FlowGraph/Blocks/Event/flowGraphReceiveCustomEventBlock.js"),d=e("@babylonjs/core/FlowGraph/Blocks/Execution/ControlFlow/flowGraphSequenceBlock.js"),h=e("@babylonjs/core/FlowGraph/Blocks/Data/flowGraphGetPropertyBlock.js"),u=e("@babylonjs/core/FlowGraph/Blocks/Execution/flowGraphSetPropertyBlock.js"),_=e("@babylonjs/core/FlowGraph/Blocks/Data/Math/flowGraphMathBlocks.js"),p=e("@babylonjs/core/FlowGraph/Blocks/Execution/ControlFlow/flowGraphDoNBlock.js"),m=e("@babylonjs/core/FlowGraph/Blocks/Data/flowGraphGetVariableBlock.js"),f=e("@babylonjs/core/FlowGraph/Blocks/Execution/flowGraphSetVariableBlock.js"),y=e("@babylonjs/core/FlowGraph/Blocks/Execution/ControlFlow/flowGraphWhileLoopBlock.js");let b={"lifecycle/onStart":n.FlowGraphSceneReadyEventBlock.ClassName,"lifecycle/onTick":a.FlowGraphSceneTickEventBlock.ClassName,log:o.FlowGraphConsoleLogBlock.ClassName,"flow/delay":i.FlowGraphTimerBlock.ClassName,"customEvent/send":l.FlowGraphSendCustomEventBlock.ClassName,"customEvent/receive":c.FlowGraphReceiveCustomEventBlock.ClassName,"flow/sequence":d.FlowGraphSequenceBlock.ClassName,"world/get":h.FlowGraphGetPropertyBlock.ClassName,"world/set":u.FlowGraphSetPropertyBlock.ClassName,"flow/doN":p.FlowGraphDoNBlock.ClassName,"variable/get":m.FlowGraphGetVariableBlock.ClassName,"variable/set":f.FlowGraphSetVariableBlock.ClassName,"flow/whileLoop":y.FlowGraphWhileLoopBlock.ClassName,"math/random":_.FlowGraphRandomBlock.ClassName,"math/e":_.FlowGraphEBlock.ClassName,"math/pi":_.FlowGraphPiBlock.ClassName,"math/inf":_.FlowGraphInfBlock.ClassName,"math/nan":_.FlowGraphNaNBlock.ClassName,"math/abs":_.FlowGraphAbsBlock.ClassName,"math/sign":_.FlowGraphSignBlock.ClassName,"math/trunc":_.FlowGraphTruncBlock.ClassName,"math/floor":_.FlowGraphFloorBlock.ClassName,"math/ceil":_.FlowGraphCeilBlock.ClassName,"math/fract":_.FlowGraphFractBlock.ClassName,"math/neg":_.FlowGraphNegBlock.ClassName,"math/add":_.FlowGraphAddBlock.ClassName,"math/sub":_.FlowGraphSubtractBlock.ClassName,"math/mul":_.FlowGraphMultiplyBlock.ClassName,"math/div":_.FlowGraphDivideBlock.ClassName,"math/rem":_.FlowGraphRemainderBlock.ClassName,"math/min":_.FlowGraphMinBlock.ClassName,"math/max":_.FlowGraphMaxBlock.ClassName,"math/clamp":_.FlowGraphClampBlock.ClassName,"math/saturate":_.FlowGraphSaturateBlock.ClassName,"math/mix":_.FlowGraphInterpolateBlock.ClassName,"math/eq":_.FlowGraphEqBlock.ClassName,"math/lt":_.FlowGraphLessThanBlock.ClassName,"math/le":_.FlowGraphLessThanOrEqualBlock.ClassName,"math/gt":_.FlowGraphGreaterThanBlock.ClassName,"math/ge":_.FlowGraphGreaterThanOrEqualBlock.ClassName,"math/isnan":_.FlowGraphIsNanBlock.ClassName,"math/isinf":_.FlowGraphIsInfBlock.ClassName,"math/rad":_.FlowGraphDegToRadBlock.ClassName,"math/deg":_.FlowGraphRadToDegBlock.ClassName,"math/sin":_.FlowGraphSinBlock.ClassName,"math/cos":_.FlowGraphCosBlock.ClassName,"math/tan":_.FlowGraphTanBlock.ClassName,"math/asin":_.FlowGraphAsinBlock.ClassName,"math/acos":_.FlowGraphAcosBlock.ClassName,"math/atan":_.FlowGraphAtanBlock.ClassName,"math/atan2":_.FlowGraphAtan2Block.ClassName,"math/sinh":_.FlowGraphSinhBlock.ClassName,"math/cosh":_.FlowGraphCoshBlock.ClassName,"math/tanh":_.FlowGraphTanhBlock.ClassName,"math/asinh":_.FlowGraphAsinhBlock.ClassName,"math/acosh":_.FlowGraphAcoshBlock.ClassName,"math/atanh":_.FlowGraphAtanhBlock.ClassName,"math/exp":_.FlowGraphExpBlock.ClassName,"math/log":_.FlowGraphLogBlock.ClassName,"math/log2":_.FlowGraphLog2Block.ClassName,"math/log10":_.FlowGraphLog10Block.ClassName,"math/sqrt":_.FlowGraphSqrtBlock.ClassName,"math/cbrt":_.FlowGraphCubeRootBlock.ClassName,"math/pow":_.FlowGraphPowBlock.ClassName,"math/length":_.FlowGraphLengthBlock.ClassName,"math/normalize":_.FlowGraphNormalizeBlock.ClassName,"math/dot":_.FlowGraphDotBlock.ClassName,"math/cross":_.FlowGraphCrossBlock.ClassName,"math/rotate2d":_.FlowGraphRotate2DBlock.ClassName,"math/rotate3d":_.FlowGraphRotate3DBlock.ClassName,"math/transpose":_.FlowGraphTransposeBlock.ClassName,"math/determinant":_.FlowGraphDeterminantBlock.ClassName,"math/inverse":_.FlowGraphInvertMatrixBlock.ClassName,"math/matmul":_.FlowGraphMatMulBlock.ClassName,"math/not":_.FlowGraphBitwiseNotBlock.ClassName,"math/and":_.FlowGraphBitwiseAndBlock.ClassName,"math/or":_.FlowGraphBitwiseOrBlock.ClassName,"math/xor":_.FlowGraphBitwiseXorBlock.ClassName,"math/asr":_.FlowGraphBitwiseRightShiftBlock.ClassName,"math/lsl":_.FlowGraphBitwiseLeftShiftBlock.ClassName,"math/clz":_.FlowGraphCountLeadingZerosBlock.ClassName,"math/ctz":_.FlowGraphCountTrailingZerosBlock.ClassName,"math/popcnt":_.FlowGraphCountOneBitsBlock.ClassName},g={float2:"Vector2",float3:"Vector3",float4:"Vector4",float4x4:"Matrix",int:"FlowGraphInteger"}},{"@babylonjs/core/FlowGraph/Blocks/Event/flowGraphSceneReadyEventBlock.js":"dEET9","@babylonjs/core/FlowGraph/Blocks/Event/flowGraphSceneTickEventBlock.js":"eap16","@babylonjs/core/FlowGraph/Blocks/Execution/flowGraphConsoleLogBlock.js":"4GXac","@babylonjs/core/FlowGraph/Blocks/Execution/ControlFlow/flowGraphTimerBlock.js":"7sioM","@babylonjs/core/FlowGraph/Blocks/Execution/flowGraphSendCustomEventBlock.js":"ddK5T","@babylonjs/core/FlowGraph/Blocks/Event/flowGraphReceiveCustomEventBlock.js":"dxX0O","@babylonjs/core/FlowGraph/Blocks/Execution/ControlFlow/flowGraphSequenceBlock.js":"g70XY","@babylonjs/core/FlowGraph/Blocks/Data/flowGraphGetPropertyBlock.js":"hP6JY","@babylonjs/core/FlowGraph/Blocks/Execution/flowGraphSetPropertyBlock.js":"kCIYI","@babylonjs/core/FlowGraph/Blocks/Data/Math/flowGraphMathBlocks.js":"9XOUH","@babylonjs/core/FlowGraph/Blocks/Execution/ControlFlow/flowGraphDoNBlock.js":"jUACz","@babylonjs/core/FlowGraph/Blocks/Data/flowGraphGetVariableBlock.js":"j1PPJ","@babylonjs/core/FlowGraph/Blocks/Execution/flowGraphSetVariableBlock.js":"Vy95W","@babylonjs/core/FlowGraph/Blocks/Execution/ControlFlow/flowGraphWhileLoopBlock.js":"4V08Z","@parcel/transformer-js/src/esmodule-helpers.js":"XTfsy"}],"8KnBg":[function(e,t,r){var s=e("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(r),s.export(r,"InteractivityPathToObjectConverter",()=>a);var n=e("./gltfPathToObjectConverter.js");class a extends n.GLTFPathToObjectConverter{constructor(e){super(e,o)}}let o={nodes:{__array__:{__target__:!0,translation:{type:"Vector3",get:e=>e._babylonTransformNode.position,set:(e,t)=>{t._babylonTransformNode.position=e},getObject:e=>e._babylonTransformNode}}}}},{"./gltfPathToObjectConverter.js":"bSBwk","@parcel/transformer-js/src/esmodule-helpers.js":"XTfsy"}],"4HJMs":[function(e,t,r){var s=e("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(r),s.export(r,"ExtrasAsMetadata",()=>o);var n=e("../glTFLoader.js");let a="ExtrasAsMetadata";class o{_assignExtras(e,t){if(t.extras&&Object.keys(t.extras).length>0){let r=e.metadata=e.metadata||{};(r.gltf=r.gltf||{}).extras=t.extras}}constructor(e){this.name=a,this.enabled=!0,this._loader=e}dispose(){this._loader=null}loadNodeAsync(e,t,r){return this._loader.loadNodeAsync(e,t,e=>{this._assignExtras(e,t),r(e)})}loadCameraAsync(e,t,r){return this._loader.loadCameraAsync(e,t,e=>{this._assignExtras(e,t),r(e)})}createMaterial(e,t,r){let s=this._loader.createMaterial(e,t,r);return this._assignExtras(s,t),s}}(0,n.GLTFLoader).RegisterExtension(a,e=>new o(e))},{"../glTFLoader.js":"lHQW2","@parcel/transformer-js/src/esmodule-helpers.js":"XTfsy"}],"7qwNs":[function(e,t,r){var s=e("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(r);var n=e("./mtlFileLoader.js");s.exportAll(n,r);var a=e("./objLoadingOptions.js");s.exportAll(a,r);var o=e("./solidParser.js");s.exportAll(o,r);var i=e("./objFileLoader.js");s.exportAll(i,r)},{"./mtlFileLoader.js":"3MUIh","./objLoadingOptions.js":"9UNps","./solidParser.js":"cfof9","./objFileLoader.js":"6gBwq","@parcel/transformer-js/src/esmodule-helpers.js":"XTfsy"}],"3MUIh":[function(e,t,r){var s=e("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(r),s.export(r,"MTLFileLoader",()=>i);var n=e("@babylonjs/core/Maths/math.color.js"),a=e("@babylonjs/core/Materials/Textures/texture.js"),o=e("@babylonjs/core/Materials/standardMaterial.js");class i{constructor(){this.materials=[]}parseMTL(e,t,r,s){let a;if(t instanceof ArrayBuffer)return;let l=t.split("\n"),c=/\s+/,d=null;for(let t=0;t<l.length;t++){let h=l[t].trim();if(0===h.length||"#"===h.charAt(0))continue;let u=h.indexOf(" "),_=u>=0?h.substring(0,u):h;_=_.toLowerCase();let p=u>=0?h.substring(u+1).trim():"";if("newmtl"===_)d&&this.materials.push(d),e._blockEntityCollection=!!s,(d=new o.StandardMaterial(p,e))._parentContainer=s,e._blockEntityCollection=!1;else if("kd"===_&&d)a=p.split(c,3).map(parseFloat),d.diffuseColor=(0,n.Color3).FromArray(a);else if("ka"===_&&d)a=p.split(c,3).map(parseFloat),d.ambientColor=(0,n.Color3).FromArray(a);else if("ks"===_&&d)a=p.split(c,3).map(parseFloat),d.specularColor=(0,n.Color3).FromArray(a);else if("ke"===_&&d)a=p.split(c,3).map(parseFloat),d.emissiveColor=(0,n.Color3).FromArray(a);else if("ns"===_&&d)d.specularPower=parseFloat(p);else if("d"===_&&d)d.alpha=parseFloat(p);else if("map_ka"===_&&d)d.ambientTexture=i._GetTexture(r,p,e);else if("map_kd"===_&&d)d.diffuseTexture=i._GetTexture(r,p,e);else if("map_ks"===_&&d)d.specularTexture=i._GetTexture(r,p,e);else if("map_ns"===_);else if("map_bump"===_&&d){let t=p.split(c),s=t.indexOf("-bm"),n=null;s>=0&&(n=t[s+1],t.splice(s,2)),d.bumpTexture=i._GetTexture(r,t.join(" "),e),d.bumpTexture&&null!==n&&(d.bumpTexture.level=parseFloat(n))}else"map_d"===_&&d&&(d.opacityTexture=i._GetTexture(r,p,e))}d&&this.materials.push(d)}static _GetTexture(e,t,r){if(!t)return null;let s=e;if("file:"===e){let e=t.lastIndexOf("\\");-1===e&&(e=t.lastIndexOf("/")),e>-1?s+=t.substr(e+1):s+=t}else s+=t;return new a.Texture(s,r,!1,i.INVERT_TEXTURE_Y)}}i.INVERT_TEXTURE_Y=!0},{"@babylonjs/core/Maths/math.color.js":"78my4","@babylonjs/core/Materials/Textures/texture.js":"bYxw8","@babylonjs/core/Materials/standardMaterial.js":"9hjVc","@parcel/transformer-js/src/esmodule-helpers.js":"XTfsy"}],"9UNps":[function(e,t,r){e("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(r)},{"@parcel/transformer-js/src/esmodule-helpers.js":"XTfsy"}],cfof9:[function(e,t,r){var s=e("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(r),s.export(r,"SolidParser",()=>u);var n=e("@babylonjs/core/Buffers/buffer.js"),a=e("@babylonjs/core/Materials/standardMaterial.js"),o=e("@babylonjs/core/Maths/math.color.js"),i=e("@babylonjs/core/Maths/math.vector.js"),l=e("@babylonjs/core/Meshes/geometry.js"),c=e("@babylonjs/core/Meshes/mesh.js"),d=e("@babylonjs/core/Meshes/mesh.vertexData.js"),h=e("@babylonjs/core/Misc/logger.js");class u{constructor(e,t,r){this._positions=[],this._normals=[],this._uvs=[],this._colors=[],this._meshesFromObj=[],this._indicesForBabylon=[],this._wrappedPositionForBabylon=[],this._wrappedUvsForBabylon=[],this._wrappedColorsForBabylon=[],this._wrappedNormalsForBabylon=[],this._tuplePosNorm=[],this._curPositionInIndices=0,this._hasMeshes=!1,this._unwrappedPositionsForBabylon=[],this._unwrappedColorsForBabylon=[],this._unwrappedNormalsForBabylon=[],this._unwrappedUVForBabylon=[],this._triangles=[],this._materialNameFromObj="",this._objMeshName="",this._increment=1,this._isFirstMaterial=!0,this._grayColor=new o.Color4(.5,.5,.5,1),this._materialToUse=e,this._babylonMeshesArray=t,this._loadingOptions=r}_isInArray(e,t){e[t[0]]||(e[t[0]]={normals:[],idx:[]});let r=e[t[0]].normals.indexOf(t[1]);return -1===r?-1:e[t[0]].idx[r]}_isInArrayUV(e,t){e[t[0]]||(e[t[0]]={normals:[],idx:[],uv:[]});let r=e[t[0]].normals.indexOf(t[1]);return 1!=r&&t[2]===e[t[0]].uv[r]?e[t[0]].idx[r]:-1}_setData(e,t,r,s,n,a,o){let i;-1===(i=this._loadingOptions.optimizeWithUV?this._isInArrayUV(this._tuplePosNorm,[e,r,t]):this._isInArray(this._tuplePosNorm,[e,r]))?(this._indicesForBabylon.push(this._wrappedPositionForBabylon.length),this._wrappedPositionForBabylon.push(s),this._wrappedUvsForBabylon.push(n),this._wrappedNormalsForBabylon.push(a),void 0!==o&&this._wrappedColorsForBabylon.push(o),this._tuplePosNorm[e].normals.push(r),this._tuplePosNorm[e].idx.push(this._curPositionInIndices++),this._loadingOptions.optimizeWithUV&&this._tuplePosNorm[e].uv.push(t)):this._indicesForBabylon.push(i)}_unwrapData(){for(let e=0;e<this._wrappedPositionForBabylon.length;e++)this._unwrappedPositionsForBabylon.push(this._wrappedPositionForBabylon[e].x,this._wrappedPositionForBabylon[e].y,this._wrappedPositionForBabylon[e].z),this._unwrappedNormalsForBabylon.push(this._wrappedNormalsForBabylon[e].x,this._wrappedNormalsForBabylon[e].y,this._wrappedNormalsForBabylon[e].z),this._unwrappedUVForBabylon.push(this._wrappedUvsForBabylon[e].x,this._wrappedUvsForBabylon[e].y),this._loadingOptions.importVertexColors&&this._unwrappedColorsForBabylon.push(this._wrappedColorsForBabylon[e].r,this._wrappedColorsForBabylon[e].g,this._wrappedColorsForBabylon[e].b,this._wrappedColorsForBabylon[e].a);this._wrappedPositionForBabylon.length=0,this._wrappedNormalsForBabylon.length=0,this._wrappedUvsForBabylon.length=0,this._wrappedColorsForBabylon.length=0,this._tuplePosNorm.length=0,this._curPositionInIndices=0}_getTriangles(e,t){for(let r=t;r<e.length-1;r++)this._triangles.push(e[0],e[r],e[r+1])}_setDataForCurrentFaceWithPattern1(e,t){this._getTriangles(e,t);for(let e=0;e<this._triangles.length;e++){let t=parseInt(this._triangles[e])-1;this._setData(t,0,0,this._positions[t],(0,i.Vector2).Zero(),(0,i.Vector3).Up(),this._loadingOptions.importVertexColors?this._colors[t]:void 0)}this._triangles.length=0}_setDataForCurrentFaceWithPattern2(e,t){this._getTriangles(e,t);for(let e=0;e<this._triangles.length;e++){let t=this._triangles[e].split("/"),r=parseInt(t[0])-1,s=parseInt(t[1])-1;this._setData(r,s,0,this._positions[r],this._uvs[s],(0,i.Vector3).Up(),this._loadingOptions.importVertexColors?this._colors[r]:void 0)}this._triangles.length=0}_setDataForCurrentFaceWithPattern3(e,t){this._getTriangles(e,t);for(let e=0;e<this._triangles.length;e++){let t=this._triangles[e].split("/"),r=parseInt(t[0])-1,s=parseInt(t[1])-1,n=parseInt(t[2])-1;this._setData(r,s,n,this._positions[r],this._uvs[s],this._normals[n])}this._triangles.length=0}_setDataForCurrentFaceWithPattern4(e,t){this._getTriangles(e,t);for(let e=0;e<this._triangles.length;e++){let t=this._triangles[e].split("//"),r=parseInt(t[0])-1,s=parseInt(t[1])-1;this._setData(r,1,s,this._positions[r],(0,i.Vector2).Zero(),this._normals[s],this._loadingOptions.importVertexColors?this._colors[r]:void 0)}this._triangles.length=0}_setDataForCurrentFaceWithPattern5(e,t){this._getTriangles(e,t);for(let e=0;e<this._triangles.length;e++){let t=this._triangles[e].split("/"),r=this._positions.length+parseInt(t[0]),s=this._uvs.length+parseInt(t[1]),n=this._normals.length+parseInt(t[2]);this._setData(r,s,n,this._positions[r],this._uvs[s],this._normals[n],this._loadingOptions.importVertexColors?this._colors[r]:void 0)}this._triangles.length=0}_addPreviousObjMesh(){this._meshesFromObj.length>0&&(this._handledMesh=this._meshesFromObj[this._meshesFromObj.length-1],this._unwrapData(),this._indicesForBabylon.reverse(),this._handledMesh.indices=this._indicesForBabylon.slice(),this._handledMesh.positions=this._unwrappedPositionsForBabylon.slice(),this._handledMesh.normals=this._unwrappedNormalsForBabylon.slice(),this._handledMesh.uvs=this._unwrappedUVForBabylon.slice(),this._loadingOptions.importVertexColors&&(this._handledMesh.colors=this._unwrappedColorsForBabylon.slice()),this._indicesForBabylon.length=0,this._unwrappedPositionsForBabylon.length=0,this._unwrappedColorsForBabylon.length=0,this._unwrappedNormalsForBabylon.length=0,this._unwrappedUVForBabylon.length=0)}_optimizeNormals(e){let t=e.getVerticesData(n.VertexBuffer.PositionKind),r=e.getVerticesData(n.VertexBuffer.NormalKind),s={};if(!t||!r)return;for(let e=0;e<t.length/3;e++){let r=t[3*e+0]+"_"+t[3*e+1]+"_"+t[3*e+2],n=s[r];n||(n=[],s[r]=n),n.push(e)}let a=new i.Vector3;for(let e in s){let t=s[e];if(t.length<2)continue;let n=t[0];for(let e=1;e<t.length;++e){let s=t[e];r[3*n+0]+=r[3*s+0],r[3*n+1]+=r[3*s+1],r[3*n+2]+=r[3*s+2]}a.copyFromFloats(r[3*n+0],r[3*n+1],r[3*n+2]),a.normalize();for(let e=0;e<t.length;++e){let s=t[e];r[3*s+0]=a.x,r[3*s+1]=a.y,r[3*s+2]=a.z}}e.setVerticesData(n.VertexBuffer.NormalKind,r)}parse(e,t,r,s,n){let _=t.split("\n");for(let e=0;e<_.length;e++){let t;let r=_[e].trim().replace(/\s\s/g," ");if(0!==r.length&&"#"!==r.charAt(0)){if(u.VertexPattern.test(r)){if(t=r.match(/[^ ]+/g),this._positions.push(new i.Vector3(parseFloat(t[1]),parseFloat(t[2]),parseFloat(t[3]))),this._loadingOptions.importVertexColors){if(t.length>=7){let e=parseFloat(t[4]),r=parseFloat(t[5]),s=parseFloat(t[6]);this._colors.push(new o.Color4(e>1?e/255:e,r>1?r/255:r,s>1?s/255:s,7===t.length||void 0===t[7]?1:parseFloat(t[7])))}else this._colors.push(this._grayColor)}}else if(null!==(t=u.NormalPattern.exec(r)))this._normals.push(new i.Vector3(parseFloat(t[1]),parseFloat(t[2]),parseFloat(t[3])));else if(null!==(t=u.UVPattern.exec(r)))this._uvs.push(new i.Vector2(parseFloat(t[1])*this._loadingOptions.UVScaling.x,parseFloat(t[2])*this._loadingOptions.UVScaling.y));else if(null!==(t=u.FacePattern3.exec(r)))this._setDataForCurrentFaceWithPattern3(t[1].trim().split(" "),1);else if(null!==(t=u.FacePattern4.exec(r)))this._setDataForCurrentFaceWithPattern4(t[1].trim().split(" "),1);else if(null!==(t=u.FacePattern5.exec(r)))this._setDataForCurrentFaceWithPattern5(t[1].trim().split(" "),1);else if(null!==(t=u.FacePattern2.exec(r)))this._setDataForCurrentFaceWithPattern2(t[1].trim().split(" "),1);else if(null!==(t=u.FacePattern1.exec(r)))this._setDataForCurrentFaceWithPattern1(t[1].trim().split(" "),1);else if(null!==(t=u.LinePattern1.exec(r)))this._setDataForCurrentFaceWithPattern1(t[1].trim().split(" "),0);else if(null!==(t=u.LinePattern2.exec(r)))this._setDataForCurrentFaceWithPattern2(t[1].trim().split(" "),0);else if(null!==(t=u.LinePattern3.exec(r)))this._setDataForCurrentFaceWithPattern3(t[1].trim().split(" "),0);else if(u.GroupDescriptor.test(r)||u.ObjectDescriptor.test(r)){let e={name:r.substring(2).trim(),indices:void 0,positions:void 0,normals:void 0,uvs:void 0,colors:void 0,materialName:this._materialNameFromObj,isObject:u.ObjectDescriptor.test(r)};this._addPreviousObjMesh(),this._meshesFromObj.push(e),this._hasMeshes=!0,this._isFirstMaterial=!0,this._increment=1}else if(u.UseMtlDescriptor.test(r)){if(this._materialNameFromObj=r.substring(7).trim(),!this._isFirstMaterial||!this._hasMeshes){this._addPreviousObjMesh();let e={name:(this._objMeshName||"mesh")+"_mm"+this._increment.toString(),indices:void 0,positions:void 0,normals:void 0,uvs:void 0,colors:void 0,materialName:this._materialNameFromObj,isObject:!1};this._increment++,this._meshesFromObj.push(e),this._hasMeshes=!0}this._hasMeshes&&this._isFirstMaterial&&(this._meshesFromObj[this._meshesFromObj.length-1].materialName=this._materialNameFromObj,this._isFirstMaterial=!1)}else u.MtlLibGroupDescriptor.test(r)?n(r.substring(7).trim()):u.SmoothDescriptor.test(r)||(0,h.Logger).Log("Unhandled expression at line : "+r)}}if(this._hasMeshes&&(this._handledMesh=this._meshesFromObj[this._meshesFromObj.length-1],this._indicesForBabylon.reverse(),this._unwrapData(),this._handledMesh.indices=this._indicesForBabylon,this._handledMesh.positions=this._unwrappedPositionsForBabylon,this._handledMesh.normals=this._unwrappedNormalsForBabylon,this._handledMesh.uvs=this._unwrappedUVForBabylon,this._loadingOptions.importVertexColors&&(this._handledMesh.colors=this._unwrappedColorsForBabylon)),!this._hasMeshes){let e=null;if(this._indicesForBabylon.length)this._indicesForBabylon.reverse(),this._unwrapData();else{for(let e of this._positions)this._unwrappedPositionsForBabylon.push(e.x,e.y,e.z);if(this._normals.length)for(let e of this._normals)this._unwrappedNormalsForBabylon.push(e.x,e.y,e.z);if(this._uvs.length)for(let e of this._uvs)this._unwrappedUVForBabylon.push(e.x,e.y);if(this._colors.length)for(let e of this._colors)this._unwrappedColorsForBabylon.push(e.r,e.g,e.b,e.a);this._materialNameFromObj||((e=new a.StandardMaterial((0,l.Geometry).RandomId(),r)).pointsCloud=!0,this._materialNameFromObj=e.name,this._normals.length||(e.disableLighting=!0,e.emissiveColor=(0,o.Color3).White()))}this._meshesFromObj.push({name:(0,l.Geometry).RandomId(),indices:this._indicesForBabylon,positions:this._unwrappedPositionsForBabylon,colors:this._unwrappedColorsForBabylon,normals:this._unwrappedNormalsForBabylon,uvs:this._unwrappedUVForBabylon,materialName:this._materialNameFromObj,directMaterial:e,isObject:!0})}for(let t=0;t<this._meshesFromObj.length;t++){if(e&&this._meshesFromObj[t].name){if(e instanceof Array){if(-1===e.indexOf(this._meshesFromObj[t].name))continue}else if(this._meshesFromObj[t].name!==e)continue}this._handledMesh=this._meshesFromObj[t],r._blockEntityCollection=!!s;let n=new c.Mesh(this._meshesFromObj[t].name,r);if(n._parentContainer=s,r._blockEntityCollection=!1,this._handledMesh._babylonMesh=n,!this._handledMesh.isObject){for(let e=t-1;e>=0;--e)if(this._meshesFromObj[e].isObject&&this._meshesFromObj[e]._babylonMesh){n.parent=this._meshesFromObj[e]._babylonMesh;break}}if(this._materialToUse.push(this._meshesFromObj[t].materialName),this._handledMesh.positions?.length===0){this._babylonMeshesArray.push(n);continue}let a=new d.VertexData;if(a.uvs=this._handledMesh.uvs,a.indices=this._handledMesh.indices,a.positions=this._handledMesh.positions,this._loadingOptions.computeNormals){let e=[];(0,d.VertexData).ComputeNormals(this._handledMesh.positions,this._handledMesh.indices,e),a.normals=e}else a.normals=this._handledMesh.normals;this._loadingOptions.importVertexColors&&(a.colors=this._handledMesh.colors),a.applyToMesh(n),this._loadingOptions.invertY&&(n.scaling.y*=-1),this._loadingOptions.optimizeNormals&&this._optimizeNormals(n),this._babylonMeshesArray.push(n),this._handledMesh.directMaterial&&(n.material=this._handledMesh.directMaterial)}}}u.ObjectDescriptor=/^o/,u.GroupDescriptor=/^g/,u.MtlLibGroupDescriptor=/^mtllib /,u.UseMtlDescriptor=/^usemtl /,u.SmoothDescriptor=/^s /,u.VertexPattern=/^v(\s+[\d|.|+|\-|e|E]+){3,7}/,u.NormalPattern=/^vn(\s+[\d|.|+|\-|e|E]+)( +[\d|.|+|\-|e|E]+)( +[\d|.|+|\-|e|E]+)/,u.UVPattern=/^vt(\s+[\d|.|+|\-|e|E]+)( +[\d|.|+|\-|e|E]+)/,u.FacePattern1=/^f\s+(([\d]{1,}[\s]?){3,})+/,u.FacePattern2=/^f\s+((([\d]{1,}\/[\d]{1,}[\s]?){3,})+)/,u.FacePattern3=/^f\s+((([\d]{1,}\/[\d]{1,}\/[\d]{1,}[\s]?){3,})+)/,u.FacePattern4=/^f\s+((([\d]{1,}\/\/[\d]{1,}[\s]?){3,})+)/,u.FacePattern5=/^f\s+(((-[\d]{1,}\/-[\d]{1,}\/-[\d]{1,}[\s]?){3,})+)/,u.LinePattern1=/^l\s+(([\d]{1,}[\s]?){2,})+/,u.LinePattern2=/^l\s+((([\d]{1,}\/[\d]{1,}[\s]?){2,})+)/,u.LinePattern3=/^l\s+((([\d]{1,}\/[\d]{1,}\/[\d]{1,}[\s]?){2,})+)/},{"@babylonjs/core/Buffers/buffer.js":"aDZlT","@babylonjs/core/Materials/standardMaterial.js":"9hjVc","@babylonjs/core/Maths/math.color.js":"78my4","@babylonjs/core/Maths/math.vector.js":"h33gd","@babylonjs/core/Meshes/geometry.js":"lnjEm","@babylonjs/core/Meshes/mesh.js":"9vBao","@babylonjs/core/Meshes/mesh.vertexData.js":"apU8X","@babylonjs/core/Misc/logger.js":"5C8M2","@parcel/transformer-js/src/esmodule-helpers.js":"XTfsy"}],"6gBwq":[function(e,t,r){var s=e("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(r),s.export(r,"OBJFileLoader",()=>d);var n=e("@babylonjs/core/Maths/math.vector.js"),a=e("@babylonjs/core/Misc/tools.js"),o=e("@babylonjs/core/Loading/sceneLoader.js"),i=e("@babylonjs/core/assetContainer.js"),l=e("./mtlFileLoader.js"),c=e("./solidParser.js");class d{static get INVERT_TEXTURE_Y(){return l.MTLFileLoader.INVERT_TEXTURE_Y}static set INVERT_TEXTURE_Y(e){l.MTLFileLoader.INVERT_TEXTURE_Y=e}constructor(e){this.name="obj",this.extensions=".obj",this._assetContainer=null,this._loadingOptions=e||d._DefaultLoadingOptions}static get _DefaultLoadingOptions(){return{computeNormals:d.COMPUTE_NORMALS,optimizeNormals:d.OPTIMIZE_NORMALS,importVertexColors:d.IMPORT_VERTEX_COLORS,invertY:d.INVERT_Y,invertTextureY:d.INVERT_TEXTURE_Y,UVScaling:d.UV_SCALING,materialLoadingFailsSilently:d.MATERIAL_LOADING_FAILS_SILENTLY,optimizeWithUV:d.OPTIMIZE_WITH_UV,skipMaterials:d.SKIP_MATERIALS}}_loadMTL(e,t,r,s){let n=t+e;(0,a.Tools).LoadFile(n,r,void 0,void 0,!1,(e,t)=>{s(n,t)})}createPlugin(){return new d(d._DefaultLoadingOptions)}canDirectLoad(){return!1}importMeshAsync(e,t,r,s){return this._parseSolid(e,t,r,s).then(e=>({meshes:e,particleSystems:[],skeletons:[],animationGroups:[],transformNodes:[],geometries:[],lights:[]}))}loadAsync(e,t,r){return this.importMeshAsync(null,e,t,r).then(()=>{})}loadAssetContainerAsync(e,t,r){let s=new i.AssetContainer(e);return this._assetContainer=s,this.importMeshAsync(null,e,t,r).then(e=>(e.meshes.forEach(e=>s.meshes.push(e)),e.meshes.forEach(e=>{let t=e.material;t&&-1==s.materials.indexOf(t)&&(s.materials.push(t),t.getActiveTextures().forEach(e=>{-1==s.textures.indexOf(e)&&s.textures.push(e)}))}),this._assetContainer=null,s)).catch(e=>{throw this._assetContainer=null,e})}_parseSolid(e,t,r,s){let n="",o=new l.MTLFileLoader,i=[],d=[];new c.SolidParser(i,d,this._loadingOptions).parse(e,r,t,this._assetContainer,e=>{n=e});let h=[];return""===n||this._loadingOptions.skipMaterials||h.push(new Promise((e,r)=>{this._loadMTL(n,s,l=>{try{o.parseMTL(t,l,s,this._assetContainer);for(let e=0;e<o.materials.length;e++){let t,r=0,s=[];for(;(t=i.indexOf(o.materials[e].name,r))>-1;)s.push(t),r=t+1;if(-1===t&&0===s.length)o.materials[e].dispose();else for(let t=0;t<s.length;t++){let r=d[s[t]],n=o.materials[e];r.material=n,r.getTotalIndices()||(n.pointsCloud=!0)}}e()}catch(t){(0,a.Tools).Warn(`Error processing MTL file: '${n}'`),this._loadingOptions.materialLoadingFailsSilently?e():r(t)}},(t,s)=>{(0,a.Tools).Warn(`Error downloading MTL file: '${n}'`),this._loadingOptions.materialLoadingFailsSilently?e():r(s)})})),Promise.all(h).then(()=>d)}}d.OPTIMIZE_WITH_UV=!0,d.INVERT_Y=!1,d.IMPORT_VERTEX_COLORS=!1,d.COMPUTE_NORMALS=!1,d.OPTIMIZE_NORMALS=!1,d.UV_SCALING=new n.Vector2(1,1),d.SKIP_MATERIALS=!1,d.MATERIAL_LOADING_FAILS_SILENTLY=!0,o.SceneLoader&&(0,o.SceneLoader).RegisterPlugin(new d)},{"@babylonjs/core/Maths/math.vector.js":"h33gd","@babylonjs/core/Misc/tools.js":"ieufJ","@babylonjs/core/Loading/sceneLoader.js":"8wULc","@babylonjs/core/assetContainer.js":"133YM","./mtlFileLoader.js":"3MUIh","./solidParser.js":"cfof9","@parcel/transformer-js/src/esmodule-helpers.js":"XTfsy"}],hovy3:[function(e,t,r){var s=e("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(r);var n=e("./stlFileLoader.js");s.exportAll(n,r)},{"./stlFileLoader.js":"juzY4","@parcel/transformer-js/src/esmodule-helpers.js":"XTfsy"}],juzY4:[function(e,t,r){var s=e("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(r),s.export(r,"STLFileLoader",()=>c);var n=e("@babylonjs/core/Misc/tools.js"),a=e("@babylonjs/core/Buffers/buffer.js"),o=e("@babylonjs/core/Meshes/mesh.js"),i=e("@babylonjs/core/Loading/sceneLoader.js"),l=e("@babylonjs/core/assetContainer.js");class c{constructor(){this.solidPattern=/solid (\S*)([\S\s]*?)endsolid[ ]*(\S*)/g,this.facetsPattern=/facet([\s\S]*?)endfacet/g,this.normalPattern=/normal[\s]+([-+]?[0-9]+\.?[0-9]*([eE][-+]?[0-9]+)?)+[\s]+([-+]?[0-9]*\.?[0-9]+([eE][-+]?[0-9]+)?)+[\s]+([-+]?[0-9]*\.?[0-9]+([eE][-+]?[0-9]+)?)+/g,this.vertexPattern=/vertex[\s]+([-+]?[0-9]+\.?[0-9]*([eE][-+]?[0-9]+)?)+[\s]+([-+]?[0-9]*\.?[0-9]+([eE][-+]?[0-9]+)?)+[\s]+([-+]?[0-9]*\.?[0-9]+([eE][-+]?[0-9]+)?)+/g,this.name="stl",this.extensions={".stl":{isBinary:!0}}}importMesh(e,t,r,s,a){let i;if("string"!=typeof r){if(this._isBinary(r)){let e=new o.Mesh("stlmesh",t);return this._parseBinary(e,r),a&&a.push(e),!0}r=new TextDecoder().decode(new Uint8Array(r))}for(;i=this.solidPattern.exec(r);){let r=i[1],s=i[3];if(s&&r!=s)return(0,n.Tools).Error("Error in STL, solid name != endsolid name"),!1;if(e&&r){if(e instanceof Array){if(!e.indexOf(r))continue}else if(r!==e)continue}r=r||"stlmesh";let l=new o.Mesh(r,t);this._parseASCII(l,i[2]),a&&a.push(l)}return!0}load(e,t,r){return this.importMesh(null,e,t,r,null)}loadAssetContainer(e,t,r){let s=new l.AssetContainer(e);return e._blockEntityCollection=!0,this.importMesh(null,e,t,r,s.meshes),e._blockEntityCollection=!1,s}_isBinary(e){let t=new DataView(e);if(t.byteLength<=80)return!1;if(84+50*t.getUint32(80,!0)===t.byteLength)return!0;let r=[115,111,108,105,100];for(let e=0;e<5;e++)if(t.getUint8(e)!==r[e])return!0;return!1}_parseBinary(e,t){let r=new DataView(t),s=r.getUint32(80,!0),n=0,o=new Float32Array(9*s),i=new Float32Array(9*s),l=new Uint32Array(3*s),d=0;for(let e=0;e<s;e++){let t=84+50*e,s=r.getFloat32(t,!0),a=r.getFloat32(t+4,!0),h=r.getFloat32(t+8,!0);for(let e=1;e<=3;e++){let l=t+12*e;o[n]=r.getFloat32(l,!0),i[n]=s,c.DO_NOT_ALTER_FILE_COORDINATES?(o[n+1]=r.getFloat32(l+4,!0),o[n+2]=r.getFloat32(l+8,!0),i[n+1]=a,i[n+2]=h):(o[n+2]=r.getFloat32(l+4,!0),o[n+1]=r.getFloat32(l+8,!0),i[n+2]=a,i[n+1]=h),n+=3}c.DO_NOT_ALTER_FILE_COORDINATES?(l[d]=d,l[d+1]=d+2,l[d+2]=d+1,d+=3):(l[d]=d++,l[d]=d++,l[d]=d++)}e.setVerticesData(a.VertexBuffer.PositionKind,o),e.setVerticesData(a.VertexBuffer.NormalKind,i),e.setIndices(l),e.computeWorldMatrix(!0)}_parseASCII(e,t){let r;let s=[],n=[],o=[],i=0;for(;r=this.facetsPattern.exec(t);){let e;let t=r[1],a=this.normalPattern.exec(t);if(this.normalPattern.lastIndex=0,!a)continue;let l=[Number(a[1]),Number(a[5]),Number(a[3])];for(;e=this.vertexPattern.exec(t);)c.DO_NOT_ALTER_FILE_COORDINATES?(s.push(Number(e[1]),Number(e[3]),Number(e[5])),n.push(l[0],l[2],l[1])):(s.push(Number(e[1]),Number(e[5]),Number(e[3])),n.push(l[0],l[1],l[2]));c.DO_NOT_ALTER_FILE_COORDINATES?(o.push(i,i+2,i+1),i+=3):o.push(i++,i++,i++),this.vertexPattern.lastIndex=0}this.facetsPattern.lastIndex=0,e.setVerticesData(a.VertexBuffer.PositionKind,s),e.setVerticesData(a.VertexBuffer.NormalKind,n),e.setIndices(o),e.computeWorldMatrix(!0)}}c.DO_NOT_ALTER_FILE_COORDINATES=!1,i.SceneLoader&&(0,i.SceneLoader).RegisterPlugin(new c)},{"@babylonjs/core/Misc/tools.js":"ieufJ","@babylonjs/core/Buffers/buffer.js":"aDZlT","@babylonjs/core/Meshes/mesh.js":"9vBao","@babylonjs/core/Loading/sceneLoader.js":"8wULc","@babylonjs/core/assetContainer.js":"133YM","@parcel/transformer-js/src/esmodule-helpers.js":"XTfsy"}],lB3Rc:[function(e,t,r){var s=e("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(r);var n=e("./splatFileLoader.js");s.exportAll(n,r)},{"./splatFileLoader.js":"9sWYL","@parcel/transformer-js/src/esmodule-helpers.js":"XTfsy"}],"9sWYL":[function(e,t,r){var s=e("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(r),s.export(r,"SPLATFileLoader",()=>i);var n=e("@babylonjs/core/Loading/sceneLoader.js"),a=e("@babylonjs/core/Maths/math.vector.js"),o=e("@babylonjs/core/Meshes/GaussianSplatting/gaussianSplattingMesh.js");class i{constructor(){this.name="splat",this.extensions={".splat":{isBinary:!0},".ply":{isBinary:!0}}}createPlugin(){return new i}canDirectLoad(){return!1}_loadPLY(e){let t=new Uint8Array(e),r=new TextDecoder().decode(t.slice(0,10240)),s="end_header\n",n=r.indexOf(s);if(n<0||!r)return e;let o=parseInt(/element vertex (\d+)\n/.exec(r)[1]),i=0,l={double:8,int:4,uint:4,float:4,short:2,ushort:2,uchar:1},c=[];for(let e of r.slice(0,n).split("\n").filter(e=>e.startsWith("property "))){let[,t,r]=e.split(" ");if(c.push({name:r,type:t,offset:i}),!l[t])throw Error(`Unsupported property type: ${t}`);i+=l[t]}let d=new DataView(e,n+s.length),h=new ArrayBuffer(32*o),u=new a.Quaternion;for(let e=0;e<o;e++){let t=new Float32Array(h,32*e,3),r=new Float32Array(h,32*e+12,3),s=new Uint8ClampedArray(h,32*e+24,4),n=new Uint8ClampedArray(h,32*e+28,4),a=255,o=0,l=0,_=0;for(let n=0;n<c.length;n++){let h;let u=c[n];switch(u.type){case"float":h=d.getFloat32(u.offset+e*i,!0);break;case"int":h=d.getInt32(u.offset+e*i,!0);break;default:throw Error(`Unsupported property type: ${u.type}`)}switch(u.name){case"x":t[0]=h;break;case"y":t[1]=h;break;case"z":t[2]=h;break;case"scale_0":r[0]=Math.exp(h);break;case"scale_1":r[1]=Math.exp(h);break;case"scale_2":r[2]=Math.exp(h);break;case"red":s[0]=h;break;case"green":s[1]=h;break;case"blue":s[2]=h;break;case"f_dc_0":s[0]=(.5+.28209479177387814*h)*255;break;case"f_dc_1":s[1]=(.5+.28209479177387814*h)*255;break;case"f_dc_2":s[2]=(.5+.28209479177387814*h)*255;break;case"f_dc_3":s[3]=(.5+.28209479177387814*h)*255;break;case"opacity":s[3]=1/(1+Math.exp(-h))*255;break;case"rot_0":a=h;break;case"rot_1":o=h;break;case"rot_2":l=h;break;case"rot_3":_=h}}u.set(o,l,_,a),u.normalize(),n[0]=128*u.w+128,n[1]=128*u.x+128,n[2]=128*u.y+128,n[3]=128*u.z+128}return h}async importMeshAsync(e,t,r,s){let n=new o.GaussianSplattingMesh("GaussianSplatting",null,t);return await n.loadFileAsync(s),{meshes:[n],particleSystems:[],skeletons:[],animationGroups:[],transformNodes:[],geometries:[],lights:[]}}loadAsync(e,t,r){return new o.GaussianSplattingMesh("GaussianSplatting",null,e).loadDataAsync(this._loadPLY(t))}loadAssetContainerAsync(e,t,r){throw Error("loadAssetContainerAsync not implemented for Gaussian Splatting loading")}}n.SceneLoader&&(0,n.SceneLoader).RegisterPlugin(new i)},{"@babylonjs/core/Loading/sceneLoader.js":"8wULc","@babylonjs/core/Maths/math.vector.js":"h33gd","@babylonjs/core/Meshes/GaussianSplatting/gaussianSplattingMesh.js":"kdFNc","@parcel/transformer-js/src/esmodule-helpers.js":"XTfsy"}],fc3Dq:[function(e,t,r){t.exports=e("16d83e33811b5579")(e("a7099d7889fe0857").resolve("6u5Ya")).then(()=>t.bundle.root("isQMz"))},{"16d83e33811b5579":"dBBqP",a7099d7889fe0857:"2ncQC"}],dBBqP:[function(e,t,r){var s=e("ca2a84f7fa4a3bb0");t.exports=s(function(e){return new Promise(function(t,r){if([].concat(document.getElementsByTagName("script")).some(function(t){return t.src===e})){t();return}var s=document.createElement("link");s.href=e,s.rel="preload",s.as="script",document.head.appendChild(s);var n=document.createElement("script");n.async=!0,n.type="text/javascript",n.src=e,n.onerror=function(t){var s=TypeError("Failed to fetch dynamically imported module: ".concat(e,". Error: ").concat(t.message));n.onerror=n.onload=null,n.remove(),r(s)},n.onload=function(){n.onerror=n.onload=null,t()},document.getElementsByTagName("head")[0].appendChild(n)})})},{ca2a84f7fa4a3bb0:"luZuz"}],luZuz:[function(e,t,r){var s={},n={},a={};t.exports=function(e,t){return function(r){var o=function(e){switch(e){case"preload":return n;case"prefetch":return a;default:return s}}(t);return o[r]?o[r]:o[r]=e.apply(null,arguments).catch(function(e){throw delete o[r],e})}}},{}],"6GK3Y":[function(e,t,r){t.exports=e("64761c9b6cae049d")(e("4cf6144cf83607a0").resolve("kbAYj")).then(()=>t.bundle.root("eXVRz"))},{"64761c9b6cae049d":"dBBqP","4cf6144cf83607a0":"2ncQC"}]},["g9s12"],"g9s12","parcelRequire6b9f");