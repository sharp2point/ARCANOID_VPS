function e(e,n,t,o){Object.defineProperty(e,n,{get:t,set:o,enumerable:!0,configurable:!0})}var n=globalThis.parcelRequire6b9f,t=n.register;t("2HvrB",function(t,o){e(t.exports,"UIScene",()=>c);var i=n("9W2ra"),a=n("4Gfgx"),r=n("iGzOG"),l=n("eF1lW"),s=n("hBMQ6");function c(){(0,a.getInnerWindow)();let e=new r.Scene(i.UISTATE.Engine);e.clearColor=new r.Color4(1,1,1,0),e.ambientColor=new r.Color3(1,1,1);let n=new r.UniversalCamera("ui-camera",new r.Vector3(0,30,0),e);n.fov=(0,r.Tools).ToRadians(70),n.target=new r.Vector3(0,0,0),i.UISTATE.Camera=n;let t=new r.HemisphericLight("ui-light",new r.Vector3(0,1,0),e);t.diffuse=new r.Color3(.5,.5,.5),t.specular=new r.Color3(0,0,0),t.intensity=.1;let o=new r.SpotLight("spot-1",new r.Vector3(0,30,0),new r.Vector3(0,-1,0),(0,r.Tools).ToRadians(60),30,e);o.diffuse=new r.Color3(1,1,1),o.specular=new r.Color3(0,0,0),o.intensity=.9,o.shadowEnabled=!0,function(e){let n=(0,a.getInnerWindow)(),t=(0,r.MeshBuilder).CreateGround("ground",{width:n.width,height:n.height},e);t.receiveShadows=!0;let o=new r.StandardMaterial("ground-mt",e);o.diffuseColor=new r.Color3(.1,.1,.3),o.maxSimultaneousLights=10,t.material=o}(e),e.onReadyObservable.add(()=>{(0,l.backSetOpaq_0)(),(0,s.spinMenu2)(e)}),e.onPointerDown=(e,n,t)=>{},e.onPointerMove=(e,n,t)=>{},i.UISTATE.Scene=e}}),t("hBMQ6",function(t,o){e(t.exports,"spinMenu2",()=>d);var i=n("cwyqU"),a=n("dHlpp"),r=n("hKERU"),l=n("iGzOG"),s=n("eF1lW"),c=n("h4W9d");let u={border:null,center:null,level:null,numbers:new Map},m={count:6,radius:14,position:new l.Vector3(0,0,15),angle:0,angleDelta:0,focusItem:null,items:new Map,scaleDeterminant:1,scaleDeterminantMax:1.5};async function d(e){let n=!1,t=null,o=await function(e,n,t,o){let i=new l.TransformNode("menu-tn",o);m.angle=360/t,m.angleDelta=1.5*m.angle;let a=[];return[...Array(t).keys()].forEach(e=>{a.push(g(`item-${e}`,{index:e,angle:m.angle*e+m.angleDelta},o))}),new Promise(t=>{Promise.all(a).then(o=>{o.forEach((e,t)=>{var o;m.items.set(t,e),e.scalingDeterminant=m.scaleDeterminant,e.setParent(i),o=new l.Vector3(Math.cos((0,l.Tools).ToRadians(m.angle*t))*n,0,Math.sin((0,l.Tools).ToRadians(m.angle*t))*n),e.position=o}),i.rotation.y=(0,l.Tools).ToRadians(m.angleDelta),i.position=e,t(i)})})}(m.position,m.radius,m.count,e);b(0,o,e),(0,c.getResultsIDB)().then(e=>{let n=e.filter(e=>m.focusItem.meta.index===e.level),t=n[0];for(let e=1;e<n.length;e++)t.score<n[e].score&&(t=n[e]);t?(0,s.redrawResult)(t.isWin,t.score):(0,s.redrawResult)(!1,0),(0,s.showResult)(!0)}),(0,s.redrawLevelDescription)(1,0,a.GameState.state.lang),(0,s.showDescription)(!0),function(e,n){let t=document.querySelector(".left-menu-button"),o=document.querySelector(".right-menu-button");t.addEventListener("click",()=>{h(e,n)}),o.addEventListener("click",()=>{T(e,n)}),(0,s.showSpinMenuButtons)(!0)}(o,e),e.onPointerDown=(o,i,r)=>{let l=e.pick(e.pointerX,e.pointerY,()=>!0);l.pickedMesh.name.includes("moveHandler")&&(n?((0,a.GameState).levelRun(m.focusItem.meta.index),n=!1):(n=!0,t=l.pickedPoint))},e.onPointerMove=(i,a,r)=>{if(n){let i=e.pick(e.pointerX,e.pointerY,()=>!0),a=t.x-i.pickedPoint.x;Math.abs(a)>5&&(a>0?T(o,e):h(o,e),n=!1)}},e.onPointerUp=(e,t,o)=>{n&&setTimeout(()=>{n=!1},300)}}function f(e,n,t){let o=new l.StandardMaterial("cil-mt",t);return o.diffuseColor=n.diffuse,o.specularColor=new l.Color3(.1,0,0),o.backFaceCulling=!0,o.alpha=n.alpha??1,e.material=o,e}async function w(e,n,t){return new Promise(o=>{(0,r.loadMenuItemModel)(t).then(()=>{(0,i.ASSETS).containers3D.get("menu_item").instantiateModelsToScene(e=>e).rootNodes[0].getChildMeshes().forEach(e=>{switch(e.isVisible=!1,e.isEnabled(!1),e.name){case"Border":u.border=e;break;case"Center":u.center=e;break;case"Level":u.level=e;break;case"number-0":case"number-1":case"number-2":case"number-3":case"number-4":case"number-5":case"number-6":case"number-7":case"number-8":case"number-9":u.numbers.set(e.name,e);break;default:console.log("switch default")}})}).then(()=>{let i=function(e,n,t){let o=new l.TransformNode(`${e}-${n.index}`,t),i=u.border.clone("border");i.isVisible=!0,i.isEnabled(!0);let a=u.center.clone("center");a.isVisible=!0,a.isEnabled(!0);let r=u.level.clone("level");r.isVisible=!0,r.isEnabled(!0);let s=u.numbers.get(`number-${n.index}`).clone(`number-${n.index}`);s.isVisible=!0,s.isEnabled(!0);let c=u.center.clone("moveHandler");return c.isVisible=!0,c.isEnabled(!0),a.scaling=new l.Vector3(.7,.2,.7),c.scaling=new l.Vector3(1.2,.2,1.2),c.position.y=.3,s.rotation.y=(0,l.Tools).ToRadians(180),s.position.z=.9,r.rotation.y=(0,l.Tools).ToRadians(0),r.position.z=-1.7,i.setParent(o),a.setParent(o),r.setParent(o),s.setParent(o),c.setParent(o),f(i,{diffuse:new l.Color3(.5,.3,.2)},t),f(a,{diffuse:new l.Color3(.1,.1,.1)},t),f(r,{diffuse:new l.Color3(.9,.9,.9)},t),f(s,{diffuse:new l.Color3(.7,.7,.7)},t),f(c,{diffuse:new l.Color3(.01,.01,.01),alpha:.05},t),o.scalingDeterminant=1.5,o}(e,{index:n.index},t);i.position=new l.Vector3(0,14,0),o(i)})})}async function g(e,n,t){return new Promise(o=>{w(e,{index:n.index},t).then(t=>{t.meta={name:e,index:n.index,angle:n.angle},o(t)})})}function b(e,n,t){let o=m.items.get(e),i=m.focusItem;o.rotation.y=(0,l.Tools).ToRadians(-o.meta.angle);let a=(0,l.Tools).ToRadians(o.meta.angle);i&&(390===i.meta.angle&&90===o.meta.angle&&(n.rotation.y=(0,l.Tools).ToRadians(30)),90===i.meta.angle&&390===o.meta.angle&&(n.rotation.y=(0,l.Tools).ToRadians(450)));let r=function(e,n){let t=[{frame:0,value:e.rotation.clone().y},{frame:120,value:n}],o=new l.Animation("rotate-menu-anim","rotation.y",120,l.Animation.ANIMATIONTYPE_FLOAT,l.Animation.ANIMATIONLOOPMODE_CONSTANT,!1);return o.setKeys(t),e.animations.push(o),o}(n,a);t.beginAnimation(n,0,120,!1,2,()=>{t.removeAnimation(r)});let u=A(o),d=p(o);if(t.beginAnimation(o,0,60,!1,2,()=>{t.removeAnimation(u),t.removeAnimation(d)}),i){let e=A(i),n=p(i);t.beginAnimation(i,60,0,!1,2,()=>{t.removeAnimation(e),t.removeAnimation(n)})}(0,s.redrawLevelDescription)(1,e,"ru"),(0,c.getResultsIDB)().then(e=>{let n=e.filter(e=>m.focusItem.meta.index===e.level),t=n[0];for(let e=1;e<n.length;e++)t.score<n[e].score&&(t=n[e]);t?(0,s.redrawResult)(t.isWin,t.score):(0,s.redrawResult)(!1,0),(0,s.showResult)(!0)}),m.focusItem=o}function T(e,n){let t=(m.focusItem?m.focusItem.meta.index:0)+1;b(t=t>=m.count?0:t,e,n)}function h(e,n){let t=(m.focusItem?m.focusItem.meta.index:0)-1;b(t=t<0?m.count-1:t,e,n)}function p(e){let n=[{frame:0,value:m.scaleDeterminant},{frame:60,value:m.scaleDeterminantMax}],t=new l.Animation("scale-menu-anim","scalingDeterminant",60,l.Animation.ANIMATIONTYPE_FLOAT,l.Animation.ANIMATIONLOOPMODE_CONSTANT,!1);return t.setKeys(n),e.animations.push(t),t}function A(e){let n=e.position.clone(),t=n.add(new l.Vector3(0,0,0)),o=new l.Animation("posY-menuanim","position",60,l.Animation.ANIMATIONTYPE_VECTOR3,l.Animation.ANIMATIONLOOPMODE_CONSTANT,!1);return o.setKeys([{frame:0,value:n},{frame:60,value:t}]),e.animations.push(o),o}});