function e(e,t,a,o){Object.defineProperty(e,t,{get:a,set:o,enumerable:!0,configurable:!0})}var t=globalThis.parcelRequire6b9f,a=t.register;a("dCosV",function(a,o){e(a.exports,"sceneOne",()=>h);var i=t("dHlpp"),n=t("d6hv1"),s=t("e9gtV"),l=t("bGDFl"),r=t("a8Zow"),d=t("7E4Px"),m=t("5Vkc0"),c=t("iGzOG");function h(e,t){let a=function(e,t){let a=new c.Scene(n.AGAME.Engine);return a.enablePhysics(e,t),a.clearColor=new c.Color4(.05,.04,.06,1),a.ambientColor=new c.Color3(1,.1,1),a}(e,t),o=function(e){let t=new c.UniversalCamera("main-scene-camera",new c.Vector3(0,0,0),e);return t.position=new c.Vector3(0,10,-15),t.fov=(0,c.Tools).ToRadians(75),t.target=(0,c.Vector3).Zero(),t}(a),[h,p,S]=[...function(e){let t=new c.HemisphericLight("main-scene-hemilight",new c.Vector3(0,1,-8),e);t.diffuse=new c.Color3(1,1,1),t.specular=new c.Color3(1,1,1),t.intensity=.3;let a=new c.DirectionalLight("main-scene-dirlight",new c.Vector3(0,-1,-5),e);a.position=new c.Vector3(0,20,-20),a.diffuse=new c.Color3(1,1,1),a.specular=new c.Color3(.25,.25,.2),a.intensity=.1;let o=new c.SpotLight("left-scene-spot",new c.Vector3(-(0,i.GameState).gameBox().width/2-2,6,(0,i.GameState).gameBox().height/2+2),new c.Vector3(.5,-.5,-.5),(0,c.Tools).ToRadians(50),10,e);o.diffuse=new c.Color3(.9,.8,.7),o.specular=new c.Color3(.3,.2,.3),o.intensity=.9,o.shadowEnabled=!0;let n=new c.SpotLight("right-scene-spot",new c.Vector3((0,i.GameState).gameBox().width/2+2,6,(0,i.GameState).gameBox().height/2+2),new c.Vector3(-.5,-.5,-.5),(0,c.Tools).ToRadians(50),10,e);n.diffuse=new c.Color3(.9,.8,.7),n.specular=new c.Color3(.3,.2,.3),n.intensity=.9,n.shadowEnabled=!0;let s=new c.ShadowGenerator(1024,a);s.usePoissonSampling=!0,s.useExponentialShadowMap=!0,s.useBlurExponentialShadowMap=!0;let l=new c.ShadowGenerator(1024,o);l.usePoissonSampling=!0,l.useExponentialShadowMap=!0,l.useBlurExponentialShadowMap=!0;let r=new c.ShadowGenerator(1024,n);return r.usePoissonSampling=!0,r.useExponentialShadowMap=!0,r.useBlurExponentialShadowMap=!0,[t,a,[s,l,r]]}(a)];i.GameState.state.gameObjects.globalTransformNode=new c.TransformNode("global-transform-node",a),i.GameState.state.gameObjects.worldNode=function(e){let t=new c.TransformNode("world-transform-node",e),a=(0,c.MeshBuilder).CreateGround("ground",{width:(0,i.GameState).gameBox().width,height:(0,i.GameState).gameBox().height,updatable:!0},e);a.receiveShadows=!0;let o=new c.StandardMaterial(`${a.name}-mt`,e);o.diffuseColor=new c.Color3(.21,.19,.21),o.maxSimultaneousLights=10,a.material=o;let n=(0,c.MeshBuilder).CreateBox("left-wall",{width:.1,height:2,depth:(0,i.GameState).gameBox().height,updatable:!0},e);n.position=new c.Vector3(-(0,i.GameState).gameBox().width/2,1,0);let s=new c.StandardMaterial("wall-mt",e);s.diffuseColor=new c.Color3(.3,.25,.35),s.alpha=.5,n.material=s;let l=n.clone("right-wall",t,!0,!1);l.position=new c.Vector3((0,i.GameState).gameBox().width/2,1,0);let r=(0,c.MeshBuilder).CreateBox("up-wall",{width:(0,i.GameState).gameBox().width,height:2,depth:.1,updatable:!0},e);r.position=new c.Vector3(0,1,(0,i.GameState).gameBox().height/2),r.material=s,a.parent=t,n.parent=t,l.parent=t,r.parent=t,t.position.x-=.2;let d=new c.PhysicsBody(a,c.PhysicsMotionType.STATIC,!1,e),m=new c.PhysicsShapeConvexHull(a,e);m.material={restitution:i.GameState.state.physicsMaterial.ground.restitution,friction:i.GameState.state.physicsMaterial.ground.friction},d.shape=m;let h=new c.PhysicsBody(l,c.PhysicsMotionType.STATIC,!1,e),p=new c.PhysicsShapeConvexHull(l,e);p.material={restitution:i.GameState.state.physicsMaterial.wall.restitution,friction:i.GameState.state.physicsMaterial.wall.friction},h.shape=p;let S=new c.PhysicsBody(n,c.PhysicsMotionType.STATIC,!1,e),w=new c.PhysicsShapeConvexHull(n,e);w.material={restitution:i.GameState.state.physicsMaterial.wall.restitution,friction:i.GameState.state.physicsMaterial.wall.friction},S.shape=w;let u=new c.PhysicsBody(r,c.PhysicsMotionType.STATIC,!1,e),g=new c.PhysicsShapeConvexHull(r,e);return g.material={restitution:i.GameState.state.physicsMaterial.wall.restitution,friction:i.GameState.state.physicsMaterial.wall.friction},u.shape=g,t}(a);let[w,u,g]=(0,d.shildComposition)(a);i.GameState.state.gameObjects.scene=a,i.GameState.state.gameObjects.camera=o,i.GameState.state.gameObjects.damageNodes=[],i.GameState.state.gameObjects.shield_node=w,i.GameState.state.gameObjects.shield_body=u,i.GameState.state.gameObjects.ball=(0,s.ballComposition)(a),i.GameState.state.gameObjects.shadow=S,i.GameState.state.gameObjects.physicsHelper=new c.PhysicsHelper(a),i.GameState.state.gameObjects.points=(0,r.initPoints)(a),(0,c.MeshBuilder).CreateLines("up-line",{points:[new c.Vector3(i.GameState.state.dragBox.left,.1,i.GameState.state.dragBox.up),new c.Vector3(0,.1,i.GameState.state.dragBox.up),new c.Vector3(i.GameState.state.dragBox.rigth,.1,i.GameState.state.dragBox.up)],colors:[new c.Color4(.3,.5,.5,1),new c.Color4(.9,.5,.5,1),new c.Color4(.3,.5,.5,1)]},i.GameState.state.gameObjects.scene),(0,c.MeshBuilder).CreateLines("down-line",{points:[new c.Vector3(i.GameState.state.dragBox.left,.1,i.GameState.state.dragBox.down),new c.Vector3(0,.1,i.GameState.state.dragBox.down),new c.Vector3(i.GameState.state.dragBox.rigth,.1,i.GameState.state.dragBox.down)],colors:[new c.Color4(.3,.5,.5,1),new c.Color4(.9,.5,.5,1),new c.Color4(.3,.5,.5,1)]},i.GameState.state.gameObjects.scene),(0,s.addShadowToBall)(S,a),(0,d.addShadowToShield)(S,a),n.AGAME.Scene=a,(0,d.addPosition$)(()=>{}),n.AGAME.Scene.onPointerDown=(e,t,a)=>{(function(e,t,a){console.log("DOWN POINTER");let o=a.pick(a.pointerX,a.pointerY,()=>!0);(0,m.clampToBoxShieldPosition)(o.pickedPoint,t,1),i.GameState.state.isDragShield=!0})(0,(0,i.GameState).shieldNode(),n.AGAME.Scene)},n.AGAME.Scene.onPointerUp=(e,t,a)=>{var o;n.AGAME.Scene,i.GameState.state.isDragShield&&(i.GameState.state.isDragShield=!1,console.log("UP POINTER"),(0,s.onRun$)())},n.AGAME.Scene.onPointerMove=(e,t,a)=>{(function(e,t,a){if(i.GameState.state.isDragShield){let e=a.pick(a.pointerX,a.pointerY,()=>!0);(0,m.clampToBoxShieldPosition)(e.pickedPoint,t,1)}})(0,(0,i.GameState).shieldNode(),n.AGAME.Scene)},(0,n.AGAME).Scene.onBeforeRenderObservable.add(()=>{i.GameState.state.isBallStart||(0,i.GameState).state.gameObjects.ball.getPhysicsBody().setTargetTransform((0,i.GameState).shieldNode().position.clone().add(new c.Vector3(0,0,.5)),(0,c.Quaternion).Identity()),(0,n.AGAME).HVK.setTargetTransform((0,i.GameState).shieldBody().getPhysicsBody(),(0,i.GameState).shieldNode().position,(0,c.Quaternion).Identity())}),(0,n.AGAME).HVK.onCollisionObservable.add((e,t)=>{if(i.GameState.state.gameState===i.GameState.state.signals.GAME_RUN){let t=e.collider.transformNode,a=e.collidedAgainst.transformNode;"shield"===a.name||"shield"===t.name||a.name.includes("enemy-bloc")}}),(0,n.AGAME).HVK.onCollisionEndedObservable.add((e,t)=>{if(i.GameState.state.gameState===i.GameState.state.signals.GAME_RUN&&!i.GameState.state.isResetBall){let t=e.collider.transformNode,a=e.collidedAgainst.transformNode;("ball"===a.name||"ball"===t.name)&&a.name.includes("enemy-bloc")&&((0,l.enemyCollideReaction)(a),(0,r.newPoints)("10",a.position),(0,i.GameState).calculatePoints(a),(0,m.isAllEnemiesDie)()&&i.GameState.state.gameState!==i.GameState.state.signals.LEVEL_WIN&&(0,i.GameState).changeGameState(i.GameState.state.signals.LEVEL_WIN))}})}}),a("a8Zow",function(a,o){e(a.exports,"initPoints",()=>l),e(a.exports,"newPoints",()=>r);var i=t("cwyqU"),n=t("dHlpp"),s=t("iGzOG");function l(e){let t=(0,s.MeshBuilder).CreatePlane("points",{size:1},e);return t.billboardMode=s.Mesh.BILLBOARDMODE_ALL,t.isVisible=!1,t}function r(e,t){let a=(0,n.GameState).points().clone();a.position=t.add(new s.Vector3(0,1,0)),a.isVisible=!0;let o=new s.DynamicTexture("points-txt",{width:40,height:40},(0,n.GameState).scene());o.hasAlpha=!0;let l=o.getContext(),r=new s.StandardMaterial("points-mt",(0,n.GameState).scene());r.diffuseTexture=o,r.emissiveTexture=o,a.material=r,l.drawImage((0,i.ASSETS).sprites.get("points10"),0,0,256,256,0,0,40,40),o.update(),function(e){let t=[{frame:0,value:e.position.y},{frame:60,value:e.position.y+5}],a=new s.Animation("points-anim","position.y",60,s.Animation.ANIMATIONTYPE_FLOAT,s.Animation.ANIMATIONLOOPMODE_CONSTANT,!1);a.setKeys(t),e.animations.push(a),(0,n.GameState).scene().beginAnimation(e,0,120,!1,1,()=>{e.dispose()})}(a)}}),a("7E4Px",function(a,o){e(a.exports,"shildComposition",()=>s),e(a.exports,"addShadowToShield",()=>l),e(a.exports,"addPosition$",()=>r);var i=t("dHlpp"),n=t("iGzOG");function s(e){let t=new n.TransformNode("shield-transform-node",e),a=function(e,t){let a=(0,n.MeshBuilder).CreateBox("shield",{width:3.5,height:.6,depth:.25,wrap:!0,updatable:!0},e);a.parent=t,a.receiveShadows=!0;let o=new n.StandardMaterial("shield-mt",e);o.emissiveColor=new n.Color3(.7,.5,.1),o.alpha=.8,o.maxSimultaneousLights=10,a.material=o;let s=new n.PhysicsBody(a,n.PhysicsMotionType.ANIMATED,!1,e);s.setMassProperties({mass:i.GameState.state.physicsMaterial.shield.mass});let l=new n.PhysicsShapeConvexHull(a,e);return l.material={restitution:i.GameState.state.physicsMaterial.shield.restitution,friction:i.GameState.state.physicsMaterial.shield.friction},s.shape=l,s.setCollisionCallbackEnabled(!0),s.setCollisionEndedCallbackEnabled(!0),a}(e,t),o=function(e,t){let a=(0,n.MeshBuilder).CreatePlane("shield-control-plane",{width:5.5,height:2.5,updatable:!0},e);a.position=new n.Vector3(0,.7,-.5),a.parent=t,a.isPickable=!0,a.rotation.x=(0,n.Tools).ToRadians(90);let o=new n.StandardMaterial("shield-mt",e);return o.diffuseColor=new n.Color3(.1,.1,.1),o.alpha=.2,a.material=o,a}(e,t);return t.position=new n.Vector3(0,.3,-7),t.position$=new n.Observable,[t,a,o]}function l(e,t){e.forEach(e=>{e.addShadowCaster(t.getMeshByName("shield"),!1)})}function r(e){(0,i.GameState).shieldNode().position$.add(()=>{e()})}});